<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.0"><meta name="keywords" data-name="fire" content="JavaScript,Vue.js,小程序,WebPack,ECMAScript 6,vue,php,js,JavaScript,typescirpt,node,egg,很帅很愁人,web前端,全栈,网页,博客，前端博客,JavaScript,html5,css3,Jquery,NodeJs
"><meta name="360-site-verification" content="178e3a7a27a16a1253976882a4d99509"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/fly-32.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/fly-16.png"><link rel="mask-icon" href="/images/logo.svg" color="#222"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="google-site-verification" content="iy8yHMd-90Qb6NAJqgoij_Cz3i3Jh9FRGRxrWJbRrOw"><meta name="msvalidate.01" content="92E59C28288B8049A45C6288AD39DFA0"><meta name="baidu-site-verification" content="code-etAIIwOVpZ"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/lib/font-awesome/css/all.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"blog.wy1991.cn",root:"/",scheme:"Gemini",version:"7.8.0",exturl:!0,sidebar:{position:"left",display:"hide",padding:18,offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:"mac"},back2top:{enable:!0,sidebar:!1,scrollpercent:!1},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!0,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="重学react"><meta property="og:type" content="article"><meta property="og:title" content="185-重学react"><meta property="og:url" content="https://blog.wy1991.cn/20220315/185-%E9%87%8D%E5%AD%A6react/index.html"><meta property="og:site_name" content="很帅很愁人~"><meta property="og:description" content="重学react"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2022-03-15T08:23:07.000Z"><meta property="article:modified_time" content="2022-03-15T08:24:59.632Z"><meta property="article:author" content="很帅很愁人~"><meta property="article:tag" content="react"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://blog.wy1991.cn/20220315/185-%E9%87%8D%E5%AD%A6react/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"zh-CN"}</script><title>185-重学react | 很帅很愁人~</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><script src="/js/fairyDustCursor.js"></script><script src="/js/clickLove.js"></script></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">很帅很愁人~</h1><span class="logo-line-after"><i></i></span></a><p class="site-subtitle" itemprop="description">迷茫是因为才华配不上梦想の，所以你必须非常努力，才能显得毫不费力！</p></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul id="menu" class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-相册"><a href="/20210707/0-%E6%A2%A6%E7%91%B6(%E4%B8%80%E4%B8%80)%E5%92%8C%E5%B0%8F%E6%B2%AB%E6%B2%AB/" rel="section"><i class="fa fa-user fa-fw"></i>相册</a></li><li class="menu-item menu-item-sitemap"><a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>地图</a></li><li class="menu-item menu-item-commonweal"><a href="/404.html" rel="section"><i class="fa fa-heartbeat fa-fw"></i>公益</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"><div id="no-result"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div><div class="reading-progress-bar"></div><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://blog.wy1991.cn/20220315/185-%E9%87%8D%E5%AD%A6react/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/my.jpg"><meta itemprop="name" content="很帅很愁人~"><meta itemprop="description" content="梦是一种欲望, 想是一种行动。梦想是梦与想的结晶，加油打工人~~"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="很帅很愁人~"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">185-重学react</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2022-03-15 16:23:07 / 修改时间：16:24:59" itemprop="dateCreated datePublished" datetime="2022-03-15T16:23:07+08:00">2022-03-15</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/react/" itemprop="url" rel="index"><span itemprop="name">react</span></a> </span></span><span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="post-meta-item-text">阅读次数：</span> <span id="busuanzi_value_page_pv"></span></span><div class="post-description" style="opacity:0">重学react</div></div></header><div class="post-body" itemprop="articleBody"><p>官网：<span class="exturl" data-url="aHR0cHM6Ly9yZWFjdC5kb2NzY2hpbmEub3JnL2RvY3MvaGVsbG8td29ybGQuaHRtbA==">https://react.docschina.org/docs/hello-world.html<i class="fa fa-external-link-alt"></i></span></p><p>构建用户界面的 javascript 库，主要用于构建 UI 界面</p><p>特点：</p><ol><li>声明式的设计</li><li>高效，采用虚拟 DOM 来实现 DOM 的渲染，最大限度减少 DOM 的操作</li><li>灵活，跟其它库搭配</li><li>JSX，俗称 js 里面写 HTML，JavaScript 语法的扩展</li><li>组件化，模块化。代码容易复用，</li><li>单向数据流，没有实现数据的双向绑定。数据-&gt;视图-&gt;事件-&gt;数据</li></ol><p>创建项目：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npx create-react-app my-app</span><br><span class="line">cd my-app</span><br><span class="line">npm start</span><br></pre></td></tr></table></figure><p>public:入口文件</p><p>src:源码文件</p><p>React 开发依赖三个库：</p><ul><li>react:包含 react 所必须的核心代码</li><li>react-dom:react 渲染在不同平台所需要的核心代码</li><li>babel:将 jsx 转换成 react 代码的工具</li></ul><p>第一个 React 程序：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=&quot;app&quot;&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;script crossorigin src=&quot;https://unpkg.com/react@16/umd/react.production.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script crossorigin src=&quot;https://unpkg.com/react-dom@16/umd/react-dom.production.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script src=&quot;https://unpkg.com/babel-standalone@6/babel.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 在script标签中使用jsx，必须添加一个属性 --&gt;</span><br><span class="line">&lt;script type=&quot;text/babel&quot;&gt;</span><br><span class="line">class App extends React.Component &#123;</span><br><span class="line">  constructor (props) &#123;</span><br><span class="line">    super(props);</span><br><span class="line"></span><br><span class="line">    this.state = &#123;</span><br><span class="line">      message: &#x27;Hello World&#x27;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  render () &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;h2&gt;&#123;this.state.message&#125;&lt;/h2&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#123;/*ReactDom.render(渲染的内容, 挂载的对象)*/&#125;</span><br><span class="line">ReactDOM.render(&lt;App/&gt;, document.getElementById(&#x27;app&#x27;))</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>jsx 特点：多个标签最外层(根)只能有一个标签</p><h3 id="认识-JSX"><a href="#认识-JSX" class="headerlink" title="认识 JSX"></a>认识 JSX</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> element = <span class="xml"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>Hello World<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span> <span class="comment">//jsx语法</span></span><br></pre></td></tr></table></figure><p>jsx 语法如果是单标签，必须以/&gt;结尾</p><h4 id="jsx-中的注释"><a href="#jsx-中的注释" class="headerlink" title="jsx 中的注释"></a><strong>jsx 中的注释</strong></h4><p>​ {/ _ 注释_ /}</p><h4 id="jsx-中嵌入变量"><a href="#jsx-中嵌入变量" class="headerlink" title="jsx 中嵌入变量"></a><strong>jsx 中嵌入变量</strong></h4><ul><li>在{}中可以正常显示的内容<ul><li>String Number Array</li></ul></li><li>在{}中不能正常显示的内容<ul><li>null undefined Boolean</li></ul></li><li>对象不能作为 jsx 的子类</li></ul><h4 id="jsx-中嵌入表达式"><a href="#jsx-中嵌入表达式" class="headerlink" title="jsx 中嵌入表达式"></a><strong>jsx 中嵌入表达式</strong></h4><ol><li>放运算符表达式</li><li>三目运算符</li><li>函数调用</li></ol><h4 id="jsx-绑定属性"><a href="#jsx-绑定属性" class="headerlink" title="jsx 绑定属性"></a><strong>jsx 绑定属性</strong></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">class App extends React.Component &#123;</span><br><span class="line">    constructor (props) &#123;</span><br><span class="line">      super(props);</span><br><span class="line"></span><br><span class="line">      this.state = &#123;</span><br><span class="line">        message: &#x27;Hello World&#x27;,</span><br><span class="line">        title: &#x27;标题&#x27;,</span><br><span class="line">        imgUrl: &#x27;http://p3.music.126.net/SKTZnAx1sw72kwcq1iQg9A==/109951165243739237.jpg?param=200y200&#x27;,</span><br><span class="line">        active: true</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    render () &#123;</span><br><span class="line">      const &#123; title, imgUrl &#125; = this.state;</span><br><span class="line">      return (</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">          &lt;img src=&#123;imgUrl&#125; title=&#123;title&#125; /&gt;</span><br><span class="line">          &#123;/*绑定类名写法*/&#125;</span><br><span class="line">          &lt;div className = &quot;box title&quot;&gt;我是div元素&lt;/div&gt;</span><br><span class="line">          &#123;/*for写法*/&#125;</span><br><span class="line">          &lt;label htmlFor=&quot;&quot;&gt;&lt;/label&gt;</span><br><span class="line">          &#123;/*动态绑定类*/&#125;</span><br><span class="line">          &lt;div className=&#123;&quot;box title &quot; + (active ? &quot;active&quot;: &quot;&quot;)&#125;&gt;我也是div元素&lt;/div&gt;</span><br><span class="line">          &#123;/* 绑定style */&#125;</span><br><span class="line">          &#123;/*第一个大括号表示jsx语法，第二个大括号表示一个对象*/&#125;</span><br><span class="line">          &#123;/*style属性由多个单词组成时，不能使用连接符，要使用驼峰标识*/&#125;</span><br><span class="line">           &lt;div style=&#123;&#123;color: &quot;red&quot;, fontSize: &quot;50px&quot;&#125;&#125;&gt;我是div,绑定style属性&lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      )</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  ReactDOM.render(&lt;App/&gt;, document.getElementById(&#x27;app&#x27;))</span><br><span class="line">  &#123;/*单括号里面可跟变量或函数*/&#125;</span><br></pre></td></tr></table></figure><p>jsx 中不允许随便使用 js 关键字,如 class，for</p><h4 id="jsx-事件绑定和-this-处理"><a href="#jsx-事件绑定和-this-处理" class="headerlink" title="jsx 事件绑定和 this 处理"></a><strong>jsx 事件绑定和 this 处理</strong></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=&quot;text/babel&quot;&gt;</span><br><span class="line">  class App extends React.Component &#123;</span><br><span class="line">    constructor(props) &#123;</span><br><span class="line">      super(props);</span><br><span class="line">      this.state = &#123;</span><br><span class="line">        message: &quot;你好啊&quot;,</span><br><span class="line">        counter: 100</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      this.btnClick = this.btnClick.bind(this); //在构造器中绑定this</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    render() &#123;</span><br><span class="line">      return (</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">          &#123;/*点击事件依然使用小驼峰标识*/&#125;</span><br><span class="line">          &#123;/* 1.方案一: bind绑定this(显式绑定) */&#125;</span><br><span class="line">          &lt;button onClick=&#123;this.btnClick&#125;&gt;按钮1&lt;/button&gt;</span><br><span class="line"></span><br><span class="line">          &#123;/* 2.方案二: 定义函数时, 使用箭头函数 */&#125;</span><br><span class="line">          &lt;button onClick=&#123;this.increment&#125;&gt;+1&lt;/button&gt;</span><br><span class="line"></span><br><span class="line">          &#123;/* 3.方案三(推荐): 直接传入一个箭头函数, 在箭头函数中调用需要执行的函数*/&#125;</span><br><span class="line">          &lt;button onClick=&#123;() =&gt; &#123; this.decrement(&quot;why&quot;) &#125;&#125;&gt;-1&lt;/button&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      )</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    btnClick() &#123; //方案1</span><br><span class="line">      console.log(this.state.message);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 箭头函数中永远不绑定this</span><br><span class="line">    // ES6中给对象增加属性: class fields</span><br><span class="line">    increment = () =&gt; &#123;	//方案2</span><br><span class="line">      console.log(this.state.counter);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    decrement(name) &#123;	//方案3,传递参数时特别方便</span><br><span class="line">      console.log(this.state.counter, name);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  ReactDOM.render(&lt;App/&gt;, document.getElementById(&quot;app&quot;));</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h4 id="jsx-事件绑定-传递参数"><a href="#jsx-事件绑定-传递参数" class="headerlink" title="jsx 事件绑定-传递参数"></a><strong>jsx 事件绑定-传递参数</strong></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=&quot;text/babel&quot;&gt;</span><br><span class="line">  class App extends React.Component &#123;</span><br><span class="line">    constructor(props) &#123;</span><br><span class="line">      super(props);</span><br><span class="line"></span><br><span class="line">      this.state = &#123;</span><br><span class="line">        movies: [&quot;大话西游&quot;, &quot;海王&quot;, &quot;流浪地球&quot;, &quot;盗梦空间&quot;]</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      this.btnClick = this.btnClick.bind(this);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    render() &#123;</span><br><span class="line">      return (</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">          &lt;button onClick=&#123;this.btnClick&#125;&gt;按钮&lt;/button&gt;</span><br><span class="line"></span><br><span class="line">          &lt;ul&gt;</span><br><span class="line">            &#123;</span><br><span class="line">              this.state.movies.map((item, index, arr) =&gt; &#123;</span><br><span class="line">                return (  //返回的内容包上小括号之后就可以换行</span><br><span class="line">                  &lt;li className=&quot;item&quot;</span><br><span class="line">                    onClick=&#123; event =&gt; &#123; this.liClick(item, index, event) &#125;&#125;</span><br><span class="line">                    title=&quot;li&quot;&gt;</span><br><span class="line">                    &#123;item&#125;</span><br><span class="line">                  &lt;/li&gt;</span><br><span class="line">                )</span><br><span class="line">              &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">          &lt;/ul&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      )</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    btnClick(event) &#123; //默认会传event对象</span><br><span class="line">      //执行函数时：onClick.call(undefined, event);</span><br><span class="line">      console.log(&quot;按钮发生了点击&quot;, event);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    liClick(item, index, event) &#123; //元素 下标 event对象</span><br><span class="line">      console.log(&quot;li发生了点击&quot;, item, index, event);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  ReactDOM.render(&lt;App/&gt;, document.getElementById(&quot;app&quot;));</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h4 id="条件渲染"><a href="#条件渲染" class="headerlink" title="条件渲染"></a>条件渲染</h4><p>在 react 中，所有的条件判断都和普通的 JavaScript 代码一致</p><p>方案一:通过 if 判断: 逻辑代码非常多的情况</p><p>方案二: 三元运算符</p><blockquote><p>&lt;button onClick**=<strong>{e **=&gt;</strong> this.loginClick()}&gt;{isLogin <strong>?</strong> “退出” <strong>:</strong> “登录”}</p></blockquote><p>方案三: 逻辑与&amp;&amp;</p><blockquote><p>{ isLogin <strong>&amp;&amp;</strong> “你好啊, coderwhy” } //逻辑与: 前面条件不成立, 后面的条件都不会进行判断了</p></blockquote><p>v-show 效果渲染</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">render() &#123;</span><br><span class="line">  const &#123; isLogin&#125; = this.state;	//解构</span><br><span class="line">  const titleDisplayValue = isLogin ? &quot;block&quot;: &quot;none&quot;;</span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;button onClick=&#123;e =&gt; this.loginClick()&#125;&gt;&#123;isLogin ? &quot;退出&quot;: &quot;登录&quot;&#125;&lt;/button&gt;</span><br><span class="line">      &lt;h2 style=&#123;&#123;display: titleDisplayValue&#125;&#125;&gt;你好啊, coderwhy&lt;/h2&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="列表渲染"><a href="#列表渲染" class="headerlink" title="列表渲染"></a>列表渲染</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;h2&gt;数字列表(过滤2)&lt;/h2&gt;</span><br><span class="line">&lt;ul&gt;</span><br><span class="line">&#123;</span><br><span class="line">	this.state.numbers.filter(item =&gt; item &gt;= 50).map(item =&gt; &lt;li&gt;&#123;item&#125;&lt;/li&gt;)</span><br><span class="line">&#125;</span><br><span class="line">&lt;/ul&gt;</span><br><span class="line"></span><br><span class="line">&lt;h2&gt;数字列表(截取)&lt;/h2&gt;</span><br><span class="line">&lt;ul&gt;</span><br><span class="line">&#123;</span><br><span class="line">  &#123;/*截取数组前4个元素(0123),0&lt;=el&lt;4*/&#125;</span><br><span class="line">	this.state.numbers.slice(0, 4).map(item =&gt; &lt;li&gt;&#123;item&#125;&lt;/li&gt;)</span><br><span class="line">&#125;</span><br><span class="line">&lt;/ul&gt;</span><br></pre></td></tr></table></figure><p>react 设计原则：state 中数据的不可变性，新建中间变量，修改完成之后整体赋值给原来的数据</p><h3 id="React-脚手架"><a href="#React-脚手架" class="headerlink" title="React 脚手架"></a>React 脚手架</h3><p>cnpm 安装:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g cnpm --registry=https://registry.npm.taobao.org</span><br></pre></td></tr></table></figure><p>yarn 安装：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm install -g yarn #react脚手架默认使用yarn</span><br><span class="line">yarn --version #查看yarn版本</span><br><span class="line">npm install -g create-react-app</span><br></pre></td></tr></table></figure><p>创建项目：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 项目名称不能包含大写字母</span></span><br><span class="line">create-react-app 项目名称 #创建js项目</span><br><span class="line">create-react-app ts-app --template typescript  #使用脚手架创建ts项目</span><br><span class="line"><span class="meta">#</span><span class="bash"> 运行项目</span></span><br><span class="line">yarn start</span><br></pre></td></tr></table></figure><p>使用 export default 导出方式，导入时不需要写大括号</p><p>直接导出时：export function sum(num1, num2){}</p><p>导入需要写大括号：import {sum, mul} from ‘./utils’</p><h3 id="React-组件化开发"><a href="#React-组件化开发" class="headerlink" title="React 组件化开发"></a>React 组件化开发</h3><h4 id="类组件定义要求"><a href="#类组件定义要求" class="headerlink" title="类组件定义要求"></a>类组件定义要求</h4><ul><li>组件的名称必须是大写字母开头(无论是类组件还是函数组件)</li><li>类组件需要继承自：React.Component</li><li>类组件必须实现 render 函数</li></ul><p>jsx 语法中，普通 html 标签必须使用小写，否则会被当成组件</p><p>使用 class 定义一个组件：</p><p>constructor 是可选的，通常在 constructor 中初始化一些数据</p><p>this.state 中维护的就是组件内部的数据</p><p>render()方法是 class 组件中唯一必须实现的方法</p><h4 id="类组件"><a href="#类组件" class="headerlink" title="类组件"></a>类组件</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">export default class App extends Component &#123;</span><br><span class="line">  constructor () &#123;</span><br><span class="line">    super();</span><br><span class="line"></span><br><span class="line">    this.state = &#123;</span><br><span class="line">      counter: 1</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="函数组件"><a href="#函数组件" class="headerlink" title="函数组件"></a>函数组件</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">export default function App () &#123;</span><br><span class="line">  return &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">//没有this对象</span><br><span class="line">//没有内部状态(hoooks)</span><br><span class="line">//会被更新并挂载，但是没有生命周期函数，可通过hooks模拟生命周期的回调</span><br></pre></td></tr></table></figure><h4 id="render-函数的返回值"><a href="#render-函数的返回值" class="headerlink" title="render 函数的返回值"></a>render 函数的返回值</h4><p>当 render 被调用时，他会检查 this.props 和 this.state 的变化并返回下列类型之一</p><p><strong>React 元素：</strong></p><ul><li>通常通过 jsx 创建</li><li>div 会被 React 渲染为 DOM 节点,<mycomponent>会被 React 渲染为自定义组件</li></ul><p>**数组或 fragments:**使得 render 方法可以返回多个元素</p><p><strong>Portals：</strong>可以渲染子节点到不同的 DOM 子树中</p><p><strong>字符串或数值类型：</strong>它们在 DOM 中会被渲染为文本节点</p><p><strong>Boolean 或 null：</strong>什么都不渲染</p><h4 id="生命周期"><a href="#生命周期" class="headerlink" title="生命周期"></a>生命周期</h4><ul><li>挂载阶段：constructor -&gt; render -&gt; componentDidMount</li></ul><p>componentDidMount () {} //组件挂载后调用，在此处发送网络请求最好的地方</p><ul><li>修改阶段：render -&gt; componentDidUpdate</li></ul><p>componentDidUpdate () {} //组件更新后被调用，首次渲染不会执行此方法</p><ul><li>删除阶段： componentWillUnmount</li></ul><p>componentWillUnmount () {} //组件卸载及销毁之前直接调用，可在此执行必要的清理操作</p><p><strong>constructor</strong></p><ul><li>如果不初始化或不进行方法绑定，则不需要为 React 组件实现构造函数</li><li>constructor 通常只做两件事<ul><li>通过 this.state 赋值对象来初始化内部的 state</li><li>为事件绑定实例（this）</li></ul></li></ul><h4 id="组件的嵌套"><a href="#组件的嵌套" class="headerlink" title="组件的嵌套"></a>组件的嵌套</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt;</span><br><span class="line">  &lt;Header/&gt;</span><br><span class="line">  &lt;Main/&gt;</span><br><span class="line">  &lt;Footer/&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure><h4 id="组件间的通信-props"><a href="#组件间的通信-props" class="headerlink" title="组件间的通信(props)"></a>组件间的通信(props)</h4><h5 id="父传子"><a href="#父传子" class="headerlink" title="父传子"></a>父传子</h5><ul><li>类组件(通过属性传递 )</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; Component &#125; from &#x27;react&#x27;</span><br><span class="line"></span><br><span class="line">class ChildCpn extends Component &#123;</span><br><span class="line">  // constructor (props) &#123;   //可以省略&#123;/*2.可省略*/&#125;</span><br><span class="line">  //   super(props); //传给父类保存参数，本质上是保存到了自己的this里面，默认方式，所以可以省略</span><br><span class="line">  // &#125;</span><br><span class="line">  render () &#123;</span><br><span class="line">    const &#123;name, age, height&#125; = this.props; //3.对象解构</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;h2&gt;子组件展示数据：&#123;`$&#123;name&#125;的年龄是$&#123;age&#125;岁，身高是$&#123;height&#125;`&#125;&lt;/h2&gt;</span><br><span class="line">        &#123;/*4.使用*/&#125;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default class App extends Component &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;ChildCpn name=&quot;why&quot; age=&quot;18&quot; height=&quot;1.88&quot;/&gt; &#123;/*1.*/&#125;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>函数组件</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; Component &#125; from &#x27;react&#x27;</span><br><span class="line"></span><br><span class="line">function ChildCpn (props) &#123;	//2.</span><br><span class="line">  const &#123;name, age, height&#125; = props; //3.</span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      	&#123;/*4.*/&#125;</span><br><span class="line">        &lt;h2&gt;子组件展示数据：&#123;`$&#123;name&#125;的年龄是$&#123;age&#125;岁，身高是$&#123;height&#125;`&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default class App extends Component &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;ChildCpn name=&quot;Kobe&quot; age=&quot;40&quot; height=&quot;2.12&quot;/&gt;	&#123;/*1.*/&#125;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>传参属性验证</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; Component &#125; from &#x27;react&#x27;</span><br><span class="line">import PropTypes from &#x27;prop-types&#x27;  //1.导入验证包</span><br><span class="line"></span><br><span class="line">function ChildCpn (props) &#123;</span><br><span class="line">  const &#123;name, age, height&#125; = props;</span><br><span class="line">  const &#123; names &#125; = props;</span><br><span class="line">  //static propTypes = &#123;&#125; //类组件可以使用</span><br><span class="line"> // static defaultProps = &#123;&#125; //类组件可以使用</span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line">ChildCpn.propTypes = &#123;	//2.使用验证 类组件和函数组件都可以使用</span><br><span class="line">  name: PropTypes.string.isRequired, //传过来的name必须是string类型,且必须传</span><br><span class="line">  age: PropTypes.number,</span><br><span class="line">  names: PropTypes.array</span><br><span class="line">&#125;</span><br><span class="line">ChildCpn.defaultProps = &#123;	//未传参数时设置默认值 类组件和函数组件都可以使用</span><br><span class="line">  name: &#x27;ysj&#x27;,</span><br><span class="line">  age: 30,</span><br><span class="line">  height: 1.98</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default class App extends Component &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;ChildCpn height=&#123;1.88&#125; name=&quot;Kobe&quot; age=&#123;18&#125; names=&#123;[&#x27;aaa&#x27;, &#x27;bbb&#x27;, &#x27;ccc&#x27;, &#x27;ddd&#x27;]&#125;/&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="子传父"><a href="#子传父" class="headerlink" title="子传父"></a>子传父</h5><p>通过 props 传递函数给子组件，让子组件调用，使父组件的函数被回调，从而在父组件完成相关操作</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; Component &#125; from &#x27;react&#x27;</span><br><span class="line"></span><br><span class="line">class CounterBtn extends Component &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    const &#123;btnClick&#125; = this.props; //2.从props中取出父组件传过来的参数</span><br><span class="line"></span><br><span class="line">    //3.在onClick中调用btnClick方法</span><br><span class="line">    return &lt;button onClick=&#123;btnClick&#125;&gt;+1&lt;/button&gt;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default class App extends Component &#123;</span><br><span class="line">  constructor(props) &#123;</span><br><span class="line">    super(props);</span><br><span class="line">    this.state = &#123;</span><br><span class="line">      counter: 0</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;h2&gt;当前计数：&#123;this.state.counter&#125;&lt;/h2&gt;</span><br><span class="line">        &lt;CounterBtn btnClick=&#123;e =&gt; this.increment()&#125;/&gt;</span><br><span class="line">        &#123;/* 1.将方法赋值给btnClick(自己取的名字)，并将btnClick传给子组件 */&#125;</span><br><span class="line">        &#123;/*时间监听传箭头函数，直接传函数this会有问题*/&#125;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  increment() &#123; //父组件函数</span><br><span class="line">    this.setState(&#123;</span><br><span class="line">      counter: this.state.counter + 1</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>会发生改变的数据放在 this.state 里面，不变的数据放在 this 里面</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">constructor(props) &#123;</span><br><span class="line">  super(props);</span><br><span class="line">  this.titles = [&#x27;新款&#x27;, &#x27;精选&#x27;, &#x27;流行&#x27;];	//不变的数据，放在this里面</span><br><span class="line">  this.state = &#123;</span><br><span class="line">    currentIndex:0	//会发生改变的数据，放在this.state里面</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="React-实现-slot"><a href="#React-实现-slot" class="headerlink" title="React 实现 slot"></a>React 实现 slot</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">//App.js</span><br><span class="line">export default class App extends Component &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;NavBar</span><br><span class="line">          leftSlot=&#123;&lt;span&gt;aaa&lt;/span&gt;&#125;</span><br><span class="line">          centerSlot=&#123;&lt;strong&gt;bbb&lt;/strong&gt;&#125;</span><br><span class="line">          rightSlot=&#123;&lt;a href=&quot;/#&quot; target=&quot;_blank&quot;&gt;百度&lt;/a&gt;&#125;</span><br><span class="line">        /&gt;</span><br><span class="line">        &#123;/*1.传标签给子组件*/&#125;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//NavBar.js</span><br><span class="line">export default class NavBar extends Component &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    const &#123;leftSlot, centerSlot, rightSlot&#125; = this.props;  //2.解构父组件传过来的数据</span><br><span class="line">    return (</span><br><span class="line">      &lt;div className=&quot;nav-bar&quot;&gt;</span><br><span class="line">        &lt;div className=&quot;nav-left nav-item&quot;&gt;</span><br><span class="line">          &#123;leftSlot&#125; &#123;/*3.使用*/&#125;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;div className=&quot;nav-center nav-item&quot;&gt;</span><br><span class="line">          &#123;centerSlot&#125;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;div className=&quot;nav-right nav-item&quot;&gt;</span><br><span class="line">          &#123;rightSlot&#125;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="跨组件通信"><a href="#跨组件通信" class="headerlink" title="跨组件通信"></a>跨组件通信</h5><p>如果你已经有了一个 props 对象，你可以使用展开运算符 <code>...</code> 来在 JSX 中传递整个 props 对象。以下两个组件是等价的</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">function App1() &#123;</span><br><span class="line">  return &lt;Greeting firstName=&quot;Ben&quot; lastName=&quot;Hector&quot; /&gt;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function App2() &#123;</span><br><span class="line">  const props = &#123;firstName: &#x27;Ben&#x27;, lastName: &#x27;Hector&#x27;&#125;;</span><br><span class="line">  return &lt;Greeting &#123;...props&#125; /&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>Context 相关 API:</strong></p><p>React.createContext</p><ul><li>创建一个需要共享的对象</li><li>如果一个组件订阅了 Context，那么这个组件会从离自身最近的那个匹配的 Provider 中读取到当前的 context 值</li><li>defaultValue 时组件在顶层查找过程中没有找到对应的 Provider，那么就使用默认值</li></ul><p>Context.Provider</p><ul><li>每个 Context 对象都会返回一个 Provider React 组件，它允许消费组件订阅 context 的变化</li><li>Provider 接受一个 value 属性，传递给消费组件</li><li>一个 Provider 可以和多个消费组件有对应关系</li><li>多个 Provider 也可以嵌套使用，里层的会覆盖外层的数据</li><li>当 Provider 的 value 值发生变化时，它内部所有的消费组件都会重新渲染</li></ul><p>Class.contextType</p><ul><li>挂载在 class 上的 contextType 属性会被重新赋值为一个由 React.createContext()创建的 Context 对象</li><li>这能让你是哟个 this.context 来消费最近 Context 上的那个值</li><li>你可以在任何生命周期中访问到它，包括 render 函数中</li></ul><p>Context.Consumer</p><ul><li>函数作为子元素，接收当前 context 值，返回一个 React 节点</li></ul><p>类组件的 context 跨组件通信：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">//通过Context传递数据</span><br><span class="line">//1.创建Context对象</span><br><span class="line">const UserContext = React.createContext(&#123;</span><br><span class="line">  //传入默认值</span><br><span class="line">  nickname: &quot;aaa&quot;,</span><br><span class="line">  level: -1,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">class ProfileSon extends Component &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &#123;/* 6.通过类组件的this.context使用数据 */&#125;</span><br><span class="line">        &lt;h2&gt;用户昵称：&#123;this.context.nickname&#125;&lt;/h2&gt;</span><br><span class="line">        &lt;h2&gt;用户等级：&#123;this.context.level&#125;&lt;/h2&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">ProfileSon.contextType = UserContext; //5.取出共享的数据</span><br><span class="line"></span><br><span class="line">function Profile(props) &#123;</span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;ProfileSon /&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default class App extends Component &#123;</span><br><span class="line">  constructor(props) &#123;</span><br><span class="line">    super(props);</span><br><span class="line">    this.state = &#123;</span><br><span class="line">      nickname: &quot;Kobe&quot;,</span><br><span class="line">      level: 99,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &#123;/*2.拿到创建的UserContext对象，使用对象里面的Provider组件 */&#125;</span><br><span class="line">        &lt;UserContext.Provider value=&#123;this.state&#125;&gt;</span><br><span class="line">          &#123;/*3.使用value，共享数据给所有子组件*/&#125;</span><br><span class="line">          &lt;Profile /&gt;</span><br><span class="line">          &#123;/*4.传数据给Profile组件的子组件，需将Profile组件放在Provider组件里面*/&#125;</span><br><span class="line">        &lt;/UserContext.Provider&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>函数组件的 context 跨组件通信：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">//通过Context传递数据</span><br><span class="line">//1.创建Context对象</span><br><span class="line">const UserContext = React.createContext(&#123;</span><br><span class="line">  //传入默认值</span><br><span class="line">  nickname: &quot;aaa&quot;,</span><br><span class="line">  level: -1,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">function ProfileSon() &#123;</span><br><span class="line">  return (</span><br><span class="line">    // 5.使用Consumer组件</span><br><span class="line">    &lt;UserContext.Consumer&gt;</span><br><span class="line">      &#123;</span><br><span class="line">        value =&gt; &#123; //6.使用函数接收共享数据</span><br><span class="line">          //value为提供的value值</span><br><span class="line">          return (</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">              &#123;/* 7.使用数据 */&#125;</span><br><span class="line">              &lt;h2&gt;用户昵称：&#123;value.nickname&#125;&lt;/h2&gt;</span><br><span class="line">              &lt;h2&gt;用户等级：&#123;value.level&#125;&lt;/h2&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">          );</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &lt;/UserContext.Consumer&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function Profile(props) &#123;</span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;ProfileSon /&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default class App extends Component &#123;</span><br><span class="line">  constructor(props) &#123;</span><br><span class="line">    super(props);</span><br><span class="line"></span><br><span class="line">    this.state = &#123;</span><br><span class="line">      nickname: &quot;Kobe&quot;,</span><br><span class="line">      level: 99,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &#123;/*2.拿到创建的UserContext对象，使用对象里面的Provider组件 */&#125;</span><br><span class="line">        &lt;UserContext.Provider value=&#123;this.state&#125;&gt;</span><br><span class="line">          &#123;/*3.使用value，共享数据给所有子组件*/&#125;</span><br><span class="line">          &lt;Profile /&gt;&#123;&quot; &quot;&#125;</span><br><span class="line">          &#123;/*4.传数据给Profile组件的子组件，需将Profile组件放在Provider组件里面*/&#125;</span><br><span class="line">        &lt;/UserContext.Provider&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="setState"><a href="#setState" class="headerlink" title="setState"></a>setState</h4><p>通过 setState 修改数据，告知 React 数据发生了改变，使其重新渲染页面</p><p>setState 是异步更新的(不能在执行完 setState 之后立马拿到最新的 state 结果)：</p><ul><li>可以显著地提高性能(获取多个更新，再批量进行更新)</li><li>如果同步更新了 state，但还没有执行 render 函数，那么 state 和 props 不能保持一致性，会引发很多问题</li></ul><p>拿到异步更新的结果：</p><ol><li>componentDidUpdate(){}</li><li>this.setState({//更新的数据}, //回调函数,拿到更新后的数据)</li></ol><p>在组件生命周期或 React 合成事件中，setState 是异步</p><p>在 setTimeout 或者原生 DOM 事件中，setState 是同步</p><p>使 setState 合并时进行累加：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">this.setState((preState, props) =&gt; &#123;</span><br><span class="line">	return &#123;</span><br><span class="line">		counter: preState.counter + 1  //合并时将前一次的值加1</span><br><span class="line">	&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h4 id="key-的优化"><a href="#key-的优化" class="headerlink" title="key 的优化"></a>key 的优化</h4><ul><li>key 应该是唯一的</li><li>key 不要使用随机数</li><li>使用 index 作为 key，对性能是没有优化的</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  this.state.movies.map((item, index) =&gt; &#123;</span><br><span class="line">    return &lt;li key=&#123;item&#125;&gt;&#123;item&#125;&lt;/li&gt;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="组件嵌套的-render-调用"><a href="#组件嵌套的-render-调用" class="headerlink" title="组件嵌套的 render 调用"></a>组件嵌套的 render 调用</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">shuoldComponentUpdate(nextProps, nextState)&#123;</span><br><span class="line">  //nextProps:props修改之后，最新的props属性</span><br><span class="line">  //nextState:state修改之后，最新的state属性</span><br><span class="line">	if(this.state.counter !== nextState.counter)&#123;</span><br><span class="line">		return true;</span><br><span class="line">	&#125;</span><br><span class="line">	return false;</span><br><span class="line">&#125;</span><br><span class="line">//返回true，调用render方法</span><br><span class="line">//返回false，不调用render方法</span><br><span class="line">//默认返回true，即state发生改变，就会调用render方法</span><br></pre></td></tr></table></figure><p>另一种优化方法：</p><ul><li>类组件继承 PureComponent:</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123;PureComponent&#125; from &#x27;react&#x27; //将Component改为PureComponent</span><br><span class="line">class Banner extends PureComponent &#123;&#125;</span><br><span class="line">//这样的话React会自动判断数据更新后要不要调用render方法</span><br></pre></td></tr></table></figure><ul><li>函数组件需要包裹一个 memo:</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123;PureComponent, memo&#125; from &#x27;react&#x27;</span><br><span class="line">const MemoHeader = memo(&#123; //作用同PureComponent</span><br><span class="line">  console.log(&#x27;Header被调用&#x27;);</span><br><span class="line">	return &lt;h2&gt;我是Header组件&lt;/h2&gt;</span><br><span class="line">&#125;);//参数为一个组件,返回一个新的组件</span><br><span class="line"></span><br><span class="line">//使用：</span><br><span class="line">&lt;MemoHeader/&gt;</span><br></pre></td></tr></table></figure><h4 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">const newFriends = this.state.friends;	//赋值后两个数组内存地址一样</span><br><span class="line">const newFriends = [...this.state.friends]; //会创建一个新内存空间，两个数组地址不一样</span><br></pre></td></tr></table></figure><p>数据不可变性原因：</p><p>直接修改数据内存地址不会变，会导致 ShouldComponentUpdate 的性能优化不起作用</p><p>采用整体赋值改变内存地址，使性能优化起作用</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// 推荐做法</span><br><span class="line">const newFriends = [...this.state.friends];</span><br><span class="line">const newFriends.push(&#123;name: &quot;tom&quot;&#125;);</span><br><span class="line">this.setState(&#123;</span><br><span class="line">  friends: newFriends</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="全局事件传递"><a href="#全局事件传递" class="headerlink" title="全局事件传递"></a>全局事件传递</h4><p>事件总线 event bus</p><p>安装使用：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">yarn add events</span><br><span class="line"></span><br><span class="line">import &#123;EventEmitter&#125; from &#x27;events&#x27;	//导入</span><br><span class="line">//事件总线</span><br><span class="line">const eventBus = new EventEmitter(); //实例化</span><br></pre></td></tr></table></figure><p>例子：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; PureComponent &#125; from &#x27;react&#x27;</span><br><span class="line"></span><br><span class="line">import &#123;EventEmitter&#125; from &#x27;events&#x27;	//1.导入</span><br><span class="line">//事件总线</span><br><span class="line">const eventBus = new EventEmitter(); //2.实例化</span><br><span class="line"></span><br><span class="line">class Home extends PureComponent &#123;</span><br><span class="line">  componentDidMount() &#123; //5.在此进行事件监听</span><br><span class="line">    //(监听的事件名,自定义函数)</span><br><span class="line">    eventBus.addListener(&quot;sayHello&quot;, this.handleSayHelloListener);</span><br><span class="line">  &#125;</span><br><span class="line">  componentWillUnmount() &#123; //6.在此取消事件监听</span><br><span class="line">    eventBus.removeListener(&quot;sayHello&quot;, this.handleSayHelloListener);</span><br><span class="line">  &#125;</span><br><span class="line">  handleSayHelloListener(...args) &#123; //7.自定义函数，处理事件,接收多个参数</span><br><span class="line">    console.log(args);</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        Home</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">class Profile extends PureComponent &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        Profile</span><br><span class="line">        &#123;/*4.传递事件*/&#125;</span><br><span class="line">        &lt;button onClick=&#123;e =&gt; &#123;this.emitEvent()&#125;&#125;&gt;点击了Profile&lt;/button&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">  emitEvent() &#123;</span><br><span class="line">    //3.发射事件 (事件名字,参数1,参数2,...)</span><br><span class="line">    eventBus.emit(&quot;sayHello&quot;, &#x27;Hello Home&#x27;, 123);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default class App extends PureComponent &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;Home/&gt;</span><br><span class="line">        &lt;Profile/&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="refs"><a href="#refs" class="headerlink" title="refs"></a>refs</h4><p>不推荐直接操作 DOM 元素</p><p>创建 refs 获取对应 DOM</p><ol><li><p>传入字符串(不推荐，后续更新可能会被删除)</p><p>使用时通过 this.refs.传入的字符串格式获取对应的元素</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">export default class App extends PureComponent &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &#123;/* &lt;h2 ref=字符串/对象/函数&lt;/div&gt;  &lt;/h2&gt; */&#125;</span><br><span class="line">        &#123;/* 字符串 */&#125;</span><br><span class="line">        &lt;h2 ref=&quot;titleRef&quot;&gt;Hello React&lt;/h2&gt;</span><br><span class="line">        &lt;button onClick=&#123;e =&gt; this.changeText() &#125;&gt;改变文本&lt;/button&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">  changeText() &#123;	//通过字符串操作DOM元素,不推荐，后续更新可能会删除</span><br><span class="line">    this.refs.titleRef.innerHTML = &#x27;Hello CoderWhy&#x27;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>传入一个对象(react 推荐的方式)</p><ul><li><p>对象通过 React.createRef()方式创建出来</p></li><li><p>使用时获取到创建的对象其中有一个 current 属性就是对应元素</p></li><li><p><strong>当 ref 在类组件里面的时候，最终获取到的 current 是一个组件对象</strong></p></li><li><p><strong>不能在函数组件上使用 ref 属性，因为他们没有实例</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; PureComponent, createRef &#125; from &#x27;react&#x27;</span><br><span class="line"></span><br><span class="line">export default class App extends PureComponent &#123;</span><br><span class="line">  constructor(props) &#123;</span><br><span class="line">    super(props);</span><br><span class="line">    this.titleRef = createRef();  //1.在构造器创建好ref并放到当前对象里面(this里面)</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &#123;/* 通过createRef创建ref对象 目前React推荐的方式 */&#125;</span><br><span class="line">        &#123;/* 2.使用 */&#125;</span><br><span class="line">        &lt;h2 ref=&#123; this.titleRef &#125;&gt;Hello React&lt;/h2&gt;</span><br><span class="line">        &lt;button onClick=&#123;e =&gt; this.changeText() &#125;&gt;改变文本&lt;/button&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">  changeText() &#123;</span><br><span class="line">    this.titleRef.current.innerHTML = &#x27;Hello World&#x27;;&#123;/*3.操作DOM*/&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ul></li><li><p>传入一个函数</p><ul><li>该函数会在 DOM 被挂载时进行回调，这个函数会传入一个元素对象，我们可以自己保存</li><li>使用时拿到之前保存的元素对象</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">export default class App extends PureComponent &#123;</span><br><span class="line">  constructor(props) &#123;</span><br><span class="line">    super(props);</span><br><span class="line">    this.titEl = null;  //1.定义一个空对象</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &#123;/* 函数 */&#125;</span><br><span class="line">        &#123;/* 2.使用,传入一个函数，函数自带一个参数 */&#125;</span><br><span class="line">        &lt;h2 ref=&#123; arg =&gt; this.titEl = arg &#125;&gt;Hello World&lt;/h2&gt;</span><br><span class="line">        &lt;button onClick=&#123;e =&gt; this.changeText() &#125;&gt;改变文本&lt;/button&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">  changeText() &#123;</span><br><span class="line">    this.titEl.innerHTML = &#x27;Hello React&#x27;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h4 id="受控组件"><a href="#受控组件" class="headerlink" title="受控组件"></a>受控组件</h4><p>渲染表单的 React 组件控制着用户输入过程中表单发生的操作，被 React 以这种方式控制取值的表单输入元素就叫做<strong>受控组件</strong></p><p>受控非受控组件一般和表单元素有关系</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">render() &#123;</span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;form onSubmit=&#123; e =&gt; this.handleSubmit(e) &#125;&gt;</span><br><span class="line">        &lt;label htmlFor=&quot;username&quot;&gt;</span><br><span class="line">          用户名：</span><br><span class="line">          &#123;/* 受控组件 */&#125;</span><br><span class="line">          &lt;input type=&quot;text&quot;</span><br><span class="line">            id=&quot;username&quot;</span><br><span class="line">            onChange=&#123;e =&gt; this.handleChange(e) &#125;</span><br><span class="line">            value=&#123;this.state.username&#125;</span><br><span class="line">            /&gt;</span><br><span class="line">          &#123;/* 受控组件 */&#125;</span><br><span class="line">          &lt;select</span><br><span class="line">            name=&quot;fruits&quot;</span><br><span class="line">            onChange=&#123;e =&gt; this.handleSelectChange(e)&#125; &#123;/*监听select*/&#125;</span><br><span class="line">            value=&#123;this.state.fruits&#125; &#123;/*设置默认值*/&#125;</span><br><span class="line">            &gt;</span><br><span class="line">            &lt;option value=&quot;apple&quot;&gt;苹果&lt;/option&gt;</span><br><span class="line">            &lt;option value=&quot;banana&quot;&gt;香蕉&lt;/option&gt;</span><br><span class="line">            &lt;option value=&quot;orange&quot;&gt;橘子&lt;/option&gt;</span><br><span class="line">          &lt;/select&gt;</span><br><span class="line">        &lt;/label&gt;</span><br><span class="line">        &lt;button type=&quot;submit&quot;&gt;提交&lt;/button&gt;</span><br><span class="line">      &lt;/form&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line">handleSubmit(event) &#123;</span><br><span class="line">  e.preventDefault; //阻止表单默认事件</span><br><span class="line">  console.log(this.state.username);</span><br><span class="line">&#125;</span><br><span class="line">handleChange(event) &#123;</span><br><span class="line">  this.setState(&#123;</span><br><span class="line">    username: event.target.value</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>多输入：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">export default class APp extends PureComponent &#123;</span><br><span class="line">  constructor(props) &#123;</span><br><span class="line">    super(props);</span><br><span class="line"></span><br><span class="line">    this.state = &#123;  //表单输入的任何东西都会被保存到这里</span><br><span class="line">      username: &quot;&quot;,</span><br><span class="line">      password: &quot;&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;form onSubmit=&#123; e =&gt; this.handleSubmit(e) &#125;&gt;</span><br><span class="line">          &lt;label htmlFor=&quot;username&quot;&gt;</span><br><span class="line">            用户名：</span><br><span class="line">            &lt;input type=&quot;text&quot;</span><br><span class="line">                   id=&quot;username&quot;</span><br><span class="line">                   name=&quot;username&quot;</span><br><span class="line">                   onChange=&#123;e =&gt; this.handleChange(e) &#125;</span><br><span class="line">                   value=&#123;this.state.username&#125;</span><br><span class="line">                   /&gt;</span><br><span class="line">          &lt;/label&gt;</span><br><span class="line">          &lt;label htmlFor=&quot;password&quot;&gt;</span><br><span class="line">            密码：</span><br><span class="line">            &lt;input type=&quot;text&quot;</span><br><span class="line">                   id=&quot;password&quot;</span><br><span class="line">                   name=&quot;password&quot;</span><br><span class="line">                   onChange=&#123;e =&gt; this.handleChange(e) &#125;</span><br><span class="line">                   value=&#123;this.state.password&#125;</span><br><span class="line">                   /&gt;</span><br><span class="line">          &lt;/label&gt;</span><br><span class="line">          &lt;button type=&quot;submit&quot;&gt;提交&lt;/button&gt;</span><br><span class="line">        &lt;/form&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">  handleSubmit(e) &#123;</span><br><span class="line">    e.preventDefault(); //阻止默认行为</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">  handleChange(event) &#123;//event.target.name的值就是表单中name的值</span><br><span class="line">    this.setState(&#123; //通过es6语法合并修改值时的操作</span><br><span class="line">      [event.target.name]: event.target.value</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="非受控组件"><a href="#非受控组件" class="headerlink" title="非受控组件"></a>非受控组件</h4><p>表单数据交由 DOM 节点处理(不建议使用)</p><h4 id="高阶组件-HOC"><a href="#高阶组件-HOC" class="headerlink" title="高阶组件 HOC"></a>高阶组件 HOC</h4><p>参数和返回值都为组件的<strong>函数</strong>(高阶组件本身不是一个组件，是一个函数)</p><p>ES6 中，类表达式的类名都是可以省略的</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">function enhanceComponent(WrappedComponent) &#123;	//定义高阶组件</span><br><span class="line">  return class NewComponent extends PureComponent &#123;  //返回类组件,NewComponent可以省略</span><br><span class="line">    render() &#123;</span><br><span class="line">      return &lt;WrappedComponent/&gt;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">const enhanceComponent = enhanceComponent(App);	//使用</span><br><span class="line"></span><br><span class="line">function enhanceComponent2(WrappedComponent) &#123; //定义高阶组件</span><br><span class="line">  return function NewComponent(props) &#123;  //返回函数组件</span><br><span class="line">    return &lt;WrappedComponent/&gt;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>组件的名称都可以通过 displayName 来修改</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">App.displayName = &#x27;CoderWhy&#x27;;</span><br></pre></td></tr></table></figure><p>可以用来增强 props、登录鉴权操作、生命周期劫持等操作(详见 10.高阶组件)</p><p>组件名.name; //拿到组件名字</p><p>不要继承自己定义的组件</p><h4 id="ref-的转发"><a href="#ref-的转发" class="headerlink" title="ref 的转发"></a>ref 的转发</h4><p>作用：在函数组件中使用 ref</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; PureComponent, createRef, forwardRef &#125; from &#x27;react&#x27;</span><br><span class="line"></span><br><span class="line">const Profile = forwardRef(function(props, ref) &#123; //3.接收的ref</span><br><span class="line">  return &lt;p ref=&#123;ref&#125;&gt;Profile&lt;/p&gt;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">export default class App extends PureComponent &#123;</span><br><span class="line">  constructor(props) &#123;</span><br><span class="line">    super(props);</span><br><span class="line"></span><br><span class="line">    this.profileRef = createRef();//1.创建</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;Profile ref=&#123;this.profileRef&#125;/&gt;</span><br><span class="line">        &#123;/* 2.传入的ref */&#125;</span><br><span class="line">        &lt;button onClick=&#123; e =&gt; this.printRef() &#125;&gt;打印ref&lt;/button&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  printRef() &#123;</span><br><span class="line">    console.log(this.profileRef.current);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Portals-的使用"><a href="#Portals-的使用" class="headerlink" title="Portals 的使用"></a>Portals 的使用</h4><p>使渲染的内容独立于父组件甚至独立于当前挂载到的 DOM 元素中</p><p>ReactDOM.createPortal(child, container);</p><ul><li>child:任何可渲染的 React 子元素</li><li>container:一个 DOM 元素</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">//index.html</span><br><span class="line">&lt;div id=&quot;modal&quot;&gt;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">//index.css</span><br><span class="line">#modal &#123;</span><br><span class="line">  position: fixed;</span><br><span class="line">  left: 50%;</span><br><span class="line">  top: 50%;</span><br><span class="line">  transform: translate(-50%, -50%);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//index.js</span><br><span class="line">import App from &#x27;./组件内容补充/02_portals的使用&#x27;</span><br><span class="line">import &quot;./css/index.css&quot;;</span><br><span class="line"></span><br><span class="line">//02_portals的使用</span><br><span class="line">import React, &#123; PureComponent &#125; from &quot;react&quot;;</span><br><span class="line">import ReactDOM from &quot;react-dom&quot;;</span><br><span class="line">class Modal extends PureComponent &#123; //modal组件</span><br><span class="line">  render() &#123;</span><br><span class="line">    return ReactDOM.createPortal(</span><br><span class="line">      this.props.children, //Modal里面的所有子组件</span><br><span class="line">      document.getElementById(&quot;modal&quot;)</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">export default class App extends PureComponent &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;p&gt;渲染到屏幕中间&lt;/p&gt;</span><br><span class="line">        &lt;Modal&gt;</span><br><span class="line">          &lt;h2&gt;Title&lt;/h2&gt;</span><br><span class="line">        &lt;/Modal&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="fragment"><a href="#fragment" class="headerlink" title="fragment"></a>fragment</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; PureComponent, Fragment &#125; from &#x27;react&#x27;;</span><br><span class="line">&lt;Fragment key=&#123;item.name&#125;&gt;</span><br><span class="line">  &lt;h2&gt;Hello World&lt;/h2&gt;</span><br><span class="line">  &lt;p&gt;xixixii&lt;/p&gt;</span><br><span class="line">  &lt;hr/&gt;</span><br><span class="line">&lt;/Fragment&gt;</span><br><span class="line">//渲染时,h2和p标签会被直接渲染，外面用来包裹的fragment不会被渲染</span><br><span class="line"></span><br><span class="line">//短语法，省略fragment名字,但是里面不能添加任何属性，要添加属性必须加上Fragment才不会报错</span><br><span class="line">&lt;&gt;</span><br><span class="line">  &lt;h2&gt;Hello World&lt;/h2&gt;</span><br><span class="line">  &lt;p&gt;xixixii&lt;/p&gt;</span><br><span class="line">  &lt;hr/&gt;</span><br><span class="line">&lt;/&gt;</span><br></pre></td></tr></table></figure><h4 id="StrictMode-严格模式"><a href="#StrictMode-严格模式" class="headerlink" title="StrictMode 严格模式"></a>StrictMode 严格模式</h4><p>用来突出显示应用程序中潜在问题的工具</p><ul><li>与 fragment 一样，StrrictMode 不会渲染任何可见的 UI</li><li>它为其后代元素触发额外的检查和警告(只会对自己的后代元素进行检查)</li><li>严格模式检查仅在开发模式下运行，不会影响生产构建</li><li>严格模式下组件会渲染(render)两次</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;React.StrictMode&gt;</span><br><span class="line">  &lt;App /&gt;</span><br><span class="line">&lt;/React.StrictMode&gt;</span><br><span class="line"></span><br><span class="line">import &#123;StrictMode&#125; from &#x27;React&#x27; //导入后可以直接写</span><br><span class="line">&lt;StrictMode&gt;</span><br><span class="line">&lt;/StrictMode&gt;</span><br></pre></td></tr></table></figure><ol><li>识别不安全的生命周期</li><li>使用过时的 ref API</li><li>检查意外的副作用<ol><li>这个组件的 constructor 会被故意调用两次，让你查看在此的一些逻辑代码被调用多次时，是否会产生一些副作用</li><li>在生产环境中不会被调用两次</li></ol></li><li>使用废弃的 findDOMNode 方法</li><li>检测过时的 context API</li></ol><h3 id="React-中的样式"><a href="#React-中的样式" class="headerlink" title="React 中的样式"></a>React 中的样式</h3><h4 id="内联样式"><a href="#内联样式" class="headerlink" title="内联样式"></a>内联样式</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">export default class App extends PureComponent &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    const pStyle = &#123;</span><br><span class="line">      color: &quot;orange&quot;,</span><br><span class="line">      textDecoration: &quot;line-through&quot;</span><br><span class="line">    &#125;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;h2 style=&#123;&#123;fontSize: &quot;50px&quot;, color: &quot;red&quot;&#125;&#125;&gt;我是标题&lt;/h2&gt;</span><br><span class="line">        &#123;/*只能写驼峰*/&#125;</span><br><span class="line">        &#123;/*尽量用双引号，有些语法不支持单引号*/&#125;</span><br><span class="line">        &lt;p style=&#123;pStyle&#125;&gt;我是一段文字描述&lt;/p&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>样式之间不会有冲突，可以动态获取当前 state 中的状态</p><h4 id="普通-css"><a href="#普通-css" class="headerlink" title="普通 css"></a>普通 css</h4><p>会和其它组件的样式产生冲突</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">//app -&gt; index.js style.css</span><br><span class="line">//index.js</span><br><span class="line">import &#x27;./style.css&#x27; //引入css样式</span><br><span class="line">export default class App extends PureComponent &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;h2 className=&quot;title&quot;&gt;app的标题&lt;/h2&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">//style.css正常写css就行</span><br></pre></td></tr></table></figure><h4 id="css-modules"><a href="#css-modules" class="headerlink" title="css modules"></a>css modules</h4><p>非 React 独有方案，所有使用了类似于 webpack 配置的环境下都可以使用的</p><ul><li>引用的类名不能使用连接符(.home-title),在 JS 中是不识别的</li><li>所有的 className 必须使用{style.className}的形式来编写</li><li>不方便动态修改某些样式，依然需要使用内联样式的方式</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">//app -&gt; index.js style.module.css</span><br><span class="line">//index.js</span><br><span class="line">import appStyle from &#x27;./style.module.css&#x27;</span><br><span class="line">export default class App extends PureComponent &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;h2 className=&#123;appStyle.title&#125;&gt;app的标题&lt;/h2&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="css-in-js"><a href="#css-in-js" class="headerlink" title="css in js"></a>css in js</h4><ul><li><p>styled-components 库</p><p>安装：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add styled-components</span><br></pre></td></tr></table></figure><p><strong>标签模板字符串</strong>:可以通过模板字符串的方式对函数进行调用</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params">...args</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(args)</span><br><span class="line">&#125;</span><br><span class="line">test<span class="string">`aaa`</span></span><br><span class="line">test<span class="string">`my name is <span class="subst">$&#123;name&#125;</span>, age is <span class="subst">$&#123;age&#125;</span>`</span></span><br></pre></td></tr></table></figure><p>使用：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">//style.js</span><br><span class="line">import styled from &#x27;styled-components&#x27;</span><br><span class="line">export const HomeWrapper = styled.div`		//调用div函数，返回一个组件,组件生成的是一个div元素</span><br><span class="line">  font-size: 50px;</span><br><span class="line">  color: red;</span><br><span class="line">  .banner &#123;</span><br><span class="line">    color:orange;</span><br><span class="line">  &#125;</span><br><span class="line">  background-image:url($&#123;require(&quot;@/assets/img/a.png&quot;)&#125;); //引入背景图片</span><br><span class="line">`</span><br><span class="line">//建议嵌套写(写法同less)</span><br><span class="line">//如果出现冲突就单独再弄一个组件</span><br><span class="line">//样式单独弄一个文件，将创建的组件导出</span><br><span class="line">export const TitleWrapper = styled.h2`	//组件生成的是一个h2元素</span><br><span class="line">  background-color:orange;</span><br><span class="line">`</span><br><span class="line"></span><br><span class="line">//index.js</span><br><span class="line">import React, &#123; PureComponent &#125; from &#x27;react&#x27;</span><br><span class="line">import &#123; HomeWrapper, TitleWrapper &#125; from &#x27;./style&#x27;</span><br><span class="line">export default class App extends PureComponent &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;HomeWrapper&gt;</span><br><span class="line">        &lt;TitleWrapper&gt;App&lt;/TitleWrapper&gt;</span><br><span class="line">        &lt;span className=&quot;banner&quot;&gt;样式嵌套&lt;/span&gt;</span><br><span class="line">      &lt;/HomeWrapper&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>动态样式</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">//index.js</span><br><span class="line">import &#123; HYInput &#125; from &#x27;./style&#x27;</span><br><span class="line">export default class App extends PureComponent &#123;</span><br><span class="line">  constructor(props) &#123;</span><br><span class="line">    super(props);</span><br><span class="line"></span><br><span class="line">    this.state = &#123;</span><br><span class="line">      color: &quot;red&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;HYInput type=&quot;text&quot; color=&#123;this.state.color&#125;/&gt;</span><br><span class="line">        &#123;/* 动态获取state里面的color，传入样式中的attrs中去 */&#125;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">//style.js</span><br><span class="line">import styled from &#x27;styled-components&#x27;</span><br><span class="line">export const HYInput = styled.input.attrs(&#123; //可在此编写属性</span><br><span class="line">  placeholder: &quot;coderWhy&quot;,</span><br><span class="line">  bColor:&quot;red&quot;</span><br><span class="line">&#125;)`</span><br><span class="line">  background-color:lightblue;</span><br><span class="line">  border-color: $&#123;props =&gt; props.bColor&#125;;	//props为箭头函数的参数,attrs中所有属性会传入到props中</span><br><span class="line">  color:$&#123;props =&gt; props.color&#125; // 写在HYInput中的属性也会传过来</span><br><span class="line">  /* 调用传入到attrs中的state中的color属性 */</span><br><span class="line">`;</span><br><span class="line">//箭头函数会将attrs的所有属性传入</span><br></pre></td></tr></table></figure><p><strong>继承</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">const HYButton = styled.button`</span><br><span class="line">  padding: 10px 20px;</span><br><span class="line">  color: red;</span><br><span class="line">`</span><br><span class="line">//继承HYButton已有的样式</span><br><span class="line">const HYPrimaryButton = styled(HYButton)`</span><br><span class="line">  color: #fff;</span><br><span class="line">  background-color: green;</span><br><span class="line">`</span><br><span class="line">export default class App extends PureComponent &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;HYButton&gt;我是普通按钮&lt;/HYButton&gt;</span><br><span class="line">        &lt;HYPrimaryButton&gt;我是主要按钮&lt;/HYPrimaryButton&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>自定义主题</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">//用于存放共享样式</span><br><span class="line">import styled, &#123; ThemeProvider &#125; from &#x27;styled-components&#x27;</span><br><span class="line">export default class App extends PureComponent &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;ThemeProvider theme=&#123;&#123;themeColor:&quot;yellow&quot;, fontSize: &quot;30px&quot;&#125;&#125;&gt;</span><br><span class="line">        &#123;/*在其他组件使用： color:$&#123;props =&gt; props.theme.themeColor&#125; */&#125;</span><br><span class="line">      &lt;/ThemeProvider&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>emotion 库</p></li><li><p>glamorous 库</p></li></ul><h3 id="AntDesign-UI-组件库"><a href="#AntDesign-UI-组件库" class="headerlink" title="AntDesign UI 组件库"></a>AntDesign UI 组件库</h3><p>官网：<span class="exturl" data-url="aHR0cHM6Ly9hbnQuZGVzaWduL2RvY3MvcmVhY3QvaW50cm9kdWNlLWNu">https://ant.design/docs/react/introduce-cn<i class="fa fa-external-link-alt"></i></span></p><h4 id="classnames"><a href="#classnames" class="headerlink" title="classnames"></a>classnames</h4><p>动态添加 classnames 的库</p><p>安装：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add classnames</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">import classNames from &#x27;classnames&#x27;	//导入包</span><br><span class="line">export default class App extends PureComponent &#123;</span><br><span class="line">  constructor(props) &#123;</span><br><span class="line">    super(props);</span><br><span class="line"></span><br><span class="line">    this.state = &#123;</span><br><span class="line">      isActive: true</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    const &#123; isActive &#125; = this.state;</span><br><span class="line">    const isBar = false;</span><br><span class="line">    const errClass = &quot;error&quot;;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &#123;/* 原生React中添加类的方法 */&#125;</span><br><span class="line">        &lt;h2 className=&quot;foo bar active title&quot;&gt;我是标题1&lt;/h2&gt;</span><br><span class="line">        &lt;h2 className=&#123;&quot;foo bar active title&quot;&#125;&gt;我是标题2&lt;/h2&gt;</span><br><span class="line">        &lt;h2 className=&#123;&quot;title&quot; + (isActive ? &quot; active&quot;: &quot;&quot;)&#125;&gt;我是标题3&lt;/h2&gt;</span><br><span class="line">        &lt;h2 className=&#123;[&quot;title&quot;,(isActive ? &quot;active&quot;: &quot;&quot;)].join(&quot; &quot;)&#125;&gt;我是标题4&lt;/h2&gt;</span><br><span class="line"></span><br><span class="line">        &#123;/* classnames库添加class */&#125;</span><br><span class="line">        &lt;h2 className=&#123;classNames(&quot;foo&quot;, &quot;bar&quot;, &quot;active &quot;)&#125;&gt;我是标题5&lt;/h2&gt;</span><br><span class="line"></span><br><span class="line">         &#123;/* 前面两个类根据布尔值判断加不加，后面的title类直接加到元素里面 */&#125;</span><br><span class="line">        &lt;h2 className=&#123;classNames(&#123;&quot;active&quot;: isActive, &quot;bar&quot;: isBar&#125;, &quot;title&quot;)&#125;&gt;我是标题6&lt;/h2&gt;</span><br><span class="line"></span><br><span class="line">        &#123;/* errClass为变量，变量为true，就把变量的值转为字符串加进来,若变量的值判断为false,则不会添加此类名 */&#125;</span><br><span class="line">        &lt;h2 className=&#123;classNames(&quot;foo&quot;, errClass, &#123;&quot;active&quot;: isActive&#125;)&#125;&gt;我是标题7&lt;/h2&gt;</span><br><span class="line"></span><br><span class="line">        &#123;/* 跟上数组 */&#125;</span><br><span class="line">        &lt;h2 className=&#123;classNames([&quot;active&quot;, &quot;title&quot;])&#125;&gt;我是标题8&lt;/h2&gt;</span><br><span class="line"></span><br><span class="line">        &#123;/* 数组里面跟对象 */&#125;</span><br><span class="line">        &lt;h2 className=&#123;classNames([&quot;active&quot;, &quot;title&quot;, &#123;&quot;bar&quot;: isBar&#125;])&#125;&gt;我是标题9&lt;/h2&gt;</span><br><span class="line"></span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="AntDesign-兼容性"><a href="#AntDesign-兼容性" class="headerlink" title="AntDesign 兼容性"></a>AntDesign 兼容性</h4><ul><li>现代浏览器和 ie11(需要 polyfills)</li><li>支持服务端渲染</li><li>Electron</li></ul><h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install antd --save</span><br><span class="line">yarn add antd</span><br></pre></td></tr></table></figure><p>导入：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import &#123; Button &#125; from &#x27;antd&#x27; //导入按钮组件</span><br></pre></td></tr></table></figure><p>组件：<span class="exturl" data-url="aHR0cHM6Ly9hbnQuZGVzaWduL2NvbXBvbmVudHMvb3ZlcnZpZXctY24v">https://ant.design/components/overview-cn/<i class="fa fa-external-link-alt"></i></span></p><h4 id="组件显示中文"><a href="#组件显示中文" class="headerlink" title="组件显示中文"></a>组件显示中文</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">import &#123; ConfigProvider &#125; from &#x27;antd&#x27;;</span><br><span class="line">import zh_CN from &#x27;antd/lib/locale-provider/zh_CN&#x27;;</span><br><span class="line"></span><br><span class="line">&lt;ConfigProvider locale=&#123;zh_CN&#125;&gt;</span><br><span class="line">	// 包含App.js</span><br><span class="line">&lt;/ConfigProvider&gt;</span><br></pre></td></tr></table></figure><h4 id="AntDesign-图标"><a href="#AntDesign-图标" class="headerlink" title="AntDesign 图标"></a>AntDesign 图标</h4><p>安装</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install --save @ant-design/icons</span><br><span class="line">yarn add @ant-design/icons</span><br></pre></td></tr></table></figure><p>导入要使用的组件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">import &#123; DownloadOutlined &#125; from &#x27;@ant-design/icons&#x27;;</span><br><span class="line"></span><br><span class="line">import &#x27;antd/dist/antd.css&#x27; //在index.js里面引入antd的全局样式文件，使样式生效</span><br></pre></td></tr></table></figure><h4 id="moment-库"><a href="#moment-库" class="headerlink" title="moment 库"></a>moment 库</h4><p>安装：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add moment #对日期进行处理</span><br></pre></td></tr></table></figure><p>导入：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> import moment from &#x27;moment&#x27;</span><br><span class="line">//使用</span><br><span class="line">moment(createTime).format(&quot;YYYY-MM-DD HH:mm:ss&quot;)</span><br></pre></td></tr></table></figure><h4 id="craco"><a href="#craco" class="headerlink" title="craco"></a>craco</h4><p>对 create-react-app 进行自定义配置的社区解决方案</p><p>官网：<span class="exturl" data-url="aHR0cHM6Ly9hbnQuZGVzaWduL2RvY3MvcmVhY3QvdXNlLXdpdGgtY3JlYXRlLXJlYWN0LWFwcC1jbg==">https://ant.design/docs/react/use-with-create-react-app-cn<i class="fa fa-external-link-alt"></i></span></p><p>安装</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add @craco/craco</span><br></pre></td></tr></table></figure><p>在 package.json 里面修改启动过程</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">  <span class="string">&quot;start&quot;</span>: <span class="string">&quot;craco start&quot;</span>,</span><br><span class="line">  <span class="string">&quot;build&quot;</span>: <span class="string">&quot;craco build&quot;</span>,</span><br><span class="line">  <span class="string">&quot;test&quot;</span>: <span class="string">&quot;craco test&quot;</span>,</span><br><span class="line">  <span class="string">&quot;eject&quot;</span>: <span class="string">&quot;react-scripts eject&quot;</span></span><br><span class="line">&#125;,</span><br><span class="line"> <span class="comment">//修改之后，再使用yarn start 启动项目时会自动检查根目录是否有craco.config.js文件，并读取里面的配置</span></span><br></pre></td></tr></table></figure><p>在项目根目录下新建文件 craco.config.js</p><p><strong>配置主题</strong></p><p>修改主题需要先安装 craco-less</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add craco-less</span><br></pre></td></tr></table></figure><p>craco.config.js</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> CracoLessPlugin = <span class="built_in">require</span>(<span class="string">&#x27;craco-less&#x27;</span>) <span class="comment">//导入插件</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">plugin</span>: CracoLessPlugin,</span><br><span class="line">      <span class="attr">options</span>: &#123;</span><br><span class="line">        <span class="attr">lessLoaderOptions</span>: &#123;</span><br><span class="line">          <span class="attr">lessOptions</span>: &#123;</span><br><span class="line">            <span class="attr">modifyVars</span>: &#123; <span class="string">&#x27;@primary-color&#x27;</span>: <span class="string">&#x27;#1DA57A&#x27;</span> &#125;,</span><br><span class="line">            <span class="attr">javascriptEnabled</span>: <span class="literal">true</span>,</span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  ],</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>修改在 index.js 引入的 css 为 less</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">//import &#x27;antd/dist/antd.css&#x27;</span><br><span class="line">变成</span><br><span class="line">import &#x27;antd/dist/antd.less‘</span><br></pre></td></tr></table></figure><p><strong>配置别名</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>) <span class="comment">//导入自带的当前路径模块</span></span><br><span class="line"><span class="keyword">const</span> resolve = <span class="function">(<span class="params">dir</span>) =&gt;</span> path.resolve(__dirname, dir) <span class="comment">//当前路径(当前文件所在路径)拼接上传过来的dir路径</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="attr">webpack</span>: &#123;</span><br><span class="line">    <span class="attr">alias</span>: &#123;</span><br><span class="line">      <span class="string">&#x27;@&#x27;</span>: resolve(<span class="string">&#x27;src&#x27;</span>),</span><br><span class="line">      <span class="attr">components</span>: resolve(<span class="string">&#x27;src/components&#x27;</span>),</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="axios-库的使用"><a href="#axios-库的使用" class="headerlink" title="axios 库的使用"></a>axios 库的使用</h3><h4 id="安装-1"><a href="#安装-1" class="headerlink" title="安装"></a>安装</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add axios</span><br></pre></td></tr></table></figure><h4 id="导入"><a href="#导入" class="headerlink" title="导入"></a>导入</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br></pre></td></tr></table></figure><p>常在 componentDidMount 里面发送网络请求</p><h4 id="测试网络请求的网站："><a href="#测试网络请求的网站：" class="headerlink" title="测试网络请求的网站："></a>测试网络请求的网站：</h4><blockquote><p><span class="exturl" data-url="aHR0cDovL2h0dHBiaW4ub3JnLw==">http://httpbin.org/<i class="fa fa-external-link-alt"></i></span></p></blockquote><h4 id="axios-发送网络请求"><a href="#axios-发送网络请求" class="headerlink" title="axios 发送网络请求"></a>axios 发送网络请求</h4><p>不管怎么调用，最终都是使用 axios.request(config);来发送网络请求</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.axios发送基本的网络请求</span></span><br><span class="line">axios(&#123;</span><br><span class="line">  <span class="attr">url</span>: <span class="string">&#x27;http://httpbin.org/get&#x27;</span>, <span class="comment">//测试get请求,默认请求方式即为get</span></span><br><span class="line">  <span class="attr">params</span>: &#123;</span><br><span class="line">    <span class="comment">//参数</span></span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;why&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">18</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br><span class="line">  .then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(res)</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(err)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//post</span></span><br><span class="line">axios(&#123;</span><br><span class="line">  <span class="attr">url</span>: <span class="string">&#x27;http://httpbin.org/post&#x27;</span>,</span><br><span class="line">  <span class="attr">data</span>: &#123;</span><br><span class="line">    <span class="comment">//参数</span></span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;kobe&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">40</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">method</span>: <span class="string">&#x27;post&#x27;</span>, <span class="comment">//post请求时，此处必写，不可省略</span></span><br><span class="line">&#125;)</span><br><span class="line">  .then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(res)</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(err)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">axios</span><br><span class="line">  .get(<span class="string">&#x27;http://httpbin.org/get&#x27;</span>, &#123;</span><br><span class="line">    <span class="attr">params</span>: &#123;</span><br><span class="line">      <span class="comment">//参数</span></span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;ysj&#x27;</span>,</span><br><span class="line">      <span class="attr">age</span>: <span class="number">22</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(res)</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(err)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">axios</span><br><span class="line">  .post(<span class="string">&#x27;http://httpbin.org/post&#x27;</span>, &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;lucy&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">28</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(res)</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(err)</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure><h4 id="使用用-await-和-async-发送网络请求"><a href="#使用用-await-和-async-发送网络请求" class="headerlink" title="使用用 await 和 async 发送网络请求"></a>使用用 await 和 async 发送网络请求</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="title">componentDidMount</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">  <span class="comment">//await async 同步方式写异步代码</span></span><br><span class="line">  <span class="comment">//使用es7的await,所在函数前面必须写async</span></span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> result = <span class="keyword">await</span> axios.post(<span class="string">&quot;http://httpbin.org/post&quot;</span>, &#123;</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&quot;lucy&quot;</span>,</span><br><span class="line">        <span class="attr">age</span>: <span class="number">28</span>,</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="comment">//打印网络请求结果</span></span><br><span class="line">      <span class="built_in">console</span>.log(result);</span><br><span class="line">   &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(err);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//打印网络请求结果</span></span><br><span class="line">  <span class="built_in">console</span>.log(result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="axios-all：合并多个网络请求"><a href="#axios-all：合并多个网络请求" class="headerlink" title="axios.all：合并多个网络请求"></a>axios.all：合并多个网络请求</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//axios.all[request1, request2]</span></span><br><span class="line"><span class="keyword">const</span> request1 = axios(&#123;</span><br><span class="line">  <span class="attr">url</span>: <span class="string">&#x27;http://httpbin.org/get&#x27;</span>,</span><br><span class="line">  <span class="attr">params</span>: &#123; <span class="attr">name</span>: <span class="string">&#x27;why&#x27;</span>, <span class="attr">age</span>: <span class="number">18</span> &#125;,</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">const</span> request2 = axios(&#123;</span><br><span class="line">  <span class="attr">url</span>: <span class="string">&#x27;http://httpbin.org/post&#x27;</span>,</span><br><span class="line">  <span class="attr">data</span>: &#123; <span class="attr">name</span>: <span class="string">&#x27;kobe&#x27;</span>, <span class="attr">age</span>: <span class="number">40</span> &#125;,</span><br><span class="line">  <span class="attr">method</span>: <span class="string">&#x27;post&#x27;</span>,</span><br><span class="line">&#125;)</span><br><span class="line">axios.all([request1, request2]).then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">//两个请求都有结果时会进行回调，本质就是promise.all</span></span><br><span class="line">  <span class="built_in">console</span>.log(res)</span><br><span class="line">&#125;)</span><br><span class="line">axios.all([request1, request2]).then(<span class="function">(<span class="params">[res1, res2]</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">//数组解构接收结果</span></span><br><span class="line">  <span class="built_in">console</span>.log(res1, res2)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="默认配置"><a href="#默认配置" class="headerlink" title="默认配置"></a>默认配置</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//index.js</span></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br><span class="line"></span><br><span class="line">axios.defaults.baseURL = <span class="string">&#x27;https://httpbin.org&#x27;</span> <span class="comment">//默认url</span></span><br><span class="line">axios.defaults.timeout = <span class="number">5000</span> <span class="comment">//请求过期时间</span></span><br><span class="line">axios.defaults.headers.common[<span class="string">&#x27;Authorization&#x27;</span>] = <span class="string">&#x27;fdasfd&#x27;</span> <span class="comment">//给每一个请求配置一个token</span></span><br><span class="line">axios.defaults.headers.post[<span class="string">&#x27;Content-Type&#x27;</span>] = <span class="string">&#x27;application/text&#x27;</span> <span class="comment">//给post请求配置Content-Type类型</span></span><br></pre></td></tr></table></figure><h4 id="创建新的实例"><a href="#创建新的实例" class="headerlink" title="创建新的实例"></a>创建新的实例</h4><p>请求的服务器地址，headers 等不一致时使用</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> instance1 = axios.create(&#123;</span><br><span class="line">  <span class="attr">baseUrl</span>: <span class="string">&#x27;http://httpbin.org&#x27;</span>,</span><br><span class="line">  <span class="attr">timeout</span>: <span class="number">5000</span>,</span><br><span class="line">  <span class="attr">headers</span>: &#123;&#125;,</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">const</span> instance2 = axios.create(&#123;</span><br><span class="line">  <span class="attr">baseUrl</span>: <span class="string">&#x27;https://www.baidu.com&#x27;</span>,</span><br><span class="line">  <span class="attr">timeout</span>: <span class="number">10000</span>,</span><br><span class="line">  <span class="attr">headers</span>: &#123;&#125;,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="axios-拦截器"><a href="#axios-拦截器" class="headerlink" title="axios 拦截器"></a>axios 拦截器</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">axios.interceptors.request.use(</span><br><span class="line">  <span class="function">(<span class="params">config</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">//添加请求拦截</span></span><br><span class="line">    <span class="comment">//发送网络请求时，在界面中间显示loading组件</span></span><br><span class="line">    <span class="comment">//某些请求要求用户必须携带token，如果没有携带则跳转到登录界面</span></span><br><span class="line">    <span class="comment">//params/data序列化操作</span></span><br><span class="line">    <span class="keyword">return</span> config</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;&#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">axios.interceptors.response.use(</span><br><span class="line">  <span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">//响应拦截</span></span><br><span class="line">    <span class="keyword">return</span> res.data</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (err &amp;&amp; err.response) &#123;</span><br><span class="line">      <span class="keyword">switch</span> (err.response.status) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">400</span>:</span><br><span class="line">          <span class="built_in">console</span>.log(<span class="string">&#x27;请求错误&#x27;</span>)</span><br><span class="line">          <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">401</span>:</span><br><span class="line">          <span class="built_in">console</span>.log(<span class="string">&#x27;未授权访问&#x27;</span>)</span><br><span class="line">          <span class="keyword">break</span></span><br><span class="line">        <span class="attr">default</span>:</span><br><span class="line">          <span class="built_in">console</span>.log(<span class="string">&#x27;其它错误信息&#x27;</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> err</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h4 id="二次封装"><a href="#二次封装" class="headerlink" title="二次封装"></a>二次封装</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//src -&gt; service -&gt; request.js, config.js</span></span><br><span class="line"><span class="comment">//config.js</span></span><br><span class="line"><span class="comment">//定义相关配置信息</span></span><br><span class="line"><span class="keyword">const</span> devBaseURL = <span class="string">&#x27;https://httpbin.org&#x27;</span> <span class="comment">//测试url</span></span><br><span class="line"><span class="keyword">const</span> proBaseURL = <span class="string">&#x27;https://production.org&#x27;</span> <span class="comment">//生产时的url</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> BASE_URL = process.env.NODE_ENV === <span class="string">&#x27;development&#x27;</span> ? devBaseURL : proBaseURL</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> TIMEOUT = <span class="number">5000</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//request.js</span></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; BASE_URL, TIMEOUT &#125; <span class="keyword">from</span> <span class="string">&#x27;./config&#x27;</span> <span class="comment">//导入配置相关信息</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> instance = axios.create(&#123;</span><br><span class="line">  <span class="attr">baseURL</span>: BASE_URL,</span><br><span class="line">  <span class="attr">timeout</span>: TIMEOUT,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">instance.interceptors.request.use(</span><br><span class="line">  <span class="function">(<span class="params">config</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">//请求拦截</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;请求被拦截&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> config</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;&#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">instance.interceptors.response.use(</span><br><span class="line">  <span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">//响应拦截</span></span><br><span class="line">    <span class="keyword">return</span> res.data</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> err</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> instance <span class="comment">//导出</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//在其他地方使用</span></span><br><span class="line"><span class="keyword">import</span> request <span class="keyword">from</span> <span class="string">&#x27;service/request&#x27;</span></span><br><span class="line">request(&#123;</span><br><span class="line">  <span class="attr">url</span>: <span class="string">&#x27;/get&#x27;</span>,</span><br><span class="line">  <span class="attr">params</span>: &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;why&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">18</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;).then(<span class="built_in">console</span>.log)</span><br><span class="line"><span class="comment">//或者</span></span><br><span class="line"><span class="keyword">return</span> request.post(<span class="string">&#x27;/login/admin&#x27;</span>, &#123;</span><br><span class="line">  <span class="comment">//管理员登录</span></span><br><span class="line">  <span class="attr">name</span>: uname,</span><br><span class="line">  <span class="attr">password</span>: pwd, <span class="comment">//发送数据</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="React-过渡动画"><a href="#React-过渡动画" class="headerlink" title="React 过渡动画"></a>React 过渡动画</h3><p>react-transition-group:</p><p>给一个组件的显示和消失添加过渡动画</p><p>官网：<span class="exturl" data-url="aHR0cHM6Ly9yZWFjdGNvbW11bml0eS5vcmcvcmVhY3QtdHJhbnNpdGlvbi1ncm91cC8=">https://reactcommunity.org/react-transition-group/<i class="fa fa-external-link-alt"></i></span></p><h4 id="安装-2"><a href="#安装-2" class="headerlink" title="安装"></a>安装</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install react-transition-group --save</span><br><span class="line">yarn add react-transition-group</span><br></pre></td></tr></table></figure><h4 id="包含四个组件"><a href="#包含四个组件" class="headerlink" title="包含四个组件"></a>包含四个组件</h4><ul><li><p>Transition</p><p>和平台无关的组件(不一定要结合 css)</p></li><li><p>CSSTrasition</p><p>完成过渡动画效果，执行过程中有三个状态：appear、enter、exit</p><p>appear：第一次加载组件时执行的动画，与 enter 一样即可</p><p>enter：组件进入时执行的动画</p><p>exit：组件退出时执行的动画</p><p>他们有三种状态，需要定义对应的 css 样式</p><ol><li><p>开始状态，对应的类：-appear、-enter、-exit</p></li><li><p>执行动画，对应的类：-appear-active、-enter-active、-exit-active</p></li><li><p>执行结束，对应的类：-appear-done、-enter-done、-exit-done</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">import &#x27;./transition/CSSTransition.css&#x27;</span><br><span class="line">import &#123; CSSTransition &#125; from &quot;react-transition-group&quot;; //导入</span><br><span class="line">//1.将要做动画的组件包裹到CSSTransition里面</span><br><span class="line">&lt;CSSTransition</span><br><span class="line">  in=&#123;isShow&#125;   &#123;/* in:根据后面的boolean决定被CSSTransition包裹的组件显示和隐藏*/&#125;</span><br><span class="line">  classNames=&quot;card&quot;  &#123;/*classNames:对应的class*/&#125;</span><br><span class="line">  timeout=&#123;300&#125;    &#123;/*timeout: 控制class、unmountOnExit等出现消失的时间,最好与css动画里面的时间一致*/&#125;</span><br><span class="line">  unmountOnExit=&#123;true&#125;  &#123;/*unmountOnExit:动画退出时卸载掉该元素，删除组件*/&#125;</span><br><span class="line">  appear  &#123;/*appear:第一次进入网页或刷新页面时也显示动画(需要在css里面写动画)*/&#125;</span><br><span class="line">  onEnter=&#123;el =&gt; console.log(&quot;开始进入&quot;)&#125;</span><br><span class="line">  onEntering=&#123;el =&gt; console.log(&quot;正在进入&quot;)&#125;</span><br><span class="line">  onEntered=&#123;el =&gt; console.log(&quot;进入完成&quot;)&#125;</span><br><span class="line">  onExit=&#123;el =&gt; console.log(&quot;开始退出&quot;)&#125;</span><br><span class="line">  onExiting=&#123;el =&gt; console.log(&quot;退出状态&quot;)&#125;</span><br><span class="line">  onExited=&#123;el =&gt; console.log(&quot;退出完成&quot;)&#125;</span><br><span class="line">  &gt;</span><br><span class="line">	&lt;h2&gt;哈哈哈哈&lt;/h2&gt;</span><br><span class="line">&lt;/CSSTransition&gt;</span><br><span class="line">//2.添加对应属性</span><br><span class="line"></span><br><span class="line">//3.新建css文件，给对应的类加动画,如:</span><br><span class="line">.card-enter &#123;</span><br><span class="line">  opacity: 0;</span><br><span class="line">  transform: scale(.6);</span><br><span class="line">&#125;</span><br><span class="line">.card-enter-active &#123;</span><br><span class="line">  opacity: 1;</span><br><span class="line">  transition:all .3s;</span><br><span class="line">  transform: scale(1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol></li><li><p>SwitchTransition</p><p>两个组件显示和隐藏切换时使用,主要有一个属性：mode，有两个值</p><ul><li><p>in-out:新组件先进入，旧组件再移除</p></li><li><p>out-in:旧组件先移除，新组件再进入</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import &#123; SwitchTransition, CSSTransition &#125; from &#x27;react-transition-group&#x27;</span><br><span class="line">import &#x27;./SwitchTransition.css&#x27;</span><br><span class="line">&lt;SwitchTransition mode=&quot;out-in&quot;&gt;</span><br><span class="line">  &lt;CSSTransition key=&#123;isOn ? &quot;on&quot; : &quot;off&quot;&#125; classNames=&quot;btn&quot; timeout=&#123;1000&#125;&gt;</span><br><span class="line">	&lt;button onClick=&#123;e =&gt; this.setState(&#123;isOn: !isOn&#125;)&#125;&gt;&#123;isOn ? &quot;on&quot; : &quot;off&quot;&#125;&lt;/button&gt;</span><br><span class="line">	&#123;/*SwitchTransition里面包裹CSSTransition,再新建css文件写对应的动画*/&#125;</span><br><span class="line">	&lt;/CSSTransition&gt;</span><br><span class="line">&lt; /SwitchTransition&gt;</span><br></pre></td></tr></table></figure></li></ul></li><li><p>TransitionGroup</p><p>将多个动画组件包裹在其中，一般用于列表中元素的动画</p><p>TransitionGroup 里面的组件都要用 CSSTransition 包裹起来，否则会报警告</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">import &#123;CSSTransition, TransitionGroup&#125; from &#x27;react-transition-group&#x27;</span><br><span class="line">import &#x27;./TransitionGroup.css&#x27;; //导入样式</span><br><span class="line">render() &#123;</span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">    	&lt;TransitionGroup&gt;</span><br><span class="line">      &#123;/*整个组件使用TransitionGroup包括*/&#125;</span><br><span class="line">      &#123;</span><br><span class="line">        this.state.names.map((item, index) =&gt; &#123;</span><br><span class="line">          return (</span><br><span class="line">            &lt;CSSTransition key=&#123;index&#125; timeout=&#123;500&#125; classNames=&quot;item&quot;&gt;</span><br><span class="line">              &lt;div&gt; &#123;item&#125; &lt;/div&gt;</span><br><span class="line">              &#123;/*具体出现动画的部分使用CSSTransition包裹，列表key属性必须加*/&#125;</span><br><span class="line">            &lt;/CSSTransition&gt;</span><br><span class="line">          )</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    	&lt;/TransitionGroup&gt;</span><br><span class="line">    	&lt;button onClick=&#123;e =&gt; this.addName()&#125;&gt;+name&lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line">&#123;/*放到TransitionGroup里面的所有元素最外层都需要包裹一个CSSTransition*/&#125;</span><br></pre></td></tr></table></figure></li></ul><h3 id="Redux"><a href="#Redux" class="headerlink" title="Redux"></a>Redux</h3><p>阮一峰：<span class="exturl" data-url="aHR0cDovL3d3dy5ydWFueWlmZW5nLmNvbS9ibG9nLzIwMTYvMDkvcmVkdXhfdHV0b3JpYWxfcGFydF9vbmVfYmFzaWNfdXNhZ2VzLmh0bWw=">http://www.ruanyifeng.com/blog/2016/09/redux_tutorial_part_one_basic_usages.html<i class="fa fa-external-link-alt"></i></span></p><p>官网：<span class="exturl" data-url="aHR0cHM6Ly9yZWR1eC5qcy5vcmcvdW5kZXJzdGFuZGluZy90aGlua2luZy1pbi1yZWR1eC9tb3RpdmF0aW9u">https://redux.js.org/understanding/thinking-in-redux/motivation<i class="fa fa-external-link-alt"></i></span></p><p>中文官网：<span class="exturl" data-url="aHR0cHM6Ly93d3cucmVkdXgub3JnLmNuLw==">https://www.redux.org.cn/<i class="fa fa-external-link-alt"></i></span></p><h4 id="JS-纯函数"><a href="#JS-纯函数" class="headerlink" title="JS 纯函数"></a>JS 纯函数</h4><p>纯函数：相同的输入产生相同的输出，函数在执行过程中，不能产生副作用(不能对传入的参数进行修改)</p><p>react 中要求无论是函数还是 class 声明一个组件，这个组件必须像纯函数一样，保护他们的 props 不被修改</p><p><strong>所有 React 组件必须像纯函数一样保护他们的 props 不被修改</strong></p><p><strong>Redux</strong>：js 的状态容器，提供了可预测的状态管理</p><h4 id="核心理念"><a href="#核心理念" class="headerlink" title="核心理念"></a>核心理念</h4><p>固定地方存储数据</p><p>Redux 要求通过派发 action 来更新数据</p><ul><li>所有数据的变化，必须通过派发(dispach)action 更新</li><li>action 是一个普通的 js<strong>对象</strong>，用来描述这次更新的 type 和 content</li></ul><p>reducer：将 state 和 action 联系在一起</p><ul><li>reducer 是一个<strong>纯函数</strong></li><li>reducer 做的事情就是将传入的 state 和 action 结合起来生成一个新的 state</li></ul><h4 id="三大原则"><a href="#三大原则" class="headerlink" title="三大原则"></a>三大原则</h4><ol><li><strong>单一数据源</strong><ol><li>整个应用程序的 state 被存储在一颗 object tree 中，并且这个对象树只存储在一个 store 中</li><li>Redux 并没有强制让我们不能创建多个 Store，但是那样做并不利于数据的维护</li><li>单一的数据源可以让整个应用程序的 state 变得方便维护、追踪、修改</li></ol></li><li><strong>State 是只读的</strong><ol><li>唯一修改 state 是触发 action，不要在其它地方通过任何方式修改 state</li><li>这样确保了 View 或网络请求都不能直接修改 state，它们只能通过 action 来描述自己想要如何修改 state</li><li>这样可以保证所有的修改都被集中化处理，并且按照严格的顺序来执行，所以不需要担心 race condition(竟态:多个地方同时操作数据源)的问题</li></ol></li><li><strong>使用纯函数来执行修改</strong><ol><li>通过 reducer 将旧 state 和 action 联系在一起，并且返回一个新的 State</li><li>随着应用程序的复杂度增加，可以将 reducer 拆分成多个小的 reducers，分别操作不同的 state tree 的一部分</li><li>但是所有的 reducer 都应该是纯函数，不能产生任何的副作用</li></ol></li></ol><h4 id="基本使用"><a href="#基本使用" class="headerlink" title="基本使用"></a>基本使用</h4><p><strong>独立使用</strong></p><p>新建文件 package.json</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn init -y</span><br></pre></td></tr></table></figure><p>安装 redux</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add redux</span><br></pre></td></tr></table></figure><p>使用过程</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.导入redux(此处不能通过es6方式)</span></span><br><span class="line"><span class="comment">//commonjs的一种实现 --&gt; nodejs</span></span><br><span class="line"><span class="keyword">const</span> redux = <span class="built_in">require</span>(<span class="string">&#x27;redux&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> initialState = &#123;</span><br><span class="line">  <span class="comment">//初始化数据</span></span><br><span class="line">  <span class="attr">counter</span>: <span class="number">0</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//reducer	纯函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">reducer</span>(<span class="params">state = initialState, action</span>) </span>&#123;</span><br><span class="line">  <span class="comment">//第一次的时候没有值，使用初始化数据当作默认值</span></span><br><span class="line">  <span class="keyword">switch</span> (action.type) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;INCREMENT&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123; ...state, <span class="attr">counter</span>: state.counter + action.num &#125; <span class="comment">//解构原来的数据，再把原来的数据进行覆盖</span></span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state <span class="comment">//如果没有匹配到，则默认返回原来的state</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//store(创建仓库的时候需要传入一个reducer) store.getState()获取store里面的状态</span></span><br><span class="line"><span class="keyword">const</span> store = redux.createStore(reducer)</span><br><span class="line"></span><br><span class="line"><span class="comment">//订阅store的修改(需要放在action前面)</span></span><br><span class="line">store.subscribe(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">//只要数据发生改变就会回调此函数</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;counter:&#x27;</span> + store.getState().counter)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//actions</span></span><br><span class="line"><span class="keyword">const</span> action1 = &#123; <span class="attr">type</span>: <span class="string">&#x27;INCREMENT&#x27;</span>, <span class="attr">num</span>: <span class="number">5</span> &#125;</span><br><span class="line"><span class="comment">//派发action会执行reducer函数，执行时传入前一个state</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//派发action，内部执行reducer函数</span></span><br><span class="line">store.dispatch(action1)</span><br></pre></td></tr></table></figure><p>node 对 es6 模块化的支持</p><p>node v13.2.0 之前：</p><ul><li><p>在 package.json 中添加属性：”type”:”module”;</p></li><li><p>在执行名字中添加如下选项:node –experimental-modules src/index.js</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;type&quot;</span>: <span class="string">&quot;module&quot;</span>,</span><br><span class="line"><span class="string">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">	<span class="string">&quot;start&quot;</span>: <span class="string">&quot;node --experimental-modules index.js&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><p>node v13.2.0 之后：</p><ul><li>在 package.json 中添加属性：”type”:”module”;</li></ul><p><strong>拆分使用</strong></p><ul><li>index.js //使用 store</li><li>store<ul><li>actionCreators.js //放 action</li><li>constants.js //放各种常量</li><li>index.js //导出 store</li><li>reducer.js //放 reducer 函数</li></ul></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//store</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//constants.js</span></span><br><span class="line"><span class="comment">//定义各种常量</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> ADD_NUMBER = <span class="string">&quot;ADD_NUMBER&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//actionCreators.js</span></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  ADD_NUMBER</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;./constants.js&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> addAction = <span class="function"><span class="params">num</span> =&gt;</span> (&#123;</span><br><span class="line">  <span class="attr">type</span>: ADD_NUMBER,</span><br><span class="line">  num</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//reducer.js</span></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  ADD_NUMBER</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;./constants.js&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> defaultState = &#123;</span><br><span class="line">  <span class="attr">counter</span>: <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">reducer</span>(<span class="params">state = defaultState, action</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">switch</span>(action.type) &#123;</span><br><span class="line">    <span class="keyword">case</span> ADD_NUMBER:</span><br><span class="line">      <span class="keyword">return</span> &#123;...state, <span class="attr">counter</span>: state.counter + action.num&#125;;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> reducer;</span><br><span class="line"></span><br><span class="line"><span class="comment">//index.js 独立使用</span></span><br><span class="line"><span class="comment">//import redux from &#x27;redux&#x27;;</span></span><br><span class="line"><span class="comment">//import reducer from &#x27;./reducer.js&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//const store = redux.createStore(reducer);</span></span><br><span class="line"><span class="comment">//export default store;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//与React结合使用</span></span><br><span class="line"><span class="keyword">import</span> &#123;createStore&#125; <span class="keyword">from</span> <span class="string">&#x27;redux&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> reducer <span class="keyword">from</span> <span class="string">&#x27;./reducer.js&#x27;</span></span><br><span class="line"><span class="keyword">const</span> store = createStore(reducer);</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store;</span><br><span class="line"></span><br><span class="line"><span class="comment">//外部index.js</span></span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;./store/index.js&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  addAction,</span><br><span class="line">  subAction</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;./store/actionCreators.js&#x27;</span></span><br><span class="line"></span><br><span class="line">store.subscribe(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(store.getState());</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">store.dispatch(addAction(<span class="number">10</span>));</span><br><span class="line">store.dispatch(addAction(<span class="number">15</span>));</span><br></pre></td></tr></table></figure><h4 id="与-React-项目结合使用"><a href="#与-React-项目结合使用" class="headerlink" title="与 React 项目结合使用"></a>与 React 项目结合使用</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; PureComponent &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;../store&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; addAction &#125; <span class="keyword">from</span> <span class="string">&#x27;../store/actionCreators&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">Home</span> <span class="keyword">extends</span> <span class="title">PureComponent</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">props</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>(props)</span><br><span class="line">    <span class="built_in">this</span>.state = &#123;</span><br><span class="line">      <span class="attr">counter</span>: store.getState().counter,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="title">componentDidMount</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="comment">//订阅</span></span><br><span class="line">    <span class="built_in">this</span>.unsubscribe = store.subscribe(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">this</span>.setState(&#123;</span><br><span class="line">        <span class="attr">counter</span>: store.getState().counter,</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="title">componentWillUnmount</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="comment">//取消订阅</span></span><br><span class="line">    <span class="built_in">this</span>.unsubscribe()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">render</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Home<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>当前计数:&#123;this.state.counter&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;(e)</span> =&gt;</span> this.increment(1)&#125;&gt;+1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;(e)</span> =&gt;</span> this.increment(5)&#125;&gt;+5<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="title">increment</span>(<span class="params">num</span>)</span> &#123;</span><br><span class="line">    store.dispatch(addAction(num))</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="初步封装：connect🔖"><a href="#初步封装：connect🔖" class="headerlink" title="初步封装：connect🔖"></a>初步封装：connect🔖</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; PureComponent &#125; from &#x27;react&#x27;</span><br><span class="line">import store from &#x27;../store&#x27;    //导入依赖的store</span><br><span class="line"></span><br><span class="line">//将redux与组件所需要的东西连接在一起</span><br><span class="line">export function connect(mapStateToProps, mapDispatchToProps) &#123;  //导出一个高阶函数</span><br><span class="line">  return function enhanceHOC(WrappedComponent) &#123;  //返回一个函数为高阶组件</span><br><span class="line">    return class extends PureComponent &#123;  //返回另外一个组件</span><br><span class="line">      constructor(props) &#123;</span><br><span class="line">        super(props);</span><br><span class="line"></span><br><span class="line">        this.state = &#123;  //返回的类组件依赖的状态刚好是map函数调用之后返回的对象里面所依赖的状态</span><br><span class="line">          storeState: mapStateToProps(store.getState())</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      componentDidMount() &#123;</span><br><span class="line">        this.unsubscribe  = store.subscribe(() =&gt; &#123; //订阅，数据发生改变时重新render,并将返回值赋值给this.unsubscribe</span><br><span class="line">          this.setState(&#123;</span><br><span class="line">            storeState: mapStateToProps(store.getState())</span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      componentWillUnmount() &#123;</span><br><span class="line">        this.unsubscribe();  //取消订阅</span><br><span class="line">      &#125;</span><br><span class="line">      render() &#123;</span><br><span class="line">        return &lt;WrappedComponent &#123;...this.props&#125;</span><br><span class="line">               //把自己的props传给调用connect的组件(WrappedComponent)</span><br><span class="line">          &#123;...mapStateToProps(store.getState())&#125;</span><br><span class="line">                 //把当前对象的所有属性传到WrappedComponent组件</span><br><span class="line">          &#123;...mapDispatchToProps(store.dispatch)&#125;</span><br><span class="line">                 //传回dispatch函数</span><br><span class="line">        /&gt;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>使用：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">import React from &#x27;react&#x27;</span><br><span class="line">import &#123;connect&#125; from &#x27;../utils/connect&#x27;  //导入connect函数</span><br><span class="line">import &#123;addAction&#125; from &#x27;../store/actionCreators&#x27;   //导入依赖的action</span><br><span class="line"></span><br><span class="line">function Home2(props) &#123;</span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;h1&gt;Home2&lt;/h1&gt;</span><br><span class="line">      &lt;h2&gt;当前计数:&#123;props.counter&#125;&lt;/h2&gt;</span><br><span class="line">      &lt;button onClick=&#123;e =&gt; props.increment(1)&#125;&gt;+1&lt;/button&gt;</span><br><span class="line">      &lt;button onClick=&#123;e =&gt; props.increment(5)&#125;&gt;+5&lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line">//connect(参数1, 参数2)(Home)</span><br><span class="line"></span><br><span class="line">const mapStateToProps = state =&gt; &#123;  //赋值为一个函数，把想要使用的state映射到props里面</span><br><span class="line">  return &#123;  //返回一个对象</span><br><span class="line">    counter: state.counter</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">//只返回一个对象。可以简写：</span><br><span class="line">const mapDispatchToProps = (dispatch) =&gt; (&#123;   //把要映射的dispatch映射到props里面</span><br><span class="line">  addNumber(num) &#123;   //在组件按钮里面调用了这个方法</span><br><span class="line">    dispatch(addAction(num));</span><br><span class="line">  &#125;,</span><br><span class="line">  addNumber2: function(num) &#123;   //在组件按钮里面调用了这个方法</span><br><span class="line">    dispatch(addAction(num));</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">export default connect(mapStateToProps, mapDispatchToProps)(Home2);</span><br><span class="line">//调用connect，传进两个参数，本身是一个函数，可传一个组件进去，处理后返回一个高阶组件</span><br><span class="line"></span><br><span class="line">//类组件</span><br><span class="line">class Home extends PureComponent &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;h1&gt;Home3&lt;/h1&gt;</span><br><span class="line">        &lt;h2&gt;当前计数: &#123;this.props.counter&#125;&lt;/h2&gt;</span><br><span class="line">        &lt;button onClick=&#123;(e) =&gt; this.props.addNumber(5)&#125;&gt;+5&lt;/button&gt;</span><br><span class="line">        &lt;button onClick=&#123;(e) =&gt; this.props.addNumber(10)&#125;&gt;+10&lt;/button&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="使用-context-二次封装"><a href="#使用-context-二次封装" class="headerlink" title="使用 context 二次封装"></a>使用 context 二次封装</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; PureComponent &#125; from &#x27;react&#x27;</span><br><span class="line">// import store from &#x27;../store&#x27;    //导入依赖的store</span><br><span class="line">import &#123;storeContext&#125; from &#x27;./context&#x27;  //导入context</span><br><span class="line"></span><br><span class="line">//将redux与组件所需要的东西连接在一起</span><br><span class="line">export function connect(mapStateToProps, mapDispatchToProps) &#123;  //返回一个高阶函数</span><br><span class="line">  return function enhanceHOC(WrappedComponent) &#123;  //返回一个函数为高阶组件</span><br><span class="line">    class EnhanceComponent extends PureComponent &#123;  //给返回的组件取名为EnhanceComponent</span><br><span class="line">      constructor(props, context) &#123; //传过来一个context</span><br><span class="line">        super(props, context);</span><br><span class="line"></span><br><span class="line">        this.state = &#123;  //返回的类组件依赖的状态刚好是map函数调用之后返回的对象里面所依赖的状态</span><br><span class="line">          storeState: mapStateToProps(context.getState())</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      componentDidMount() &#123;</span><br><span class="line">        this.unsubscribe  = this.context.subscribe(() =&gt; &#123; //订阅，数据发生改变时重新render,并将返回值赋值给this.unsubscribe</span><br><span class="line">          this.setState(&#123;</span><br><span class="line">            storeState: mapStateToProps(this.context.getState())</span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      componentWillUnmount() &#123;</span><br><span class="line">        this.unsubscribe();  //取消订阅</span><br><span class="line">      &#125;</span><br><span class="line">      render() &#123;</span><br><span class="line">        return &lt;WrappedComponent &#123;...this.props&#125;</span><br><span class="line">                 //把自己的props传给调用connect的组件(WrappedComponent)</span><br><span class="line">          &#123;...mapStateToProps(this.context.getState())&#125;</span><br><span class="line">                 //把当前对象的所有属性传到WrappedComponent组件</span><br><span class="line">          &#123;...mapDispatchToProps(this.context.dispatch)&#125;</span><br><span class="line">                 //传回dispatch函数</span><br><span class="line">        /&gt;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    EnhanceComponent.contextType = storeContext;</span><br><span class="line">    //通过此方式可以在其它地方使用this.context拿到共享的value</span><br><span class="line">    return EnhanceComponent;  //返回组件</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//contxt.js</span><br><span class="line">import React from &#x27;react&#x27;;</span><br><span class="line">const storeContext = React.createContext();</span><br><span class="line">export &#123; storeContext &#125;</span><br><span class="line"></span><br><span class="line">//index.js</span><br><span class="line">import React from &#x27;react&#x27;;</span><br><span class="line">import ReactDOM from &#x27;react-dom&#x27;;</span><br><span class="line">import App from &#x27;./App&#x27;;</span><br><span class="line"></span><br><span class="line">import store from &#x27;./store&#x27;</span><br><span class="line">import &#123; StoreContext &#125; from &#x27;./utils/context&#x27;</span><br><span class="line"></span><br><span class="line">ReactDOM.render(</span><br><span class="line">  &lt;StoreContext.provider value=&#123;store&#125;&gt; &#123;/*通过context把store进行共享 */&#125;</span><br><span class="line">    &lt;App /&gt;</span><br><span class="line">  &lt;/StoreContext.provider&gt;,</span><br><span class="line">  document.getElementById(&#x27;root&#x27;)</span><br><span class="line">);</span><br><span class="line">//其它地方使用方式不变</span><br></pre></td></tr></table></figure><h4 id="react-redux"><a href="#react-redux" class="headerlink" title="react-redux"></a>react-redux</h4><p><span class="exturl" data-url="aHR0cHM6Ly9yZWR1eC5qcy5vcmcvYmFzaWNzL3VzYWdlLXdpdGgtcmVhY3Q=">https://redux.js.org/basics/usage-with-react<i class="fa fa-external-link-alt"></i></span></p><p>把组件和 redux 结合起来(connect、provider 共享 store)</p><p>安装：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install react-redux</span><br><span class="line">yarn add react-redux</span><br></pre></td></tr></table></figure><p>使用：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">import React from &#x27;react&#x27;;</span><br><span class="line">import ReactDOM from &#x27;react-dom&#x27;;</span><br><span class="line">import App from &#x27;./App&#x27;;</span><br><span class="line"></span><br><span class="line">import store from &#x27;./store&#x27;</span><br><span class="line">import &#123;Provider&#125; from &#x27;react-redux&#x27;</span><br><span class="line"></span><br><span class="line">ReactDOM.render(</span><br><span class="line">  &lt;Provider store=&#123;store&#125;&gt;  &#123;/*使用Provider，共享(传入)一个store */&#125;</span><br><span class="line">    &lt;App /&gt;</span><br><span class="line">  &lt;/Provider&gt;,</span><br><span class="line">  document.getElementById(&#x27;root&#x27;)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">//在组件中使用</span><br><span class="line">import React, &#123; PureComponent &#125; from &quot;react&quot;;</span><br><span class="line"></span><br><span class="line">import &#123; addAction &#125; from &quot;../store/actionCreators&quot;;</span><br><span class="line">import &#123;connect&#125; from &#x27;react-redux&#x27; //导入react-redux的connect函数</span><br><span class="line"></span><br><span class="line">class Home2 extends PureComponent &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;h1&gt;HomeProvider&lt;/h1&gt;</span><br><span class="line">        &lt;h2&gt;当前计数:&#123;this.props.counter&#125;&lt;/h2&gt;</span><br><span class="line">        &lt;button onClick=&#123;e =&gt; this.props.increment(1)&#125;&gt;+1&lt;/button&gt;</span><br><span class="line">        &lt;button onClick=&#123;e =&gt; this.props.increment(5)&#125;&gt;+5&lt;/button&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">//connect(参数1, 参数2)(Home)</span><br><span class="line"></span><br><span class="line">const mapStateToProps = state =&gt; &#123;  //赋值为一个函数，把想要使用的state映射到props里面</span><br><span class="line">  return &#123;  //返回一个对象</span><br><span class="line">    counter: state.counter</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">const mapDispatchToProps = dispatch =&gt; &#123;  //把要映射的dispatch映射到props里面</span><br><span class="line">  return &#123; //返回一个对象</span><br><span class="line">    increment: function(num) &#123;  //在组件按钮里面调用了这个方法</span><br><span class="line">      dispatch(addAction(num));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">export default connect(mapStateToProps, mapDispatchToProps)(Home2);</span><br><span class="line">//调用connect，传进两个参数，本身是一个函数，可传一个组件进去，处理后返回一个高阶组件</span><br></pre></td></tr></table></figure><h4 id="组件中异步操作-redux-thunk"><a href="#组件中异步操作-redux-thunk" class="headerlink" title="组件中异步操作 redux-thunk"></a>组件中异步操作 redux-thunk</h4><p>网络测试接口</p><p><span class="exturl" data-url="aHR0cDovLzEyMy4yMDcuMzIuMzI6ODAwMC9ob21lL211bHRpZGF0YQ==">http://123.207.32.32:8000/home/multidata<i class="fa fa-external-link-alt"></i></span></p><p>网络请求流程(以前)：</p><p>组件 Component-&gt;componentDidMount-&gt;dispatch actions-&gt;reducer 处理-&gt;改变 store 的 state</p><p><strong>redux 中间件:redux-thunk</strong></p><p>在 redux 中进行异步操作，在 dispatch 的 action 和最终到达的 reducer 之间，扩展一些自己的代码</p><p>安装：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add redux-thunk</span><br></pre></td></tr></table></figure><p>使用：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">//store -&gt; index.js</span><br><span class="line">import &#123;createStore, applyMiddleware&#125; from &#x27;redux&#x27;; //导入应用中间件</span><br><span class="line">import thunkMiddleware from &#x27;redux-thunk&#x27;;  //引入中间件</span><br><span class="line"></span><br><span class="line">import reducer from &#x27;./reducer.js&#x27;</span><br><span class="line"></span><br><span class="line">//应用中间件</span><br><span class="line">// applyMiddleware(中间件1, 中间件2, …………) 可传入多个中间件</span><br><span class="line">//引入thunkMiddleware中间件</span><br><span class="line">const storeEnhancer =  applyMiddleware(thunkMiddleware);  //把返回值赋值</span><br><span class="line"></span><br><span class="line">const store = createStore(reducer, storeEnhancer);</span><br><span class="line"></span><br><span class="line">export default store;</span><br><span class="line"></span><br><span class="line">//actionCreators.js</span><br><span class="line">import axios from &#x27;axios&#x27;</span><br><span class="line"></span><br><span class="line">import &#123;</span><br><span class="line">  CHANGE_BANNERS</span><br><span class="line">&#125; from &#x27;./constants.js&#x27;</span><br><span class="line"></span><br><span class="line">export const changeBannerAction = (banners) =&gt; (&#123;</span><br><span class="line">  type:CHANGE_BANNERS,</span><br><span class="line">  banners</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">//redux-thunk中定义的action函数</span><br><span class="line">export const getHomeMultidata = (dispatch, getState) =&gt; &#123; //被主动调用时会传过来一个参数</span><br><span class="line">  //在此进行网络请求</span><br><span class="line">  axios(&#123;</span><br><span class="line">      url: &#x27;http://123.207.32.32:8000/home/multidata&#x27;</span><br><span class="line">    &#125;).then(res =&gt; &#123;</span><br><span class="line">      const data = res.data.data;</span><br><span class="line">      dispatch(changeBannerAction(data.banner.list)); //派发上面的action</span><br><span class="line">    &#125;);</span><br><span class="line">    //如果此次网络请求需要依赖原来redux里面的某个数据，可在此通过getState拿到store里面的state，获取里面相关数据</span><br><span class="line">  console.log(&quot;action函数中&quot;, dispatch);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//reducer.js</span><br><span class="line">//不变</span><br><span class="line"></span><br><span class="line">//组件中：</span><br><span class="line">import React, &#123; PureComponent &#125; from &quot;react&quot;;</span><br><span class="line">import &#123; getHomeMultidata &#125; from &quot;../store/actionCreators&quot;;</span><br><span class="line">import &#123; connect &#125; from &quot;react-redux&quot;; //导入react-redux的connect函数</span><br><span class="line">class Home2 extends PureComponent &#123;</span><br><span class="line">  componentDidMount() &#123;</span><br><span class="line">    this.props.getHomeMultidata();</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;h1&gt;Banners&lt;/h1&gt;</span><br><span class="line">        &lt;ul&gt;</span><br><span class="line">          &#123;this.props.banners.map((item, index) =&gt; &#123;</span><br><span class="line">            return &lt;li key=&#123;item.acm&#125;&gt;&#123;item.title&#125;&lt;/li&gt;;</span><br><span class="line">          &#125;)&#125;</span><br><span class="line">        &lt;/ul&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const mapStateToProps = (state) =&gt; &#123;</span><br><span class="line">  //赋值为一个函数，把想要使用的state映射到props里面</span><br><span class="line">  return &#123;</span><br><span class="line">    //返回一个对象</span><br><span class="line">    banners: state.banners</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line">const mapDispatchToProps = (dispatch) =&gt; &#123;</span><br><span class="line">  //把要映射的dispatch映射到props里面</span><br><span class="line">  return &#123;</span><br><span class="line">    getHomeMultidata() &#123;</span><br><span class="line">      dispatch(getHomeMultidata); //传入一个函数,传入的函数之后会被主动调用</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">export default connect(mapStateToProps, mapDispatchToProps)(Home2);</span><br></pre></td></tr></table></figure><h4 id="redux-devtools"><a href="#redux-devtools" class="headerlink" title="redux-devtools"></a>redux-devtools</h4><p>浏览器插件</p><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3phbG1veGlzdXMvcmVkdXgtZGV2dG9vbHMtZXh0ZW5zaW9uI3VzYWdl">https://github.com/zalmoxisus/redux-devtools-extension#usage<i class="fa fa-external-link-alt"></i></span></p><p>在 redux 中集成 devtools 的中间件：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">//store -&gt; index.js</span><br><span class="line">import &#123;createStore, applyMiddleware, compose&#125; from &#x27;redux&#x27;; //导入应用中间件</span><br><span class="line">import thunkMiddleware from &#x27;redux-thunk&#x27;;  //引入中间件</span><br><span class="line"></span><br><span class="line">import reducer from &#x27;./reducer.js&#x27;</span><br><span class="line"></span><br><span class="line">//获取composeEnhancers函数</span><br><span class="line">const composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__(&#123;trace: true&#125;)  || compose; //trace: true 跟踪，显示代码在哪里变化的</span><br><span class="line"></span><br><span class="line">//应用中间件</span><br><span class="line">// applyMiddleware(中间件1, 中间件2, …………) 可传入多个中间件</span><br><span class="line">const storeEnhancer =  applyMiddleware(thunkMiddleware);  //把返回值赋值</span><br><span class="line"></span><br><span class="line">const store = createStore(reducer, composeEnhancers(storeEnhancer));//合并</span><br><span class="line"></span><br><span class="line">export default store;</span><br></pre></td></tr></table></figure><p>trace:跟踪代码在哪里变化</p><h4 id="补充：ES6-中-generator-的使用"><a href="#补充：ES6-中-generator-的使用" class="headerlink" title="补充：ES6 中 generator 的使用"></a>补充：ES6 中 generator 的使用</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//generator:生成器</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//定义生成器函数：</span></span><br><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">yield</span> <span class="string">&#x27;Hello&#x27;</span> <span class="comment">//通过yield返回一个东西</span></span><br><span class="line">  <span class="keyword">yield</span> <span class="string">&#x27;World&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//生成器函数会返回一个iterator(迭代器)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> it = foo() <span class="comment">//拿到迭代器</span></span><br><span class="line"><span class="comment">//调用一次next，就会消耗一次迭代器</span></span><br><span class="line"><span class="keyword">const</span> res1 = it.next() <span class="comment">//使用迭代器，拿到生成里面返回的第一个东西</span></span><br><span class="line"><span class="comment">//res1 = &#123;value: &quot;Hello&quot;, done: false&#125;	done：迭代器里面返回的数据已经用完？</span></span><br><span class="line"><span class="comment">//第一次调用next，迭代器代码执行到第一个yield就会停止，后面代码不执行，后面以此类推</span></span><br><span class="line"><span class="comment">//调用一次迭代器，返回一个yield</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//generator和promise一起使用</span></span><br><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">bar</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;1111&#x27;</span>)</span><br><span class="line">  <span class="keyword">const</span> result = <span class="keyword">yield</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">//模拟网络请求</span></span><br><span class="line">      resolve(<span class="string">&#x27;Hello Generator&#x27;</span>)</span><br><span class="line">    &#125;, <span class="number">3000</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="built_in">console</span>.log(result) <span class="comment">//此处无法拿到网络请求的结果</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> it = bar()</span><br><span class="line">it.next().value.then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">//第一次调用yield拿到的是promise</span></span><br><span class="line">  it.next(res) <span class="comment">//把第一次yield的结果传进去，赋值给result</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="redux-saga"><a href="#redux-saga" class="headerlink" title="redux-saga"></a>redux-saga</h4><p>安装：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add redux-saga</span><br></pre></td></tr></table></figure><p>使用(大型项目复杂的异步 action 常用)：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">//store -&gt; index.js</span><br><span class="line">import &#123;createStore, applyMiddleware, compose&#125; from &#x27;redux&#x27;; //导入应用中间件</span><br><span class="line">import thunkMiddleware from &#x27;redux-thunk&#x27;;  //引入thunk中间件</span><br><span class="line">import createSagaMiddleware from &#x27;redux-saga&#x27; //1.导入函数</span><br><span class="line">import reducer from &#x27;./reducer.js&#x27;</span><br><span class="line">import saga from &#x27;./saga&#x27;;  //2.导入生成器函数</span><br><span class="line"></span><br><span class="line">const composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__(&#123;trace: true&#125;) || compose;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">const sagaMiddleware = createSagaMiddleware(); //3.创建sagaMiddleware中间件</span><br><span class="line">const storeEnhancer =  applyMiddleware(thunkMiddleware, sagaMiddleware);	//4.应用中间件</span><br><span class="line">const store = createStore(reducer, composeEnhancers(storeEnhancer));</span><br><span class="line"></span><br><span class="line">sagaMiddleware.run(saga); //5.传入导入的saga生成器函数，使sagaMiddleware生效</span><br><span class="line"></span><br><span class="line">export default store;</span><br><span class="line"></span><br><span class="line">//actionCreators.js</span><br><span class="line">import axios from &#x27;axios&#x27;</span><br><span class="line">import &#123;</span><br><span class="line">  FETCH_HOME</span><br><span class="line">&#125; from &#x27;./constants.js&#x27;</span><br><span class="line"></span><br><span class="line">//redux-saga拦截的action</span><br><span class="line">export const fetchHomeMultidataAction = &#123;	//组件中也是派发的此action</span><br><span class="line">  type:FETCH_HOME</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//store -&gt; saga.js</span><br><span class="line">import &#123;takeEvery, put, all&#125; from &#x27;redux-saga/effects&#x27;</span><br><span class="line">import axios from &#x27;axios&#x27;</span><br><span class="line">import &#123; FETCH_HOME &#125; from &#x27;./constants&#x27;;  //导入要拦截的action</span><br><span class="line"></span><br><span class="line">import &#123; changeBannerAction &#125; from &#x27;./actionCreators&#x27;; //导入网络请求获取到数据后要派发的action</span><br><span class="line"></span><br><span class="line">function* fetchHomeMultidata(action) &#123;</span><br><span class="line">  //生成器函数,会将默认下的action传进来，action参数可省略</span><br><span class="line">  const res = yield axios.get(&quot;http://123.207.32.32:8000/home/multidata&quot;);  //网络请求,saga会将请求的结果返回</span><br><span class="line">  const banners = res.data.data.banner.list;</span><br><span class="line">  //有多个数据需要返回时，写多个yield</span><br><span class="line">  yield put(changeBannerAction(banners));	//把数据放进需要的action</span><br><span class="line">  yield put(changeBannerAction(banners));</span><br><span class="line">  //或者使用all方法</span><br><span class="line">  // yield all([</span><br><span class="line">  //   yield put(changeBannerAction(banners)),</span><br><span class="line">  //   yield put(changeBannerAction(banners))</span><br><span class="line">  // ])</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function* mySaga() &#123; //生成器函数</span><br><span class="line">  //takeLatest:一次只能监听一个对应的action，总是执行最后一个(如一个action发送多次，只会执行最后一次)</span><br><span class="line">  //takeEvery：每个都会被执行</span><br><span class="line">  //参数1：要拦截的action对应的type， 参数2：生成器函数，拦截type后执行</span><br><span class="line">  yield takeEvery(FETCH_HOME, fetchHomeMultidata);</span><br><span class="line">  //监听多个action</span><br><span class="line">  // yield all([</span><br><span class="line">  //   yield takeEvery(FETCH_HOME, fetchHomeMultidata),</span><br><span class="line">  //   yield takeEvery(FETCH_HOME, fetchHomeMultidata)</span><br><span class="line">  // ])</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default mySaga;	//导出生成器函数</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="reducer-拆分"><a href="#reducer-拆分" class="headerlink" title="reducer 拆分"></a>reducer 拆分</h4><p>目录结构：</p><ul><li>store<ul><li>counter //每个文件夹放自己的 store，文件夹不一定放在 store 下面<ul><li>actionCreators.js</li><li>constants.js</li><li>index.js</li><li>reducer.js</li></ul></li><li>……</li></ul></li><li>index.js //应用中间件</li><li>reducer.js //将多个 reducer 进行合并</li><li>saga.js</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">//home -&gt; reducer.js</span><br><span class="line">import &#123; CHANGE_BANNERS &#125; from &#x27;./constants.js&#x27;;</span><br><span class="line">// 拆分homeReducer</span><br><span class="line">const initialHomeState = &#123;</span><br><span class="line">  banners: []</span><br><span class="line">&#125;</span><br><span class="line">function homeReducer(state = initialHomeState, action) &#123;</span><br><span class="line">  switch (action.type) &#123;</span><br><span class="line">    case CHANGE_BANNERS:</span><br><span class="line">      return &#123; ...state, banners: action.banners &#125;;</span><br><span class="line">    default:</span><br><span class="line">      return state;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">export default homeReducer;</span><br><span class="line"></span><br><span class="line">//home -&gt; index.js</span><br><span class="line">import reducer from &#x27;./reducer&#x27;;</span><br><span class="line">export &#123;</span><br><span class="line">  reducer</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//store -&gt; reducer.js</span><br><span class="line">import &#123; reducer as counterReducer &#125; from &#x27;./counter&#x27;;</span><br><span class="line">import &#123; reducer as homeReducer &#125; from &#x27;./home&#x27;;</span><br><span class="line"></span><br><span class="line">import &#123; combineReducers &#125; from &#x27;redux&#x27;;  //合并多个reducer</span><br><span class="line"></span><br><span class="line">// function reducer(state = &#123;&#125;, action) &#123;</span><br><span class="line">//   return &#123;</span><br><span class="line">//     counterInfo: counterReducer(state.counterInfo, action),</span><br><span class="line">//     homeInfo: homeReducer(state.homeInfo, action)</span><br><span class="line">//   &#125;</span><br><span class="line">// &#125;</span><br><span class="line"></span><br><span class="line">//reducer应该是一个什么类型? function</span><br><span class="line">const reducer = combineReducers(&#123;</span><br><span class="line">  counterInfo: counterReducer,</span><br><span class="line">  homeInfo: homeReducer</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">export default reducer;</span><br></pre></td></tr></table></figure><h4 id="React-中-state-管理"><a href="#React-中-state-管理" class="headerlink" title="React 中 state 管理"></a>React 中 state 管理</h4><ol><li>UI 相关的组件内部可以维护的状态，在组件内部自己来维护</li><li>大部分需要共享的状态(父子组件传递不需要 redux 管理)，都交给 redux 来管理和维护</li><li>从服务器请求的数据(包括请求的操作)，交给 redux 来维护</li></ol><h4 id="单向数据流"><a href="#单向数据流" class="headerlink" title="单向数据流"></a>单向数据流</h4><ul><li>通过 props 进行数据流的传递</li><li>Vue 和 React 中组件内部都有单项数据流的概念</li><li>Redux 中</li></ul><h4 id="ImmutableJS"><a href="#ImmutableJS" class="headerlink" title="ImmutableJS"></a>ImmutableJS</h4><p>解决数据可变性引起的问题</p><p>特点：只要修改了对象，就会返回一个新的对象(新的对象会进行结构共享以节约性能)，旧的对象不会发生改变</p><p>安装：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add immutable</span><br></pre></td></tr></table></figure><p>使用：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//map使用</span></span><br><span class="line"><span class="keyword">const</span> im = Immutable <span class="comment">//immutable赋值给im</span></span><br><span class="line"><span class="keyword">const</span> info = &#123; <span class="attr">name</span>: <span class="string">&#x27;kobe&#x27;</span>, <span class="attr">friend</span>: &#123; <span class="attr">name</span>: <span class="string">&#x27;James&#x27;</span>, <span class="attr">age</span>: <span class="number">25</span> &#125; &#125;</span><br><span class="line"><span class="keyword">const</span> infoIM = im.Map(info) <span class="comment">//对象转成Immutable对象，只会进行浅层转化</span></span><br><span class="line"><span class="comment">//Map,映射，对对象做转化时使用</span></span><br><span class="line"><span class="keyword">const</span> obj = infoIM</span><br><span class="line"><span class="keyword">const</span> infoIM2 = infoIM.set(<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;why&#x27;</span>)</span><br><span class="line"><span class="comment">//修改name为why(实质是生成新的对象，并且会尽可能复用原来info里面的一些东西)</span></span><br><span class="line"><span class="built_in">console</span>.log(obj.get(<span class="string">&#x27;name&#x27;</span>)) <span class="comment">//kobe</span></span><br><span class="line"><span class="built_in">console</span>.log(infoIM2.get(<span class="string">&#x27;name&#x27;</span>)) <span class="comment">//why</span></span><br><span class="line"><span class="comment">//List使用，把数组转化成Immutable对象</span></span><br><span class="line"><span class="keyword">const</span> names = [<span class="string">&#x27;aaa&#x27;</span>, <span class="string">&#x27;bbb&#x27;</span>]</span><br><span class="line"><span class="keyword">const</span> namesIM = im.List(names)</span><br><span class="line"><span class="keyword">const</span> arrIM = namesIM.set(<span class="number">0</span>, <span class="string">&#x27;why&#x27;</span>)</span><br><span class="line"><span class="built_in">console</span>.log(namesIM.get(<span class="number">0</span>)) <span class="comment">//aaa</span></span><br><span class="line"><span class="built_in">console</span>.log(arrIM.get(<span class="number">0</span>)) <span class="comment">//why</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> infoIM = im.fromJS(info) <span class="comment">//只会进行深层转化，对象里面的对象也会被转化成Immutable对象</span></span><br></pre></td></tr></table></figure><h4 id="与-hooks-结合"><a href="#与-hooks-结合" class="headerlink" title="与 hooks 结合"></a>与 hooks 结合</h4><p>网络模块：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">//network -&gt; remove.js 此处集中存放remove模块的所有网络请求</span><br><span class="line">import request from &#x27;./request&#x27;;</span><br><span class="line">export function getTopBanners() &#123;</span><br><span class="line">  return request(&#123;</span><br><span class="line">    url:&#x27;/banner&#x27;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>模块自己的 store:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">//store -&gt; constants.js</span><br><span class="line">export const CHANGE_TOP_BANNERS = &quot;remove/CHANGE_TOP_BANNERS&quot;;</span><br><span class="line"></span><br><span class="line">//store -&gt; actions.js</span><br><span class="line">import * as actionTypes from &#x27;./constants&#x27;;</span><br><span class="line">import &#123; getTopBanners &#125; from &#x27;@/network/remove&#x27;; //导入网络模块请求数据的函数</span><br><span class="line">const changeTopBannerAction = (res) =&gt; (&#123;</span><br><span class="line">  type: actionTypes.CHANGE_TOP_BANNERS,</span><br><span class="line">  topBanners: res.banners</span><br><span class="line">&#125;);</span><br><span class="line">export const getTopBannerAction = () =&gt; &#123;</span><br><span class="line">  return dispatch =&gt; &#123;</span><br><span class="line">    getTopBanners().then(res =&gt; &#123;</span><br><span class="line">      console.log(res);</span><br><span class="line">      dispatch(changeTopBannerAction(res));</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//store -&gt; index.js</span><br><span class="line">import reducer from &#x27;./reducer&#x27;;</span><br><span class="line">export &#123; reducer &#125;</span><br><span class="line"></span><br><span class="line">//store -&gt; reducer.js</span><br><span class="line">import * as actionTypes from &#x27;./constants&#x27;;</span><br><span class="line"></span><br><span class="line">const defaultState = &#123;</span><br><span class="line">  topBanners: []</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function reducer(state = defaultState, action) &#123;</span><br><span class="line">  switch(action.type) &#123;</span><br><span class="line">    case actionTypes.CHANGE_TOP_BANNERS:</span><br><span class="line">      return &#123;...state, topBanners: action.topBanners &#125;;</span><br><span class="line">    default:</span><br><span class="line">      return state;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default reducer;</span><br></pre></td></tr></table></figure><p>合并的 store：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">//src -&gt; store -&gt; reducer.js</span><br><span class="line">import &#123; combineReducers &#125; from &#x27;redux&#x27;;</span><br><span class="line">import &#123;reducer as removeReducer&#125; from &#x27;../pages/admin/c-pages/remove/store&#x27;;//导入单独模块的reducer</span><br><span class="line">const reducers = combineReducers(&#123; //合并每一个模块的reducers</span><br><span class="line">  remove: removeReducer</span><br><span class="line">&#125;);</span><br><span class="line">export default reducers;</span><br><span class="line"></span><br><span class="line">//src -&gt; store -&gt; index.js</span><br><span class="line">import &#123; applyMiddleware, createStore, compose &#125; from &#x27;redux&#x27;;</span><br><span class="line">import thunk from &#x27;redux-thunk&#x27;;</span><br><span class="line"></span><br><span class="line">import reducer from &#x27;./reducer&#x27;; //导入合并的reducer</span><br><span class="line"></span><br><span class="line">const composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__  || compose;</span><br><span class="line"></span><br><span class="line">const store = createStore(reducer, composeEnhancers(applyMiddleware(thunk)));</span><br><span class="line"></span><br><span class="line">export default store;</span><br></pre></td></tr></table></figure><p>使用：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">//App.js共享</span><br><span class="line">import &#123; Provider &#125; from &quot;react-redux&quot;;</span><br><span class="line">import store from &quot;./store&quot;;</span><br><span class="line">return (</span><br><span class="line">    &lt;Provider store=&#123;store&#125;&gt;  &#123;/*使用Provider共享store */&#125;</span><br><span class="line">    &lt;/Provider&gt;</span><br><span class="line"> );</span><br><span class="line"></span><br><span class="line">//在组件里使用(remove -&gt; index.js)</span><br><span class="line">import React, &#123; memo, useEffect &#125; from &#x27;react&#x27;</span><br><span class="line">import &#123; shallowEqual, useDispatch, useSelector &#125; from &#x27;react-redux&#x27;</span><br><span class="line">import &#123; getTopBannerAction &#125; from &#x27;./store/actions&#x27;; //导入要派发的action</span><br><span class="line"></span><br><span class="line">export default memo(function Remove() &#123;</span><br><span class="line">  //组件和redux关联，获取数据和进行操作</span><br><span class="line">  const &#123; topBanners &#125; = useSelector(state =&gt; (&#123;</span><br><span class="line">    topBanners: state.remove.topBanners</span><br><span class="line">  &#125;), shallowEqual); // 浅层比较</span><br><span class="line">  const dispatch = useDispatch(); //通过hooks拿到dispatch对象</span><br><span class="line"></span><br><span class="line">  //发送网络请求</span><br><span class="line">  useEffect(() =&gt; &#123;</span><br><span class="line">    dispatch(getTopBannerAction()); //派发action</span><br><span class="line">  &#125;, [dispatch]);</span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      删除</span><br><span class="line">      &#123;topBanners.length&#125;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="ImmutableJS-优化性能"><a href="#ImmutableJS-优化性能" class="headerlink" title="ImmutableJS 优化性能"></a>ImmutableJS 优化性能</h4><p>在模块自己的 reducer 中使用</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">import &#123; Map &#125; from &#x27;immutable&#x27;;	//浅层转化,深层转化用fromJS</span><br><span class="line">const defaultState = Map(&#123;	//使用Immutable包裹数据,使其转化为immutable对象</span><br><span class="line">  currentSong: &#123;&#125;</span><br><span class="line">&#125;);</span><br><span class="line">function reducer(state = defaultState, action) &#123;</span><br><span class="line">  switch (action.type) &#123;</span><br><span class="line">    case actionTypes.CHANGE_CURRENT_SONG:</span><br><span class="line">      return state.set(&quot;currentSong&quot;, action.currentSong); //修改数据</span><br><span class="line">    default:</span><br><span class="line">      return state;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default reducer;</span><br><span class="line"></span><br><span class="line">//在其他地方取数据</span><br><span class="line">const &#123; curSong &#125; = useSelector(state =&gt; (&#123;</span><br><span class="line">  curSong: state.getIn([&quot;recommend&quot;, &quot;currentSong&quot;]);//先取第一层recommend,再取第二层currentSong</span><br><span class="line">  curSong: state.get(&quot;recommend&quot;).get(&quot;currentSong&quot;); //另一种取数据方式</span><br><span class="line">&#125;), shallowEqual);</span><br></pre></td></tr></table></figure><p>安装 redux-immutable：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yarn add immutable 		#先安装immutable</span><br><span class="line">yarn add redux-immutable</span><br></pre></td></tr></table></figure><p>合并 reducer 写法：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">//在合并reducer的reducer.js中</span><br><span class="line">//需要安装redux-immutable</span><br><span class="line">import &#123; combineReducers &#125; from &#x27;redux-immutable&#x27;;</span><br><span class="line"></span><br><span class="line">import &#123; reducer as recommendReducer &#125; from &#x27;pages/discover/c-pages/recommend/store&#x27;;</span><br><span class="line"></span><br><span class="line">const cReducer = combineReducers(&#123;</span><br><span class="line">  recommend: recommendReducer</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">export default cReducer;</span><br></pre></td></tr></table></figure><h4 id="数据持久化"><a href="#数据持久化" class="headerlink" title="数据持久化"></a>数据持久化</h4><p>安装：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yarn add redux-persist</span><br><span class="line">yarn add redux-persist-transform-immutable</span><br></pre></td></tr></table></figure><p>src -&gt; store -&gt; reducer.js</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// import &#123; combineReducers &#125; from &#x27;redux-immutable&#x27;;</span><br><span class="line">import &#123; combineReducers &#125; from &#x27;redux&#x27;; //此处不能再使用immutable对象，否则会报错</span><br><span class="line"></span><br><span class="line">import &#123;reducer as removeReducer&#125; from &#x27;../pages/admin/c-pages/remove/store&#x27;;</span><br><span class="line">import &#123;reducer as adminReducer&#125; from &#x27;../pages/admin-login/store&#x27;;</span><br><span class="line"></span><br><span class="line">const reducers = combineReducers(&#123; //合并每一个模块的reducers</span><br><span class="line">  remove: removeReducer,</span><br><span class="line">  admin: adminReducer</span><br><span class="line">&#125;);</span><br><span class="line">export default reducers;</span><br></pre></td></tr></table></figure><p>src -&gt; store -&gt; index.js</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">import &#123; applyMiddleware, createStore, compose &#125; from &#x27;redux&#x27;;</span><br><span class="line">import thunk from &#x27;redux-thunk&#x27;;</span><br><span class="line">import &#123;persistStore, persistReducer&#125; from &#x27;redux-persist&#x27;;</span><br><span class="line">import storageSession from &#x27;redux-persist/lib/storage/session&#x27;;</span><br><span class="line">import immutableTransform from &quot;redux-persist-transform-immutable&quot;;</span><br><span class="line"></span><br><span class="line">import reducer from &#x27;./reducer&#x27;; //导入合并的reducer</span><br><span class="line"></span><br><span class="line">const storageConfig = &#123;</span><br><span class="line">  transforms: [immutableTransform()], //告知有immutable对象，</span><br><span class="line">  key: &#x27;root&#x27;,</span><br><span class="line">  storage: storageSession, //缓存机制</span><br><span class="line">  blacklist: [] //reducer里不持久化的数据(可以省略)，除此以外均为持久化数据</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const myPersistReducer = persistReducer(storageConfig, reducer);</span><br><span class="line"></span><br><span class="line">const composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__  || compose;</span><br><span class="line"></span><br><span class="line">const store = createStore(myPersistReducer, composeEnhancers(applyMiddleware(thunk)));</span><br><span class="line"></span><br><span class="line">export const persistor = persistStore(store);</span><br><span class="line">export default store;</span><br></pre></td></tr></table></figure><p>src -&gt; App.js</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import &#123; PersistGate &#125; from &#x27;redux-persist/integration/react&#x27;</span><br><span class="line">import store, &#123;persistor&#125; from &quot;./store&quot;;</span><br><span class="line"></span><br><span class="line">&lt;Provider store=&#123;store&#125;&gt;  &#123;/*使用Provider共享store */&#125;</span><br><span class="line">	&lt;PersistGate loading=&#123;null&#125; persistor=&#123;persistor&#125;&gt;</span><br><span class="line">		&lt;BrowserRouter&gt;</span><br><span class="line">			&lt;Suspense&gt;</span><br><span class="line">				&#123;renderRoutes(routes)&#125;</span><br><span class="line">			&lt;/Suspense&gt;</span><br><span class="line">		&lt;/BrowserRouter&gt;</span><br><span class="line">	&lt;/PersistGate&gt;</span><br><span class="line">&lt;/Provider&gt;</span><br></pre></td></tr></table></figure><h3 id="Router"><a href="#Router" class="headerlink" title="Router"></a>Router</h3><p>SSR(server side render):服务端完成页面的渲染，服务器渲染</p><p>官网：<span class="exturl" data-url="aHR0cHM6Ly9yZWFjdHJvdXRlci5jb20v">https://reactrouter.com/<i class="fa fa-external-link-alt"></i></span></p><p>前端路由核心：</p><ol><li><p>改变 URL，但是页面不要进行强制刷新(a 元素不行)</p><ol><li><p>通过 URL 的 hash 改变 URL</p><ul><li><p>锚点，本质上是改变 window.location 的 href 属性</p><p>监听 hash 改变：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">&#x27;hashchange&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">//监听hash地址发生改变</span></span><br><span class="line">  <span class="built_in">console</span>.log(location.hash) <span class="comment">//打印根目录后面的hash地址</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li></ul></li><li><p>通过 HTML5 中的 history 模式修改 URL</p><ul><li><p>replaceState:替换原来的路径</p></li><li><p>pushState:使用新的路径</p></li><li><p>popState:路径的回退</p></li><li><p>go:向前或向后改变路径</p></li><li><p>forward:向前改变路径</p></li><li><p>back:向后改变路径</p><p>监听 history 的改变</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">aEls.forEach(<span class="function">(<span class="params">el</span>) =&gt;</span> &#123;</span><br><span class="line">  el.addEventListener(<span class="string">&#x27;click&#x27;</span>, <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">    e.preventDefault() <span class="comment">//阻止a标签的默认事件：点击跳转新页面，x</span></span><br><span class="line">    <span class="keyword">const</span> href = el.getAttribute(<span class="string">&#x27;href&#x27;</span>)</span><br><span class="line">    history.pushState(&#123;&#125;, <span class="string">&#x27;&#x27;</span>, href) <span class="comment">//携带的data    传过去的title     url</span></span><br><span class="line">    urlChange()</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">urlChange</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(location.pathname) <span class="comment">//获取根后面的路径，如/home、/about</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">window</span>.addEventLinstener(<span class="string">&#x27;popstate&#x27;</span>, urlChange) <span class="comment">//监听返回操作</span></span><br></pre></td></tr></table></figure></li></ul></li></ol></li><li><p>自己来监听 URL 的改变，并且改变之后自己改变页面的内容</p></li></ol><p>React Router 的版本 4 开始，路由不再集中在一个包中进行管理了：</p><p>react-router 是 router 的核心部分代码</p><p>react-router-dom 是用于核心浏览器的</p><p>react-router-native 是用于原生应用的</p><h4 id="安装-3"><a href="#安装-3" class="headerlink" title="安装"></a>安装</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yarn add react-router-dom</span><br><span class="line"><span class="meta">#</span><span class="bash">安装react-router-dom会自动安装react-router的依赖</span></span><br></pre></td></tr></table></figure><h4 id="基本使用-1"><a href="#基本使用-1" class="headerlink" title="基本使用"></a>基本使用</h4><ul><li>BrowserRouter 或 HashRouter(用于包裹 link、NavLink 和 Route)<ul><li>Router 中包含了对路径改变的监听，并且会将相应的路径传递给子组件</li><li>BrowserRouter 使用 history 模式</li><li>HashRouter 使用 hash 模式</li></ul></li><li>Link 和 NavLink<ul><li>通常路径的跳转是使用 Link 组件，最终会被渲染成 a 元素</li><li>NavLink 是在 Link 基础之上增加了一些样式属性</li><li>to 属性：Link 中最重要的属性，用于设置跳转到的路径</li><li>用户点击 Link 跳转到对应的 Route 里面</li><li>Link 都会在页面中显示(渲染成 a 标签)</li></ul></li><li>Route<ul><li>Route 用于路径的匹配，匹配上就渲染 Route 里面的组件</li><li>path 属性：用于设置匹配到的路径</li><li>component 属性：设置匹配到路径后，渲染的组件(内写组件名)</li><li>exact：精准匹配，只有精准匹配到完全一致的路径，才会渲染对应的组件</li><li>一堆 Route，只有匹配上的才会被渲染</li></ul></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; PureComponent &#125; from &#x27;react&#x27;;</span><br><span class="line">import &#123; BrowserRouter, Link, Route &#125; from &#x27;react-router-dom&#x27;;</span><br><span class="line">import About from &#x27;./pages/about&#x27;;</span><br><span class="line">import Home from &#x27;./pages/home&#x27;;</span><br><span class="line">import Profile from &#x27;./pages/profile&#x27;;</span><br><span class="line">export default class App extends PureComponent &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;BrowserRouter&gt;</span><br><span class="line">          &lt;Link to=&quot;/&quot;&gt;首页&lt;/Link&gt;</span><br><span class="line">          &lt;Link to=&quot;/about&quot;&gt;关于&lt;/Link&gt;</span><br><span class="line">          &lt;Link to=&quot;/profile&quot;&gt;我的&lt;/Link&gt;</span><br><span class="line">          &#123;/*Link可新建js文件产生数组，然后循环产生Link*/&#125;</span><br><span class="line"></span><br><span class="line">          &lt;Route exact path=&quot;/&quot; component=&#123;Home&#125;/&gt; &#123;/*精准匹配时,路径只有/,才会渲染此组件(防止其它路径包含/也渲染)*/&#125;</span><br><span class="line">          &#123;/*精准匹配/*/&#125;</span><br><span class="line">          &lt;Route path=&quot;/about&quot; component=&#123;About&#125;/&gt;</span><br><span class="line">          &lt;Route path=&quot;/profile&quot; component=&#123;Profile&#125;/&gt;</span><br><span class="line">        &lt;/BrowserRouter&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="NavLink、Route-补充"><a href="#NavLink、Route-补充" class="headerlink" title="NavLink、Route 补充"></a>NavLink、Route 补充</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">import &#123; NavLink &#125; from &quot;react-router-dom&quot;;</span><br><span class="line"></span><br><span class="line">&lt;NavLink exact to=&quot;/profile&quot; activeStyle=&#123;&#123;color: &#x27;red&#x27;&#125;&#125;&gt;我的&lt;/NavLink&gt; &#123;/*内联样式*/&#125;</span><br><span class="line">&#123;/*路由被选中时颜色变为红色(活跃时匹配的样式)*/&#125; &#123;/*exact:只有精确匹配的时候才会把它当成活跃的*/&#125;</span><br><span class="line"></span><br><span class="line">&#123;/*NavLink处于活跃时自带class：active*/&#125;</span><br><span class="line">&lt;NavLink to=&quot;/profile&quot; activeClassName=&quot;link-active&quot;&gt;我的&lt;/NavLink&gt;</span><br><span class="line">&#123;/*自定义处于活跃的路由的class名字为link-active*/&#125;</span><br><span class="line"></span><br><span class="line">&lt;Switch&gt;</span><br><span class="line">	&lt;Route path=&quot;/about&quot; component=&#123;About&#125;/&gt;</span><br><span class="line">  &lt;Route path=&quot;/profile&quot; component=&#123;Profile&#125;/&gt;</span><br><span class="line">  &lt;Route component=&#123;NoMatch&#125;/&gt; &#123;/*没有匹配到路由时，渲染组件NoMatch*/&#125;</span><br><span class="line">&lt;/Switch&gt;</span><br><span class="line">&#123;/*Switch：需导入，排它，从上往下只匹配一个路由,主要用于定义路径和组件之间的映射关系*/&#125;</span><br></pre></td></tr></table></figure><h4 id="Redirect"><a href="#Redirect" class="headerlink" title="Redirect"></a>Redirect</h4><p>用于路由重定向，当这个组件出现时，就会跳转到对应的 to 路径中</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import &#123; Redirect &#125; from &#x27;react-router-dom&#x27;; // 路由重定向组件</span><br><span class="line">render() &#123;</span><br><span class="line">  return this.state.isLogin ? (	//如果没有登录，跳转到/login路由</span><br><span class="line">  	&lt;div&gt;</span><br><span class="line">    	&lt;h2&gt;User&lt;/h2&gt;</span><br><span class="line">      &lt;h2&gt;用户名：coderwhy&lt;/h2&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  ) : &lt;Redirect to=&quot;/login&quot; /&gt; &#123;/*不满足会跳转到这个路径，匹配Route里path对应的组件*/&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="路由嵌套"><a href="#路由嵌套" class="headerlink" title="路由嵌套"></a>路由嵌套</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">//about.js about组件内</span><br><span class="line">return (</span><br><span class="line">&lt;div&gt;</span><br><span class="line">  &lt;NavLink exact to=&quot;/about&quot; activeClassName=&quot;about-active&quot;&gt;企业历史&lt;/NavLink&gt;</span><br><span class="line">  &lt;NavLink exact to=&quot;/about/culture&quot; activeClassName=&quot;about-active&quot;&gt;企业文化&lt;/NavLink&gt;</span><br><span class="line">  &lt;NavLink exact to=&quot;/about/contact&quot; activeClassName=&quot;about-active&quot;&gt;联系我们&lt;/NavLink&gt;</span><br><span class="line"></span><br><span class="line">  &lt;Switch&gt; &#123;/*定义路径和组件之间的映射关系*/&#125;</span><br><span class="line">    &lt;Route exact path=&quot;/about&quot; component=&#123;AboutHisotry&#125;/&gt;</span><br><span class="line">    &#123;/*在about路由下，默认显示的子路由，精确匹配*/&#125;</span><br><span class="line">    &#123;/*以下路由为about的子路由，则需要在path里面加上/about*/&#125;</span><br><span class="line">    &lt;Route path=&quot;/about/culture&quot; component=&#123;AboutCulture&#125;/&gt;</span><br><span class="line">    &lt;Route path=&quot;/about/contact&quot; component=&#123;AboutContact&#125;/&gt;</span><br><span class="line">    &lt;Route path=&quot;/about/join&quot; component=&#123;AboutJoin&#125;/&gt;</span><br><span class="line">  &lt;/Switch&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h4 id="手动路由跳转"><a href="#手动路由跳转" class="headerlink" title="手动路由跳转"></a>手动路由跳转</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;button onClick=&#123;e =&gt; this.aaa()&#125;&gt;加入我们&lt;/button&gt;</span><br><span class="line"></span><br><span class="line">aaa() &#123;</span><br><span class="line">	this.props.history.push(&quot;/about/join&quot;);	//跳转</span><br><span class="line">  //通过路由渲染出来的组件才能使用以上方法进行路由跳转</span><br><span class="line">&#125;</span><br><span class="line">ul&gt;li&#123;商品列表$&#125;*5</span><br><span class="line"></span><br><span class="line">//非路由渲染组件如果要使用this.props.history方法：要使其有history属性</span><br><span class="line">//1.在用这个组件的地方使用BrowserRouter包裹</span><br><span class="line">&lt;BrowserRouter&gt;</span><br><span class="line">	&lt;User /&gt;</span><br><span class="line">&lt;/BrowserRouter&gt;</span><br><span class="line">//2.在组件里面导出组件时使用withRouter包裹···············</span><br><span class="line">import &#123;withRouter&#125; from &#x27;react-router-dom&#x27;</span><br><span class="line">export default withRouter(User)</span><br></pre></td></tr></table></figure><h4 id="参数传递"><a href="#参数传递" class="headerlink" title="参数传递"></a>参数传递</h4><ul><li><p>动态路由(传简单数据)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">const id = &#x27;abc&#x27;;	//定义id</span><br><span class="line"></span><br><span class="line">&lt;NavLink to=&#123;`/detail/$&#123;id&#125;`&#125;&gt;&lt;/NavLink&gt;</span><br><span class="line"></span><br><span class="line">&lt;Route path=&quot;/detail/:id&quot; component=&#123;Detail&#125;/&gt;</span><br><span class="line"></span><br><span class="line">//detail.js组件里面拿到传过来的参数</span><br><span class="line">w</span><br></pre></td></tr></table></figure></li><li><p>search 传递参数(React 不推荐)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;NavLink to=&#123;`/detail?name=why&amp;age=18`&#125;&gt;&lt;/NavLink&gt;</span><br><span class="line"></span><br><span class="line">&lt;Route path=&quot;/detail&quot; component=&#123;Detail&#125;/&gt;</span><br><span class="line"></span><br><span class="line">//detail.js里面拿到传过来的参数</span><br><span class="line">this.props.location.search // ?name=why&amp;age=18 需要自己解析参数</span><br><span class="line">//JSON.stringify   JSON.parse</span><br></pre></td></tr></table></figure></li><li><p>Link 中 to 传入对象(传复杂数据)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">const info = &#123;name: &quot;why&quot;, age: 18, height: 1.88&#125;;</span><br><span class="line"></span><br><span class="line">&lt;NavLink to=&#123;&#123;	//to属性跟上一个对象</span><br><span class="line">    pathname: &quot;/detail&quot;, //必传，告诉跳转到哪个路径</span><br><span class="line">    search: &quot;?name=abc&quot;,	//会拼接到路径后面</span><br><span class="line">    hash:&quot;#the-hash&quot;, //当路径使用hash模式时传</span><br><span class="line">    state:info //传复杂的数据</span><br><span class="line">  &#125;&#125;&gt;&lt;/NavLink&gt;</span><br><span class="line"></span><br><span class="line">&lt;Route path=&quot;/detail&quot; component=&#123;Detail&#125;/&gt;</span><br><span class="line"></span><br><span class="line">//手动跳转路由时传递复杂参数</span><br><span class="line">props.history.push(&#123;</span><br><span class="line">	pathname: &quot;/settle&quot;,</span><br><span class="line">	state: mulSettleInfo</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">//detail.js里面拿到传过来的参数</span><br><span class="line">this.props.location.state // 接收传过来的对象</span><br></pre></td></tr></table></figure></li></ul><h4 id="统一管理路由映射关系"><a href="#统一管理路由映射关系" class="headerlink" title="统一管理路由映射关系"></a>统一管理路由映射关系</h4><p>安装：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add react-router-config</span><br></pre></td></tr></table></figure><p>使用：</p><ol><li><p>在 src 下新建文件夹 router</p></li><li><p>在 router 下新建文件 index.js</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">import React from &quot;react&quot;； //路由重定向使用了jsx语法，所以需要导入</span><br><span class="line">import &#123; Redirect &#125; from &#x27;react-router-dom&#x27;; // 路由重定向组件</span><br><span class="line"></span><br><span class="line">import Home from &#x27;../pages/home&#x27;;</span><br><span class="line">import Profile from &#x27;../pages/profile&#x27;;</span><br><span class="line">import About from &#x27;../pages/about&#x27;;</span><br><span class="line">import &#123; AboutHisotry, AboutContact &#125; from &#x27;../pages/about&#x27;;</span><br><span class="line"></span><br><span class="line">const routes = [  //存放映射关系</span><br><span class="line">//  &#123;</span><br><span class="line"> //   path: &quot;/&quot;,  //路径</span><br><span class="line"> //   exact: true,</span><br><span class="line">  //  component: Home  //对应的组件</span><br><span class="line"> // &#125;,</span><br><span class="line">  &#123; // 从根路径进入时使其渲染指定的组件</span><br><span class="line">    path: &quot;/&quot;,</span><br><span class="line">    exact: true, //精确匹配</span><br><span class="line">    render: () =&gt; ( // 路由重定向,小括号</span><br><span class="line">      &lt;Redirect to=&quot;/home&quot; /&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: &quot;/about&quot;,</span><br><span class="line">    component: About,</span><br><span class="line">    routes: [ //配置子路由</span><br><span class="line">      &#123;</span><br><span class="line">        path: &quot;/about&quot;,  //默认子路由</span><br><span class="line">        exact: true,</span><br><span class="line">        render: () =&gt; (</span><br><span class="line">      		&lt;Redirect to=&quot;/about/contact&quot; /&gt;</span><br><span class="line">    		)</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        path: &quot;/about/contact&quot;,</span><br><span class="line">        component: AboutContact</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: &quot;/profile&quot;,</span><br><span class="line">    component: Profile</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: &quot;/detail&quot;,</span><br><span class="line">    component: Detail</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br><span class="line">export default routes;</span><br></pre></td></tr></table></figure></li><li><p>在其他文件使用</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import &#123; renderRoutes &#125; from &#x27;react-router-config&#x27;;</span><br><span class="line">import routes from &#x27;./router&#x27;;	//导入路由</span><br><span class="line">&#123;renderRoutes(routes)&#125; //渲染路由</span><br><span class="line"></span><br><span class="line">//有子路由时，即在about里面使用时</span><br><span class="line">&#123;renderRoutes(this.props.route.routes)&#125;  &#123;/*只有父组件通过renderRoutes渲染时才有this.props.route这个属性，switch渲染时没有*/&#125;</span><br><span class="line">//有子路由时，函数组件：</span><br><span class="line">&#123;renderRoutes(props.route.routes)&#125;	&#123;/* 代替一大堆的&lt;Route /&gt;,上面的Link还是要写 */&#125;</span><br><span class="line"></span><br><span class="line">//返回匹配到的所有分支</span><br><span class="line">matchRoutes(this.props.route.routes, &quot;/about&quot;);</span><br><span class="line">//参数1：数组， 参数2：要匹配的路由  从数组路面查找匹配/about的路由</span><br></pre></td></tr></table></figure></li></ol><h4 id="懒加载"><a href="#懒加载" class="headerlink" title="懒加载"></a>懒加载</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123;lazy&#125; from &quot;react&quot;</span><br><span class="line"></span><br><span class="line">//const Profile = React.lazy(() =&gt; import(&quot;pages/profile&quot;));	不解构lazy</span><br><span class="line">const Profile = lazy(_ =&gt; import(&quot;pages/profile&quot;));</span><br><span class="line">const Profile = lazy(() =&gt; import(&quot;pages/profile&quot;));</span><br><span class="line">const routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    path: &quot;/profile&quot;,</span><br><span class="line">    component: Profile</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br><span class="line">export default routes;</span><br><span class="line"></span><br><span class="line">//在其他地方使用</span><br><span class="line">import React, &#123; Suspense &#125; from &#x27;react&#x27;;</span><br><span class="line">import &#123; renderRoutes &#125; from &#x27;react-router-config&#x27;;</span><br><span class="line">&lt;Suspense fallback=&#123;&lt;div&gt;page loading&lt;/div&gt;&#125;&gt; &#123;/*懒加载外面必须用Suspense组件包裹*/&#125;</span><br><span class="line">  &#123;renderRoutes(routes)&#125; &#123;/*需要使用BrowserRouter包裹*/&#125;</span><br><span class="line">&lt;/Suspense&gt;</span><br><span class="line">//组件加载较慢时就展示fallback里面的page loading</span><br></pre></td></tr></table></figure><h3 id="Hooks"><a href="#Hooks" class="headerlink" title="Hooks"></a>Hooks</h3><p><strong>Hook</strong>(钩子):React16.8 新特性，可以让我们在不编写 class 的情况下使用 state 以及其他的 React 特性(如生命周期**)**；</p><p>可以代替之前所有使用 class 组件的地方；只能在函数组件中使用</p><p>使用 useState 改变后无法立即获取最新的值，可使用 useRef 代替 useState(暂时解决办法)</p><p><strong>class 组件存在的缺点</strong></p><ul><li>复杂组件变得难以理解</li><li>难以理解的 class(this 指向)</li><li>组件复用状态很难</li></ul><h4 id="体验-useState"><a href="#体验-useState" class="headerlink" title="体验 useState"></a>体验 useState</h4><p>usestate：用于函数式组件保存状态</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; useState &#125; from &quot;react&quot;;</span><br><span class="line"></span><br><span class="line">export default function CounterHook() &#123;</span><br><span class="line">  //Hook: rfc快捷键生成函数组件</span><br><span class="line">  // useState:本身是一个函数，来自react包,需以解构方式导入</span><br><span class="line">  //有参数和返回值</span><br><span class="line">  //参数：给创建出来的状态一个默认值,不设置为undefined</span><br><span class="line">  //返回一个有两个值的数组</span><br><span class="line">  // 返回值1，当前状态的值(第一次调用时为初始化值)</span><br><span class="line">  //返回值2，给状态设置新的值时使用的一个函数,改变count的值时调用此函数即可</span><br><span class="line">  const [count, setCount] = useState(0); //解构返回值数组,返回值的名字为自定义</span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;h2&gt;CounterHook&lt;/h2&gt;</span><br><span class="line">        当前计数：&lt;h2&gt;&#123;count&#125;&lt;/h2&gt;</span><br><span class="line">        &lt;button onClick=&#123;e =&gt; setCount(count + 1)&#125;&gt;+1&lt;/button&gt; &#123;/*点击时将原来的count变量的值加1*/&#125;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="使用-hook-两个额外的原则"><a href="#使用-hook-两个额外的原则" class="headerlink" title="使用 hook 两个额外的原则"></a>使用 hook 两个额外的原则</h4><ul><li><p>只能在函数最外层调用 Hook。不要在循环、条件判断、子函数中使用</p></li><li><p>只能在 React 的函数组件中调用 Hook，不要在其它 JavaScript 函数中调用</p><p>在普通函数里面不能使用 Hooks，只能在自定义 Hook 的函数里面使用</p></li></ul><h4 id="使用多个状态"><a href="#使用多个状态" class="headerlink" title="使用多个状态"></a>使用多个状态</h4><p>多个状态使用多个 useState 即可</p><p>可输入 useState,然后选择 vscode 安装的插件的代码块快速创建 state</p><p>先输入 state 名字，再按 tab 输入初始化值</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; useState &#125; from &quot;react&quot;;</span><br><span class="line"></span><br><span class="line">export default function MultiHookState() &#123;</span><br><span class="line">  const [count, setCount] = useState(0);</span><br><span class="line">  const [age, setAge] = useState(18);</span><br><span class="line">  const [friends, setFriends] = useState([&quot;kobe&quot;, &quot;lilei&quot;]); //复杂状态</span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;h2&gt;当前计数：&#123;count&#125;&lt;/h2&gt;</span><br><span class="line">      &lt;h2&gt;我的年龄：&#123;age&#125;&lt;/h2&gt;</span><br><span class="line">      &lt;ul&gt;</span><br><span class="line">        &#123;</span><br><span class="line">          friends.map((el, index) =&gt; &#123;</span><br><span class="line">            return &lt;li key=&#123;index&#125;&gt;&#123;el&#125;&lt;/li&gt;</span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">      &lt;/ul&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="修改复杂状态"><a href="#修改复杂状态" class="headerlink" title="修改复杂状态"></a>修改复杂状态</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; useState &#125; from &#x27;react&#x27;</span><br><span class="line"></span><br><span class="line">export default function ComplexHookState() &#123;</span><br><span class="line">  const [friends, setFriends] = useState([&quot;kobe&quot;, &quot;lilei&quot;]);</span><br><span class="line">  const [students, setStudents] = useState([</span><br><span class="line">    &#123;id: 110, name: &quot;why&quot;, age: 18&#125;,</span><br><span class="line">    &#123;id: 111, name: &quot;ysj&quot;, age: 22&#125;,</span><br><span class="line">    &#123;id: 112, name: &quot;kobe&quot;, age: 40&#125;,</span><br><span class="line">    &#123;id: 113, name: &quot;lilei&quot;, age: 20&#125;,</span><br><span class="line">  ])</span><br><span class="line"></span><br><span class="line">  function incrementAgeWithIndex(index) &#123;</span><br><span class="line">    const newStudents = [...students]; //创建新的对象，将原来的数据拷贝，赋值给新的对象</span><br><span class="line">    newStudents[index].age += 1; //修改新对象</span><br><span class="line">    setStudents(newStudents); //将新对象传入setStudents</span><br><span class="line"></span><br><span class="line">    &#123;/*setState可以传入一个函数*/&#125;</span><br><span class="line">    setCount((preCount) =&gt; preCount + 10);</span><br><span class="line">    //传入一个函数，拿到前一次的值，加10,返回加后的值</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;h2&gt;好友列表&lt;/h2&gt;</span><br><span class="line">      &lt;ul&gt;</span><br><span class="line">        &#123;</span><br><span class="line">          friends.map((el, index) =&gt; &#123;</span><br><span class="line">            return &lt;li key=&#123;index&#125;&gt;&#123;el&#125;&lt;/li&gt;</span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">      &lt;/ul&gt;</span><br><span class="line">      &lt;button onClick=&#123;el =&gt; setFriends([...friends, &quot;tom&quot;])&#125;&gt;增加好友&lt;/button&gt;</span><br><span class="line">      &#123;/* 传入数组，setState做的是替换操作，所以需先拷贝原来的数组 */&#125;</span><br><span class="line"></span><br><span class="line">      &lt;h2&gt;学生列表&lt;/h2&gt;</span><br><span class="line">      &lt;ul&gt;</span><br><span class="line">        &#123;</span><br><span class="line">          students.map((item, index)=&gt; &#123;</span><br><span class="line">            return (</span><br><span class="line">              &lt;li key=&#123;item.id&#125;&gt;</span><br><span class="line">                &lt;span&gt;学生姓名：&#123;item.name&#125;&lt;/span&gt;</span><br><span class="line">                &lt;span&gt;学生年龄：&#123;item.age&#125;&lt;/span&gt;</span><br><span class="line">                &lt;button onClick=&#123;e =&gt; incrementAgeWithIndex(index)&#125;&gt;age + 1&lt;/button&gt;</span><br><span class="line">              &lt;/li&gt;</span><br><span class="line">            )</span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">      &lt;/ul&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="useEffect"><a href="#useEffect" class="headerlink" title="useEffect"></a>useEffect</h4><p>作用：来完成一些类似于 class 中生命周期的功能,模拟 componentDidMount，组件发送网络请求的地方</p><p>useEffect 基本使用：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; useEffect, useState &#125; from &#x27;react&#x27;</span><br><span class="line"></span><br><span class="line">export default function HookChangeTitle() &#123;</span><br><span class="line">  const [count, setCount] = useState(0);</span><br><span class="line">  useEffect(() =&gt; &#123; //组件内数据渲染到真实DOM后回调此函数</span><br><span class="line">    document.title = count;</span><br><span class="line">  &#125;);</span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;h2&gt;当前计数：&#123;count&#125;&lt;/h2&gt;</span><br><span class="line">      &lt;button onClick=&#123;e =&gt; setCount(count + 1)&#125;&gt;+1&lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>useEffect 模拟订阅和取消</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; useEffect &#125; from &#x27;react&#x27;</span><br><span class="line"></span><br><span class="line">export default function EffectHookCancel() &#123;</span><br><span class="line">  useEffect(() =&gt; &#123; //useEffect接收一个函数</span><br><span class="line">    console.log(&quot;订阅一些事件&quot;);</span><br><span class="line"></span><br><span class="line">    return () =&gt; &#123; //接收函数的返回值又是另外一个函数,当组件卸载或更新时都会来到此回调函数</span><br><span class="line">      console.log(&quot;取消订阅&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;, []);  //第二个参数，数组</span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;h2&gt;EffectHookCancel&lt;/h2&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>useEffect 可以多个一起使用，每个 useEffect 处理不同的逻辑(网络请求，事件订阅等)</p><p>只要当前组件重新渲染，所有的 useEffect 都会重新执行一遍</p><p><strong>useEffect 第二个参数为数组类型，传入所依赖的一些变量，当这些变量发生改变的时候才会重新执行 useEffect</strong></p><p>要想某些功能只在组件第一次渲染时执行一次，就可以传入空数组( [] )，表示谁都不依赖</p><h4 id="useContext"><a href="#useContext" class="headerlink" title="useContext"></a>useContext</h4><p>作用：给 Context 后面的所有子孙组件共享一些数据</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">export const UserContext = createContext();</span><br><span class="line">export const ThemeContext = createContext();</span><br><span class="line"></span><br><span class="line">&lt;UserContext.Provider value=&#123;&#123;name: &quot;why&quot;, age: 18&#125;&#125;&gt;</span><br><span class="line">  &lt;ThemeContext.Provider value=&#123;&#123;fontSize: &quot;30px&quot;, color: &quot;red&quot;&#125;&#125;&gt;</span><br><span class="line">    &lt;ContextHookDemo/&gt;</span><br><span class="line">  &lt;/ThemeContext.Provider&gt;</span><br><span class="line">&lt;/UserContext.Provider&gt;</span><br><span class="line">&#123;/*通过context共享数据给ContextHookDemo的子孙组件*/&#125;</span><br><span class="line"></span><br><span class="line">import React, &#123; useContext &#125; from &#x27;react&#x27;;</span><br><span class="line">import &#123; UserContext, ThemeContext &#125; from &quot;../App&quot;;</span><br><span class="line">export default function ContextHookDemo(props) &#123;</span><br><span class="line">  const user = useContext(UserContext);	//拿到context共享的数据</span><br><span class="line">  const theme = useContext(ThemeContext);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="useReducer"><a href="#useReducer" class="headerlink" title="useReducer"></a>useReducer</h4><p>是 useState 的一种替代方案</p><ul><li>在某些场景下，如果 state 的处理逻辑比较复杂，我们可以通过 useReducer 来对其进行拆分</li><li>或者这次修改的 state 需要依赖之前的 state 时，也可以使用</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; useReducer &#125; from &#x27;react&#x27;;</span><br><span class="line">import reducer from &#x27;./reducer&#x27;;</span><br><span class="line">export default function Home() &#123;</span><br><span class="line">  // const [count, setCount] = useState(0);</span><br><span class="line">  const [state, dispatch] = useReducer(reducer, &#123;counter: 0&#125;);</span><br><span class="line">  //state:当前状态的值</span><br><span class="line">  //要改变某一个值的时候可以dispatch一个action对象</span><br><span class="line">  //reducer为纯函数</span><br><span class="line">  // &#123;counter: 0&#125; 初始化值</span><br><span class="line"></span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;h2&gt;Home当前计数: &#123;state.counter&#125;&lt;/h2&gt;</span><br><span class="line">      &lt;button onClick=&#123;e =&gt; dispatch(&#123;type: &quot;increment&quot;, payload: &quot;aaa&quot;&#125;)&#125;&gt;+1&lt;/button&gt;</span><br><span class="line">      &#123;/*payload:携带的额外的值*/&#125;</span><br><span class="line">      &lt;button onClick=&#123;e =&gt; dispatch(&#123;type: &quot;decrement&quot;&#125;)&#125;&gt;-1&lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//reducer.js 也可不用拆分，就在组件里面定义reducer函数</span><br><span class="line">//多个文件同时使用这个函数，里面的数据也不能共享</span><br><span class="line">export default function reducer(state, action) &#123; //纯函数，后续作为useReducer的第一个参数</span><br><span class="line">  switch(action.type) &#123;</span><br><span class="line">    case &quot;increment&quot;:</span><br><span class="line">      return &#123;...state, counter: state.counter + 1&#125;;</span><br><span class="line">    case &quot;decrement&quot;:</span><br><span class="line">      return &#123;...state, counter: state.counter - 1&#125;;</span><br><span class="line">    default:</span><br><span class="line">      return state;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="useCallback"><a href="#useCallback" class="headerlink" title="useCallback"></a>useCallback</h4><p>目的：进行性能的优化</p><ul><li>useCallback 会返回一个<strong>函数</strong>的 memoized（记忆的） 值</li><li>在依赖不变的情况下，多次定义的时候，返回的值是相同的</li><li><strong>针对函数</strong></li><li>如果把函数作为参数传递到下一个组件，需要使用 useCallback(),可以对当前函数缓存、记忆</li></ul><p>通常使用 useCallback 的目的是不希望子组件进行多次渲染，并不是为了函数进行缓存</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">const increment2 = useCallback(() =&gt; &#123; //仅仅只使用这种方式并不能进行任何的性能优化</span><br><span class="line">  console.log(&quot;执行increment2函数&quot;);</span><br><span class="line">  setCount(count + 1);</span><br><span class="line">&#125;, [count]);</span><br><span class="line">//如果没有任何依赖，useCallback返回的永远是同一个函数</span><br></pre></td></tr></table></figure><p>用 memo 包裹性能优化，函数式组件定义时直接包裹 memo</p><p>父组件重新渲染，所有子组件也会重新渲染，memo 可让子组件根据 props 有无更新从而决定要不要重新渲染</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123;useState, useCallback, memo&#125; from &#x27;react&#x27;;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * useCallback在什么时候使用?</span><br><span class="line"> * 场景: 在将一个组件中的函数 , 传递给子元素进行回调使用时, 使用useCallback对函数进行处理.</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">const HYButton = memo((props) =&gt; &#123; //函数式组件</span><br><span class="line">  console.log(&quot;HYButton重新渲染: &quot; + props.title);</span><br><span class="line">  return &lt;button onClick=&#123;props.increment&#125;&gt;HYButton +1&lt;/button&gt;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">export default function CallbackHookDemo02() &#123;</span><br><span class="line">  console.log(&quot;CallbackHookDemo02重新渲染&quot;);</span><br><span class="line"></span><br><span class="line">  const [count, setCount] = useState(0);</span><br><span class="line"></span><br><span class="line">  const increment2 = useCallback(() =&gt; &#123; //对传入的回调函数做优化，返回值是一个函数</span><br><span class="line">    console.log(&quot;执行increment2函数&quot;);</span><br><span class="line">    setCount(count + 1);</span><br><span class="line">  &#125;, [count]);</span><br><span class="line"></span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;h2&gt;CallbackHookDemo01: &#123;count&#125;&lt;/h2&gt;</span><br><span class="line">      &lt;HYButton title=&quot;btn2&quot; increment=&#123;increment2&#125;/&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>通常使用 useCallback 的目的是不希望子组件进行多次渲染，并不是为了函数进行缓存</p><h4 id="useMemo"><a href="#useMemo" class="headerlink" title="useMemo"></a>useMemo</h4><p>useMemo 实际的目的也是为了进行性能的优化。</p><ul><li>useMemo 返回的也是一个 memoized（记忆的） 值</li><li>在依赖不变的情况下，多次定义的时候，返回的值是相同的</li><li><strong>针对返回值</strong></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">const total = useMemo(() =&gt; &#123;</span><br><span class="line">	return calcNumber(count);</span><br><span class="line">&#125;, [count]);	//count发生改变时count才会重新执行</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">//父组件重新渲染的时候，传给子组件的值不改变，子组件就不重新渲染</span><br><span class="line">import React, &#123; useState, memo, useMemo &#125; from &#x27;react&#x27;;</span><br><span class="line"></span><br><span class="line">const HYInfo = memo((props) =&gt; &#123;</span><br><span class="line">  console.log(&quot;HYInfo重新渲染&quot;);</span><br><span class="line">  return &lt;h2&gt;名字: &#123;props.info.name&#125; 年龄: &#123;props.info.age&#125;&lt;/h2&gt;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">export default function MemoHookDemo02() &#123;</span><br><span class="line">  console.log(&quot;MemoHookDemo02重新渲染&quot;);</span><br><span class="line">  const [show, setShow] = useState(true);</span><br><span class="line"></span><br><span class="line">  const info = useMemo(() =&gt; &#123;	//对返回值做优化，使返回值不改变时子组件就不重新渲染</span><br><span class="line">    return &#123; name: &quot;why&quot;, age: 18 &#125;;</span><br><span class="line">  &#125;, []);</span><br><span class="line"></span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;HYInfo info=&#123;info&#125; /&gt;</span><br><span class="line">      &lt;button onClick=&#123;e =&gt; setShow(!show)&#125;&gt;show切换&lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="useRef"><a href="#useRef" class="headerlink" title="useRef"></a>useRef</h4><p>返回一个 ref 对象，返回的 ref 对象在组件的整个生命周期保持不变</p><p>两种用法：</p><ul><li>引入 DOM 元素(或 class 组件)</li><li>保存一个数据，这个对象在整个生命周期中可以保持不变</li></ul><p>基本使用：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; useRef &#125; from &#x27;react&#x27;</span><br><span class="line"></span><br><span class="line">export default function RefHook() &#123;</span><br><span class="line">  const titleRef = useRef();	//1.创建</span><br><span class="line"></span><br><span class="line">  function changeDOM() &#123;</span><br><span class="line">    titleRef.current.innerHTML = &quot;Hello World&quot;; //3.使用</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;h2 ref=&#123;titleRef&#125;&gt;RefHook&lt;/h2&gt;  &#123;/*2.绑定*/&#125;</span><br><span class="line">      &lt;button onClick=&#123;e =&gt; changeDOM()&#125;&gt;修改DOM&lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>useRef 引用其它数据</p><p>可用来保存某一个 value 本次和前一次的值</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; useEffect, useRef, useState &#125; from &#x27;react&#x27;</span><br><span class="line"></span><br><span class="line">export default function RefHook() &#123;</span><br><span class="line">  const [count, setCount] = useState(0);</span><br><span class="line">  const numRef = useRef(count);//直接传入数据，在整个组件的生命周期返回的值都是相同的,可通过numRef.current取出</span><br><span class="line">  useEffect(() =&gt; &#123; //count一旦发生变化，重新渲染完之后会执行此处代码</span><br><span class="line">    numRef.current = count;</span><br><span class="line">  &#125;, [count]);</span><br><span class="line"></span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;h2&gt;count上一次的值: &#123;numRef.current&#125;&lt;/h2&gt;</span><br><span class="line">      &lt;h2&gt;count这一次的值: &#123;count&#125;&lt;/h2&gt;</span><br><span class="line">      &lt;button onClick=&#123;e =&gt; setCount(count + 10)&#125;&gt;+10&lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="useImperativeHandle"><a href="#useImperativeHandle" class="headerlink" title="useImperativeHandle"></a>useImperativeHandle</h4><p>forwardRef 用法：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123;forwardRef, useRef&#125; from &#x27;react&#x27;</span><br><span class="line"></span><br><span class="line">const HYInput = forwardRef((props, ref) =&gt; &#123; //3.使用forwardRef包裹子组件,接收ref</span><br><span class="line">  return &lt;input ref=&#123;ref&#125; /&gt; //4.绑定</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">export default function ForwardRef() &#123;</span><br><span class="line">  const inputRef = useRef(); //1.创建</span><br><span class="line"></span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;HYInput ref=&#123;inputRef&#125;/&gt; &#123;/*2.传入*/&#125;</span><br><span class="line">      &lt;button onClick=&#123;e =&gt; inputRef.current.focus()&#125;&gt;聚焦&lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line">//此种做法让父组件可以任意操作子组件，自由度太高，不推荐</span><br></pre></td></tr></table></figure><p>改进：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123;forwardRef, useImperativeHandle, useRef&#125; from &#x27;react&#x27;</span><br><span class="line">const HYInput = forwardRef((props, ref) =&gt; &#123; //2.使用forwardRef包裹子组件，接受父组件传递的ref</span><br><span class="line">  const childRef = useRef();  //3.子组件自己创建的ref</span><br><span class="line"></span><br><span class="line">  useImperativeHandle(ref, () =&gt; (&#123; //5.将父组件的ref传入，返回的对象会被绑定到父组件的ref的current里面</span><br><span class="line">    //所以后面父组件拿到的current就是此处子组件返回的一个对象</span><br><span class="line">    focus: () =&gt; &#123;  //6.将这个给父元素调用，使父组件只能调用此功能</span><br><span class="line">      childRef.current.focus();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;), [childRef]);</span><br><span class="line">  // 参数1：ref</span><br><span class="line">  // 参数2：有返回值的回调函数</span><br><span class="line">  return &lt;input ref=&#123;childRef&#125; /&gt; &#123;/*4.绑定子组件自己的ref*/&#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">export default function useImperativeHandleHook() &#123;</span><br><span class="line">  const parentsRef = useRef(); //1.创建ref，传给子组件</span><br><span class="line"></span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;HYInput ref=&#123;parentsRef&#125;/&gt;</span><br><span class="line">      &lt;button onClick=&#123;e =&gt; parentsRef.current.focus()&#125;&gt;聚焦&lt;/button&gt;</span><br><span class="line">      &#123;/* 此处本质上执行的子组件返回的focus */&#125;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>以后只要用到 forwardRef 都要通过这种方式去用</p><p>useImperativeHandle 里面调用子组件的函数报警告时，可将被调用的函数使用 useCallback 包裹</p><h4 id="useLayoutEffect"><a href="#useLayoutEffect" class="headerlink" title="useLayoutEffect"></a>useLayoutEffect</h4><p>useLayoutEffect 看起来和 useEffect 非常的相似，事实上他们也只有一点区别而已</p><ul><li>useEffect 会在渲染的内容更新到 DOM 上之后执行，不会阻塞 DOM 的更新</li><li>useLayoutEffect 会在渲染的内容更新到 DOM 上之前执行，会阻塞 DOM 的更新</li></ul><p>如果我们希望在某些操作发生之后再更新 DOM，那么应该将这个操作放到 useLayoutEffect</p><p>用得很少，一般都用 useEffect,出问题再尝试用用 useLayoutEffect</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; useLayoutEffect, useState &#125; from &#x27;react&#x27;</span><br><span class="line"></span><br><span class="line">export default function EffectCounter() &#123;</span><br><span class="line">  const [count, setCount] = useState(10);</span><br><span class="line"></span><br><span class="line">  useLayoutEffect(() =&gt; &#123;</span><br><span class="line">    if(count === 0)</span><br><span class="line">      setCount(Math.random());</span><br><span class="line">  &#125;, [count]);</span><br><span class="line"></span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;h2&gt;数字：&#123;count&#125;&lt;/h2&gt;</span><br><span class="line">      &lt;button onClick=&#123;e =&gt; setCount(0)&#125;&gt;修改数字&lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="自定义-Hook"><a href="#自定义-Hook" class="headerlink" title="自定义 Hook"></a>自定义 Hook</h4><p>普通函数变成自定 Hook：函数名字前面加 use</p><p>作用：将相同逻辑代码抽到一个函数里面(函数里面可以使用 hooks)，可用来代替高阶组件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">function useLogginLife(name) &#123;	//函数名字前面加use</span><br><span class="line">  useEffect(() =&gt; &#123;</span><br><span class="line">    console.log(`$&#123;name&#125;组件被创建出来了`);</span><br><span class="line">    return () =&gt; &#123;</span><br><span class="line">      console.log(`$&#123;name&#125;组件被销毁掉了`);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, [name]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>实际应用：Context 共享</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">//App.js</span><br><span class="line">export const UserContext = createContext();</span><br><span class="line">export const TokenContext = createContext();</span><br><span class="line">&lt;UserContext.Provider value=&#123;&#123;name: &quot;why&quot;, age: 18&#125;&#125;&gt;</span><br><span class="line">  &lt;TokenContext.Provider value=&quot;dasdsa&quot;&gt;</span><br><span class="line">  	&lt;CustomHook /&gt;</span><br><span class="line">  &lt;/TokenContext.Provider&gt;</span><br><span class="line">&lt;/UserContext.Provider&gt;</span><br><span class="line"></span><br><span class="line">//src -&gt; hooks -&gt; user-hook.js</span><br><span class="line">import &#123; useContext &#125; from &quot;react&quot;;</span><br><span class="line">import &#123; TokenContext, UserContext &#125; from &quot;../App&quot;;</span><br><span class="line">function useUserContext() &#123;</span><br><span class="line">  const user = useContext(UserContext);</span><br><span class="line">  const token = useContext(TokenContext);</span><br><span class="line">  return [user ,token];</span><br><span class="line">&#125;</span><br><span class="line">export default useUserContext;</span><br><span class="line"></span><br><span class="line">//自定义hook_context共享.js</span><br><span class="line">import useUserContext from &#x27;../hooks/user-hook&#x27;;</span><br><span class="line">export default function CustomContextShareHook() &#123;</span><br><span class="line">  const [user, token] = useUserContext(); //使用自定义的hook拿到context</span><br><span class="line">  console.log(&#123;user, token&#125;);</span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      CustomContextShareHook</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;实际应用：获取滚动位置**</span><br></pre></td></tr></table></figure><p>其它情况用法类似，将想实现的功能封装在 hooks 里面，再在要使用该功能的组件里面引入封装的 hooks 文件</p><p><strong>localStorage 存储</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.localStorage.setItem(<span class="string">&#x27;name&#x27;</span>, <span class="built_in">JSON</span>.stringify(name)) <span class="comment">//存储数据</span></span><br><span class="line"><span class="keyword">const</span> name = <span class="built_in">JSON</span>.parse(<span class="built_in">window</span>.localStorage.getItem(<span class="string">&#x27;name&#x27;</span>)) <span class="comment">//取出数据</span></span><br></pre></td></tr></table></figure><h4 id="useSelector"><a href="#useSelector" class="headerlink" title="useSelector"></a>useSelector</h4><p>作用:让组件和 redux 结合起来,将 state 映射到组件中(不需要编写 connect 以及对应的映射函数了)</p><ul><li><p>参数一：将 state 映射到需要的数据中</p></li><li><p>参数二：可以进行比较来决定是否组件重新渲染</p></li></ul><p>useSelector 默认会比较我们返回的两个对象是否相等(===，会比较值和类型)</p><p>useDispatch 非常简单，就是直接获取 dispatch 函数，之后在组件中直接使用即可(来自 react-redux)</p><p>我们还可以通过 useStore 来获取当前的 store 对象</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">import &#123; getTopBannerAction &#125; from &#x27;./store/actionCreators.js&#x27;</span><br><span class="line">import &#123;useSelector, shallowEqual&#125; from &#x27;react-redux&#x27;</span><br><span class="line">//组件</span><br><span class="line">function HYRecommed(props) &#123;</span><br><span class="line">  //组件和redux关联：获取数据和进行操作</span><br><span class="line">  const &#123; topBanners &#125; = useSelector(state =&gt; (&#123; //直接对返回的数据进行结构</span><br><span class="line">    //参数1:传入一个回调函数，会将这个返回值赋值给useSelector，作为返回值</span><br><span class="line">    topBanners: state.recommend.topBanners</span><br><span class="line">  &#125;), shallowEqual); //参数2:将默认的===比较变成浅层比较</span><br><span class="line">  const dispatch = useDispatch();	//通过hooks直接获取dispatch</span><br><span class="line">  //发送网络请求</span><br><span class="line">  useEffect(() =&gt; &#123;</span><br><span class="line">    dispatch(getTopBannerAction());		//直接派发action</span><br><span class="line">  &#125;, [dispatch]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="项目相关"><a href="#项目相关" class="headerlink" title="项目相关"></a>项目相关</h3><h4 id="项目规范"><a href="#项目规范" class="headerlink" title="项目规范"></a>项目规范</h4><ol><li>文件夹、文件名统一小写，多个个单词以连接符（-）连接</li><li>JavaScript 变量名称采用小驼峰标识，常量全部使用大写字母，组件采用大驼峰(大写开头)</li><li>CSS 采用普通 CSS 和 styled-component 结合来编写（全局采用普通 CSS、局部采用 styled-component）</li><li>整个项目不再使用 class 组件，统一使用函数式组件，全面拥抱 Hooks</li><li>所有的函数式组件，为了避免不必要的渲染，全部使用 memo 进行包裹(rmc 快捷键)</li><li>组件内部的状态，使用 useState、useReducer；业务数据全部放在 redux 中管理</li><li>函数组件内部基本按照如下顺序编写代码<ul><li>组件内部 state 管理</li><li>redux 的 hooks 代码</li><li>其他组件 hooks 代码</li><li>其他逻辑代码</li><li>返回 JSX 代码</li></ul></li><li>redux 代码规范如下<ul><li>每个模块有自己独立的 reducer，通过 combineReducer 进行合并</li><li>异步请求代码使用 redux-thunk，并且写在 actionCreators 中</li><li>redux 直接采用 redux hooks 方式编写，不再使用 connect</li></ul></li><li>网络请求采用 axios<ul><li>对 axios 进行二次封装</li><li>所有的模块请求会放到一个请求文件中单独管理</li></ul></li><li>项目使用 AntDesign<ul><li>项目中某些 AntDesign 中的组件会被拿过来使用；</li><li>但是多部分组件还是自己进行编写</li></ul></li><li>其他规范在项目中根据实际情况决定和编写</li></ol><h4 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构"></a>目录结构</h4><ul><li>src<ul><li>assets -&gt; img、css、fonts 等文件夹</li><li>pages 一个个页面</li><li>components 可能在多个页面之间共享的组件</li><li>router 路由配置</li><li>store redux 相关代码，每个模块独立的 reducer 放在对应模块里面,在此处进行合并</li><li>services 网络相关服务，网络请求</li><li>utils 封装的工具相关的东西</li><li>common 放一些公共的东西，常量、数据之类（常量数据多可以分别放在两个文件夹 constants、data）</li><li>plugins 放一些插件之类的东西</li></ul></li></ul><h4 id="css-重置"><a href="#css-重置" class="headerlink" title="css 重置"></a>css 重置</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add normalize.css</span><br></pre></td></tr></table></figure><p>assets -&gt; css -&gt; reset.css(新建此 css 文件)</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;~normalize.css&#x27;</span>; <span class="comment">/*导入安装的css样式重置模块(导入模块的css使用~)*/</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;~antd/dist/antd.css&#x27;</span>; <span class="comment">/*导入antd样式库*/</span></span><br><span class="line"><span class="comment">/*下面再加上自己的样式重置的css代码，对上面的模块的有些样式进行覆盖*/</span></span><br><span class="line"><span class="comment">/*再加上一些全局样式(使用频率比较高的样式，文字只显示一行之类的)*/</span></span><br></pre></td></tr></table></figure><p>index.js</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./assets/css/reset.css&#x27;</span></span><br></pre></td></tr></table></figure><h4 id="项目配置别名"><a href="#项目配置别名" class="headerlink" title="项目配置别名"></a>项目配置别名</h4><p>安装：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add @craco/craco</span><br></pre></td></tr></table></figure><p>修改 package.json</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">  <span class="string">&quot;start&quot;</span>: <span class="string">&quot;craco start&quot;</span>,</span><br><span class="line">  <span class="string">&quot;build&quot;</span>: <span class="string">&quot;craco build&quot;</span>,</span><br><span class="line">  <span class="string">&quot;test&quot;</span>: <span class="string">&quot;craco test&quot;</span>,</span><br><span class="line">  <span class="string">&quot;eject&quot;</span>: <span class="string">&quot;react-scripts eject&quot;</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><p>根目录下新建文件 craco.config.js(与 package.json 同级)</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> resolve = <span class="function">(<span class="params">dir</span>) =&gt;</span> path.resolve(__dirname, dir)</span><br><span class="line"><span class="comment">//将项目的路径与传进的参数拼接到一起</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="attr">webpack</span>: &#123;</span><br><span class="line">    <span class="attr">alias</span>: &#123;</span><br><span class="line">      <span class="string">&#x27;@&#x27;</span>: resolve(<span class="string">&#x27;src&#x27;</span>),</span><br><span class="line">      <span class="attr">assets</span>: resolve(<span class="string">&#x27;src/assets&#x27;</span>),</span><br><span class="line">      <span class="attr">common</span>: resolve(<span class="string">&#x27;src/common&#x27;</span>),</span><br><span class="line">      <span class="attr">components</span>: resolve(<span class="string">&#x27;src/components&#x27;</span>),</span><br><span class="line">      <span class="attr">pages</span>: resolve(<span class="string">&#x27;src/pages&#x27;</span>),</span><br><span class="line">      <span class="attr">plugins</span>: resolve(<span class="string">&#x27;src/plugins&#x27;</span>),</span><br><span class="line">      <span class="attr">router</span>: resolve(<span class="string">&#x27;src/router&#x27;</span>),</span><br><span class="line">      <span class="attr">services</span>: resolve(<span class="string">&#x27;src/services&#x27;</span>),</span><br><span class="line">      <span class="attr">store</span>: resolve(<span class="string">&#x27;src/store&#x27;</span>),</span><br><span class="line">      <span class="attr">utils</span>: resolve(<span class="string">&#x27;src/utils&#x27;</span>),</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>重新运行项目</p><h4 id="导入文件顺序"><a href="#导入文件顺序" class="headerlink" title="导入文件顺序"></a>导入文件顺序</h4><ol><li>导入第三方库</li><li>导入工具类功能性东西</li><li>导入组件</li></ol><h4 id="APP-js"><a href="#APP-js" class="headerlink" title="APP.js"></a>APP.js</h4><p>安装路由和路由管理：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yarn add react-router-dom</span><br><span class="line">yarn add react-router-config</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;BrowserRouter&gt;</span><br><span class="line">	&lt;AppHeader /&gt;</span><br><span class="line">  &#123;renderRoutes(routes)&#125;	&#123;/*路由，其它地方写跳转页面的NavLink*/&#125;</span><br><span class="line">  &lt;AppFooter /&gt;</span><br><span class="line">&lt;/BrowserRouter&gt;</span><br></pre></td></tr></table></figure><h4 id="样式"><a href="#样式" class="headerlink" title="样式"></a>样式</h4><p>app-footer -&gt; index.js 、 style.js</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//style.js</span></span><br><span class="line"><span class="keyword">import</span> styled <span class="keyword">from</span> <span class="string">&#x27;styled-components&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> AppFooterWrapper = styled.div<span class="string">``</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> FooterLeft = styled.div<span class="string">``</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> FooterRight = styled.ul<span class="string">``</span></span><br><span class="line"><span class="comment">//可通less一样嵌套写</span></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">//index.js</span><br><span class="line">import React, &#123; memo, Fragment &#125; from &#x27;react&#x27;;</span><br><span class="line"></span><br><span class="line">import &#123; footerLinks, footerImages &#125; from &quot;@/common/local-data&quot;;</span><br><span class="line"></span><br><span class="line">import &#123; AppFooterWrapper, FooterLeft, FooterRight&#125; from &#x27;./style&#x27;;</span><br><span class="line"></span><br><span class="line">export default memo(function HYAppFooter() &#123;</span><br><span class="line">  return (</span><br><span class="line">  &lt;AppFooterWrapper&gt;</span><br><span class="line">    &lt;div className=&quot;wrap-v2 content&quot;&gt;</span><br><span class="line">      &lt;FooterLeft className=&quot;left&quot;&gt;</span><br><span class="line">      &lt;/FooterLeft&gt;</span><br><span class="line">      &lt;FooterRight className=&quot;right&quot;&gt;</span><br><span class="line">      &lt;/FooterRight&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/AppFooterWrapper&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="CSS-图片"><a href="#CSS-图片" class="headerlink" title="CSS 图片"></a>CSS 图片</h4><p>精灵图一般写在背景图片上</p><p>css 中使用图片</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">backgrounf-image: <span class="built_in">url</span>(<span class="string">$&#123;require(&quot;@/assets/img/aa.png&quot;</span>)&#125;);</span><br><span class="line"><span class="comment">/*引入图片必须使用require*/</span></span><br><span class="line"></span><br><span class="line">import bg <span class="selector-tag">from</span> &#x27;@/assets/img/admin_bg.jpg&#x27;;</span><br><span class="line"><span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">$&#123;bg&#125;</span>);</span><br></pre></td></tr></table></figure><p>react 中 a 标签里面如果没有内容会报警告</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href=&quot;#/&quot;&gt;aaa&lt;/a&gt;</span><br><span class="line"></span><br><span class="line">text-indent: -9999px;</span><br><span class="line">&#123;/*给a标签加个文字内容，再把text-indent调到很大*/&#125;</span><br></pre></td></tr></table></figure><h4 id="Redux-依赖"><a href="#Redux-依赖" class="headerlink" title="Redux 依赖"></a>Redux 依赖</h4><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn <span class="builtin-name">add</span> redux react-redux redux-thunk</span><br></pre></td></tr></table></figure><p>网络请求的数据全用 redux 管理(看情况)</p><p>每个模块的网络请求单独封装成一个 js 文件，放在 services(或 network)文件夹下</p><p>如果把函数作为参数传递到下一个组件，需要使用 useCallback(),可以对当前函数缓存、记忆</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">const bannerChange = useCallback((from, to) =&gt; &#123;</span><br><span class="line">&#125;, []);	//如果没有依赖写[]</span><br></pre></td></tr></table></figure><h4 id="v-html-展示-html"><a href="#v-html-展示-html" class="headerlink" title="v-html 展示 html"></a>v-html 展示 html</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;span dangerouslySetInnerHTML=&#123;&#123;__html: captchaSvg &#125;&#125;&gt;&lt;/span&gt;</span><br><span class="line">&#123;/*captchaSvg为html代码的字符串*/&#125;</span><br></pre></td></tr></table></figure><h4 id="项目打包发布"><a href="#项目打包发布" class="headerlink" title="项目打包发布"></a>项目打包发布</h4><p>打包</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn build</span><br></pre></td></tr></table></figure><h4 id="项目部署到云"><a href="#项目部署到云" class="headerlink" title="项目部署到云"></a>项目部署到云</h4><ol><li><p>服务器操作系统：centos</p></li><li><p>服务器中安装 Nginx 服务(可以借助 yum 工具来安装 Nginx)</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">安装nginx</span></span><br><span class="line">yum install nginx</span><br><span class="line"><span class="meta">#</span><span class="bash">在vscode中远程连接服务器，选择/etc/nginx文件夹</span></span><br><span class="line"><span class="meta">#</span><span class="bash">打开nginx.conf,对server进行配置</span></span><br><span class="line"><span class="meta">#</span><span class="bash">新建再conf.d文件下新建文件react.conf 后缀是.conf的文件会被nginx.conf自动包含进去</span></span><br><span class="line">server &#123;</span><br><span class="line">  listen 3000; #访问监听的端口</span><br><span class="line">  server_name  _;</span><br><span class="line"></span><br><span class="line">  location / &#123; #3000端口对应的访问路径</span><br><span class="line">    root /root/react/build;  #根目录下 root下的react文件夹下的build文件夹</span><br><span class="line">    index index.html; #访问build文件夹下的index.html</span><br><span class="line">    try_files $uri $uri/ /index.html;  #解决nginx代理刷新之后显示404的问题</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#</span><span class="bash">但是nginx默认是没有访问权限的，需要打开nginx.conf，将第五行的user nginx修改为：</span></span><br><span class="line">user root;</span><br><span class="line"><span class="meta">#</span><span class="bash">修改完配置文件后需要对nginx进行重启</span></span><br><span class="line">nginx -s reload</span><br><span class="line"><span class="meta">#</span><span class="bash">若重启报错，运行一下命令后再重启</span></span><br><span class="line">nginx -c /etc/nginx/nginx.conf</span><br></pre></td></tr></table></figure></li><li><p>配置 Nginx 代理(连接服务器的工具 FileZilla:<span class="exturl" data-url="aHR0cHM6Ly9maWxlemlsbGEtcHJvamVjdC5vcmcv">https://filezilla-project.org/<i class="fa fa-external-link-alt"></i></span>)</p><ul><li>设置 Nginx 权限为 root</li><li>可以将配置文件进行分离</li><li>单独配置 conf.d 文件夹下的配置文件</li></ul></li><li><p>在服务器端安全组配置中增加 3000 端口，使其他地方能够访问</p></li></ol><h4 id="需要安装的依赖"><a href="#需要安装的依赖" class="headerlink" title="需要安装的依赖"></a>需要安装的依赖</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">yarn add normalize.css	#样式重置</span><br><span class="line">yarn add @craco/craco		#配置文件路径别名</span><br><span class="line">yarn add react-router-dom #路由</span><br><span class="line">yarn add react-router-config #统一管理路由,renderRoutes依赖</span><br><span class="line">yarn add styled-components	#使用css in js，编写组件外部使用css Wrapper包裹，避免样式冲突</span><br><span class="line">yarn add antd #安装antd-design库</span><br><span class="line">yarn add @ant-design/icons #ant图标库</span><br><span class="line">yarn add axios #网络请求</span><br><span class="line">yarn add redux	#redux</span><br><span class="line">yarn add react-redux #把react组件和redux结合起来(connect,Provider)</span><br><span class="line">yarn add redux-thunk #redux异步请求</span><br><span class="line">yarn add redux react-redux redux-thunk	#合并安装</span><br><span class="line">yarn add immutable	#immutable依赖，结合redux使用，优化性能</span><br><span class="line">yarn add redux-immutable #合并reducer时使用immutable进行性能优化</span><br><span class="line">yarn add @tinymce/tinymce-react; #安装富文本框tiny-mce</span><br></pre></td></tr></table></figure><h4 id="富文本框-tiny-mce"><a href="#富文本框-tiny-mce" class="headerlink" title="富文本框 tiny-mce"></a>富文本框 tiny-mce</h4><p>安装：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add @tinymce/tinymce-react;</span><br></pre></td></tr></table></figure><p>使用：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; memo &#125; from &#x27;react&#x27;</span><br><span class="line"></span><br><span class="line">import &#123;Editor&#125; from &#x27;@tinymce/tinymce-react&#x27;;</span><br><span class="line"></span><br><span class="line">import &#123;uploadTemp&#125; from &#x27;./network/upload&#x27;;</span><br><span class="line">export default memo(function RichText() &#123;</span><br><span class="line">  const  editorObj = &#123;</span><br><span class="line">    height: &#x27;300px&#x27;,</span><br><span class="line">    language: &#x27;zh_CN&#x27;,</span><br><span class="line">    statusbar: false, //隐藏底部状态栏</span><br><span class="line">    plugins: &#x27;table lists link image preview&#x27;,</span><br><span class="line">    toolbar: `formatselect | code | preview | bold italic strikethrough forecolor backcolor |</span><br><span class="line">    link image | alignleft | aligncenter alignright alignjustify |</span><br><span class="line">    numlist bullist outdent indent`,</span><br><span class="line">    relative_urls: false,</span><br><span class="line">    file_picker_types: &#x27;image&#x27;, //上传文件的类型</span><br><span class="line">    image_advtab: true,</span><br><span class="line">    image_uploadtable: true,</span><br><span class="line">    images_upload_handler: (blobInfo, success, failure) =&gt; &#123; //自定义上传处理逻辑。使用该配置，则无需使用其他上传配置选项</span><br><span class="line">      let formData = new FormData();</span><br><span class="line">      const file = blobInfo.blob(); //转为为易于理解的file对象</span><br><span class="line">      formData.append(&#x27;temp&#x27;, file, file.name);</span><br><span class="line">      uploadTemp(formData).then(res =&gt; &#123; //上传图片</span><br><span class="line">        if(res.response)</span><br><span class="line">          return console.log(res.response.data);</span><br><span class="line">        console.log(res);</span><br><span class="line">        success(res.url); //里面放服务器展示的图片地址</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  function handleEditorChange(values) &#123; //获取富文本内容</span><br><span class="line">    console.log(values);</span><br><span class="line">  &#125;</span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;Editor</span><br><span class="line">      apiKey=&quot;diu0gi0p919zw5c2c0bqlx888evf52vnjcnkxyhcty0b90l3&quot; //注册账户以申请</span><br><span class="line">        init=&#123;&#123;...editorObj&#125;&#125; //初始化配置</span><br><span class="line">        onEditorChange=&#123;handleEditorChange&#125; //富文本框内容改变时调用</span><br><span class="line">      /&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="React-SSR-开发"><a href="#React-SSR-开发" class="headerlink" title="React SSR 开发"></a>React SSR 开发</h3><p><strong>SSR</strong>(Server Side Rendering，服务端渲染):指的是页面在服务器端已经生成了完成的 HTML 页面结构，不需要浏览器解析</p><p>同构应用：一套代码既可以在服务端运行又可以在客户端运行</p><p>同构是一种 SSR 的形态，是现代 SSR 的一种表现形式。当用户发出请求时，先在服务器通过 SSR 渲染出首页的内容。但是对应的代码同样可以在客户端被执行。执行的目的包括事件绑定等以及其他页面切换时也可以在客户端被渲染</p><p>使用成熟的 SSR 框架：Next.js(vue 里面是 Nuxt.js)</p><h4 id="安装-Next-js-框架的脚手架："><a href="#安装-Next-js-框架的脚手架：" class="headerlink" title="安装 Next.js 框架的脚手架："></a>安装 Next.js 框架的脚手架：</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install -g create-next-app</span><br><span class="line">create-next-app --version	#查看版本号</span><br></pre></td></tr></table></figure><h4 id="创建-Next-js-项目"><a href="#创建-Next-js-项目" class="headerlink" title="创建 Next.js 项目"></a>创建 Next.js 项目</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create-next-app next-demo</span><br></pre></td></tr></table></figure><p>pages 文件夹下一个 js 文件对应一个页面，next 会自动配置路由(路径为文件名)</p><h4 id="跳转页面渲染模式"><a href="#跳转页面渲染模式" class="headerlink" title="跳转页面渲染模式"></a>跳转页面渲染模式</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">import Link from &#x27;next/link&#x27;</span><br><span class="line">&lt;h2&gt;&lt;a href=&quot;/about&quot;&gt;关于页面&lt;/a&gt;&lt;/h2&gt;&#123;/* 服务端渲染 */&#125;</span><br><span class="line">&lt;h2&gt;&lt;Link href=&quot;/about&quot;&gt;关于页面&lt;/Link&gt;&lt;/h2&gt;&#123;/* 前端渲染 */&#125;</span><br></pre></td></tr></table></figure><h4 id="Layout-组件"><a href="#Layout-组件" class="headerlink" title="Layout 组件"></a>Layout 组件</h4><p>设置页面标题</p><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Head from <span class="string">&#x27;next/head&#x27;</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">Head</span>&gt;</span></span></span><br><span class="line"><span class="xml">	</span><span class="xml"><span class="tag">&lt;<span class="name">title</span>&gt;</span>网易云音乐<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">Head</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>设置公共布局方法 1：</p><p>新建 components -&gt; app-layout -&gt; index.js</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; memo &#125; from &quot;react&quot;;</span><br><span class="line">import Head from &quot;next/head&quot;;</span><br><span class="line">import Link from &#x27;next/link&#x27;</span><br><span class="line">export default memo(function AppLayout(props) &#123;</span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;Head&gt;</span><br><span class="line">        &lt;title&gt;网易云音乐&lt;/title&gt;</span><br><span class="line">      &lt;/Head&gt;</span><br><span class="line"></span><br><span class="line">      &lt;header&gt;</span><br><span class="line">        网页公共头部</span><br><span class="line">        &lt;hr /&gt;</span><br><span class="line">      &lt;/header&gt;</span><br><span class="line"></span><br><span class="line">      &#123;props.children&#125;</span><br><span class="line"></span><br><span class="line">      &lt;footer&gt;</span><br><span class="line">        网页公共尾部</span><br><span class="line">      &lt;/footer&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">//其它页面使用</span><br><span class="line">import AppLayout from &#x27;../components/app-layout&#x27;</span><br><span class="line">export default function Home() &#123;</span><br><span class="line">  return (</span><br><span class="line">    &lt;AppLayout&gt;</span><br><span class="line">      &lt;h1&gt;Home页面自己的数据&lt;/h1&gt;</span><br><span class="line">    &lt;/AppLayout&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>设置公共布局方法 2：</p><p>pages -&gt; 重写_app.js</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">import &quot;../styles/globals.css&quot;;</span><br><span class="line">import Head from &quot;next/head&quot;;</span><br><span class="line">function MyApp(&#123; Component, pageProps &#125;) &#123;</span><br><span class="line">  return (</span><br><span class="line">    &lt;&gt;</span><br><span class="line">      &lt;Head&gt;</span><br><span class="line">        &lt;title&gt;网易云音乐&lt;/title&gt;</span><br><span class="line">      &lt;/Head&gt;</span><br><span class="line"></span><br><span class="line">      &lt;header&gt;</span><br><span class="line">        网页公共头部</span><br><span class="line">      &lt;/header&gt;</span><br><span class="line"></span><br><span class="line">      &lt;Component &#123;...pageProps&#125; /&gt;</span><br><span class="line"></span><br><span class="line">      &lt;footer&gt;</span><br><span class="line">        网页公共尾部</span><br><span class="line">      &lt;/footer&gt;</span><br><span class="line">    &lt;/&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line">export default MyApp;</span><br></pre></td></tr></table></figure><p>改变整个文档相关内容： pages -&gt; 重写_document.js</p><p><span class="exturl" data-url="aHR0cHM6Ly93d3cubmV4dGpzLmNuL2RvY3MvYWR2YW5jZWQtZmVhdHVyZXMvY3VzdG9tLWRvY3VtZW50">https://www.nextjs.cn/docs/advanced-features/custom-document<i class="fa fa-external-link-alt"></i></span></p><h4 id="样式-1"><a href="#样式-1" class="headerlink" title="样式"></a>样式</h4><p>建议使用 styled-components</p><p>安装：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add styled-components</span><br></pre></td></tr></table></figure><p>使用 styled-components 需要配置一下：</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn <span class="keyword">add </span>-D <span class="keyword">babel-plugin-styled-components </span><span class="comment">#开发时依赖</span></span><br></pre></td></tr></table></figure><p>项目根目录下新建文件.babelrc</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;presets&quot;</span>: [<span class="string">&quot;next/babel&quot;</span>],</span><br><span class="line">  <span class="attr">&quot;plugins&quot;</span>: [[<span class="string">&quot;styled-components&quot;</span>]]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="路由嵌套-1"><a href="#路由嵌套-1" class="headerlink" title="路由嵌套"></a>路由嵌套</h4><p>路由嵌套靠文件路径</p><p>pages:</p><ul><li>profile<ul><li>index.js</li><li>info<ul><li>index.js</li></ul></li><li>settings<ul><li>indes.js</li></ul></li></ul></li></ul><h4 id="路由传参"><a href="#路由传参" class="headerlink" title="路由传参"></a>路由传参</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;Link href=&#123;`/about?id=$&#123;id&#125;`&#125;&gt;	&#123;/*目前只能使用此种方式传参*/&#125;</span><br><span class="line">	关于</span><br><span class="line">&lt;/Link&gt;</span><br><span class="line"></span><br><span class="line">//其它页面取参数</span><br><span class="line">import &#123; useRouter &#125; from &#x27;next/router&#x27;</span><br><span class="line"></span><br><span class="line">const router = useRouter();</span><br><span class="line">console.log(router.query.id);</span><br></pre></td></tr></table></figure><p>代码跳转路由</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">import Router from &#x27;next/router&#x27;</span><br><span class="line">Router.push(&#123;</span><br><span class="line">  pathname: &quot;/about&quot;,</span><br><span class="line">  query: &#123;</span><br><span class="line">    id: id</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="网络请求"><a href="#网络请求" class="headerlink" title="网络请求"></a>网络请求</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">function Home(props)&#123;</span><br><span class="line">  const &#123;name, banners&#125; = props;</span><br><span class="line">&#125;</span><br><span class="line">Home.getInitialProps = async (props) =&gt; &#123;	//组件第一次渲染的时候先执行此函数</span><br><span class="line">  //async返回的实质上是一个Promise</span><br><span class="line">  const res = await axios(&#123;url: &quot;...&quot;&#125;);</span><br><span class="line">  return &#123;	//返回的这个对象最终回到组件的props里面</span><br><span class="line">    name: &quot;why&quot;,</span><br><span class="line">    banners: res.data.data.banner.list</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">export default Home;</span><br></pre></td></tr></table></figure></div><div class="reward-container"><div>如果觉得文章有帮助，就请吃个雪糕吧~</div><button onclick='var qr=document.getElementById("qr");qr.style.display="none"===qr.style.display?"block":"none"'>打赏</button><div id="qr" style="display:none"><div style="display:inline-block"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="/images/wechatpay.png" alt="很帅很愁人~ 微信支付"><p>微信支付</p></div></div></div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者： </strong>很帅很愁人~</li><li class="post-copyright-link"><strong>本文链接：</strong> <a href="https://blog.wy1991.cn/20220315/185-%E9%87%8D%E5%AD%A6react/" title="185-重学react">https://blog.wy1991.cn/20220315/185-重学react/</a></li><li class="post-copyright-license"><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC8="><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li><li class="post-copyright-license"><strong>联系方式： </strong>如文章有错误，请联系qq：598204996 谢谢~</li></ul></div><footer class="post-footer"><div class="post-tags"><a href="/tags/react/" rel="tag"># react</a></div><div class="post-nav"><div class="post-nav-item"><a href="/20220315/184-%E9%87%8D%E5%AD%A6ts/" rel="prev" title="184-重学ts"><i class="fa fa-chevron-left"></i> 184-重学ts</a></div><div class="post-nav-item"><a href="/20220315/186-nodejs/" rel="next" title="186-nodejs">186-nodejs <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><script>window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc">文章目录</li><li class="sidebar-nav-overview">站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AE%A4%E8%AF%86-JSX"><span class="nav-number">1.</span> <span class="nav-text">认识 JSX</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#jsx-%E4%B8%AD%E7%9A%84%E6%B3%A8%E9%87%8A"><span class="nav-number">1.1.</span> <span class="nav-text">jsx 中的注释</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#jsx-%E4%B8%AD%E5%B5%8C%E5%85%A5%E5%8F%98%E9%87%8F"><span class="nav-number">1.2.</span> <span class="nav-text">jsx 中嵌入变量</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#jsx-%E4%B8%AD%E5%B5%8C%E5%85%A5%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="nav-number">1.3.</span> <span class="nav-text">jsx 中嵌入表达式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#jsx-%E7%BB%91%E5%AE%9A%E5%B1%9E%E6%80%A7"><span class="nav-number">1.4.</span> <span class="nav-text">jsx 绑定属性</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#jsx-%E4%BA%8B%E4%BB%B6%E7%BB%91%E5%AE%9A%E5%92%8C-this-%E5%A4%84%E7%90%86"><span class="nav-number">1.5.</span> <span class="nav-text">jsx 事件绑定和 this 处理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#jsx-%E4%BA%8B%E4%BB%B6%E7%BB%91%E5%AE%9A-%E4%BC%A0%E9%80%92%E5%8F%82%E6%95%B0"><span class="nav-number">1.6.</span> <span class="nav-text">jsx 事件绑定-传递参数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9D%A1%E4%BB%B6%E6%B8%B2%E6%9F%93"><span class="nav-number">1.7.</span> <span class="nav-text">条件渲染</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%97%E8%A1%A8%E6%B8%B2%E6%9F%93"><span class="nav-number">1.8.</span> <span class="nav-text">列表渲染</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#React-%E8%84%9A%E6%89%8B%E6%9E%B6"><span class="nav-number">2.</span> <span class="nav-text">React 脚手架</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#React-%E7%BB%84%E4%BB%B6%E5%8C%96%E5%BC%80%E5%8F%91"><span class="nav-number">3.</span> <span class="nav-text">React 组件化开发</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%B1%BB%E7%BB%84%E4%BB%B6%E5%AE%9A%E4%B9%89%E8%A6%81%E6%B1%82"><span class="nav-number">3.1.</span> <span class="nav-text">类组件定义要求</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%B1%BB%E7%BB%84%E4%BB%B6"><span class="nav-number">3.2.</span> <span class="nav-text">类组件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%87%BD%E6%95%B0%E7%BB%84%E4%BB%B6"><span class="nav-number">3.3.</span> <span class="nav-text">函数组件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#render-%E5%87%BD%E6%95%B0%E7%9A%84%E8%BF%94%E5%9B%9E%E5%80%BC"><span class="nav-number">3.4.</span> <span class="nav-text">render 函数的返回值</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="nav-number">3.5.</span> <span class="nav-text">生命周期</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%84%E4%BB%B6%E7%9A%84%E5%B5%8C%E5%A5%97"><span class="nav-number">3.6.</span> <span class="nav-text">组件的嵌套</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%84%E4%BB%B6%E9%97%B4%E7%9A%84%E9%80%9A%E4%BF%A1-props"><span class="nav-number">3.7.</span> <span class="nav-text">组件间的通信(props)</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%88%B6%E4%BC%A0%E5%AD%90"><span class="nav-number">3.7.1.</span> <span class="nav-text">父传子</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AD%90%E4%BC%A0%E7%88%B6"><span class="nav-number">3.7.2.</span> <span class="nav-text">子传父</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#React-%E5%AE%9E%E7%8E%B0-slot"><span class="nav-number">3.7.3.</span> <span class="nav-text">React 实现 slot</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%B7%A8%E7%BB%84%E4%BB%B6%E9%80%9A%E4%BF%A1"><span class="nav-number">3.7.4.</span> <span class="nav-text">跨组件通信</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#setState"><span class="nav-number">3.8.</span> <span class="nav-text">setState</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#key-%E7%9A%84%E4%BC%98%E5%8C%96"><span class="nav-number">3.9.</span> <span class="nav-text">key 的优化</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%84%E4%BB%B6%E5%B5%8C%E5%A5%97%E7%9A%84-render-%E8%B0%83%E7%94%A8"><span class="nav-number">3.10.</span> <span class="nav-text">组件嵌套的 render 调用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A1%A5%E5%85%85"><span class="nav-number">3.11.</span> <span class="nav-text">补充</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%A8%E5%B1%80%E4%BA%8B%E4%BB%B6%E4%BC%A0%E9%80%92"><span class="nav-number">3.12.</span> <span class="nav-text">全局事件传递</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#refs"><span class="nav-number">3.13.</span> <span class="nav-text">refs</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%97%E6%8E%A7%E7%BB%84%E4%BB%B6"><span class="nav-number">3.14.</span> <span class="nav-text">受控组件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9D%9E%E5%8F%97%E6%8E%A7%E7%BB%84%E4%BB%B6"><span class="nav-number">3.15.</span> <span class="nav-text">非受控组件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%AB%98%E9%98%B6%E7%BB%84%E4%BB%B6-HOC"><span class="nav-number">3.16.</span> <span class="nav-text">高阶组件 HOC</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ref-%E7%9A%84%E8%BD%AC%E5%8F%91"><span class="nav-number">3.17.</span> <span class="nav-text">ref 的转发</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Portals-%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-number">3.18.</span> <span class="nav-text">Portals 的使用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#fragment"><span class="nav-number">3.19.</span> <span class="nav-text">fragment</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#StrictMode-%E4%B8%A5%E6%A0%BC%E6%A8%A1%E5%BC%8F"><span class="nav-number">3.20.</span> <span class="nav-text">StrictMode 严格模式</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#React-%E4%B8%AD%E7%9A%84%E6%A0%B7%E5%BC%8F"><span class="nav-number">4.</span> <span class="nav-text">React 中的样式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%86%85%E8%81%94%E6%A0%B7%E5%BC%8F"><span class="nav-number">4.1.</span> <span class="nav-text">内联样式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%99%AE%E9%80%9A-css"><span class="nav-number">4.2.</span> <span class="nav-text">普通 css</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#css-modules"><span class="nav-number">4.3.</span> <span class="nav-text">css modules</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#css-in-js"><span class="nav-number">4.4.</span> <span class="nav-text">css in js</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#AntDesign-UI-%E7%BB%84%E4%BB%B6%E5%BA%93"><span class="nav-number">5.</span> <span class="nav-text">AntDesign UI 组件库</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#classnames"><span class="nav-number">5.1.</span> <span class="nav-text">classnames</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#AntDesign-%E5%85%BC%E5%AE%B9%E6%80%A7"><span class="nav-number">5.2.</span> <span class="nav-text">AntDesign 兼容性</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%89%E8%A3%85"><span class="nav-number">5.3.</span> <span class="nav-text">安装</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%84%E4%BB%B6%E6%98%BE%E7%A4%BA%E4%B8%AD%E6%96%87"><span class="nav-number">5.4.</span> <span class="nav-text">组件显示中文</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#AntDesign-%E5%9B%BE%E6%A0%87"><span class="nav-number">5.5.</span> <span class="nav-text">AntDesign 图标</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#moment-%E5%BA%93"><span class="nav-number">5.6.</span> <span class="nav-text">moment 库</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#craco"><span class="nav-number">5.7.</span> <span class="nav-text">craco</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#axios-%E5%BA%93%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-number">6.</span> <span class="nav-text">axios 库的使用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%89%E8%A3%85-1"><span class="nav-number">6.1.</span> <span class="nav-text">安装</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AF%BC%E5%85%A5"><span class="nav-number">6.2.</span> <span class="nav-text">导入</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B5%8B%E8%AF%95%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82%E7%9A%84%E7%BD%91%E7%AB%99%EF%BC%9A"><span class="nav-number">6.3.</span> <span class="nav-text">测试网络请求的网站：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#axios-%E5%8F%91%E9%80%81%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82"><span class="nav-number">6.4.</span> <span class="nav-text">axios 发送网络请求</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E7%94%A8-await-%E5%92%8C-async-%E5%8F%91%E9%80%81%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82"><span class="nav-number">6.5.</span> <span class="nav-text">使用用 await 和 async 发送网络请求</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#axios-all%EF%BC%9A%E5%90%88%E5%B9%B6%E5%A4%9A%E4%B8%AA%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82"><span class="nav-number">6.6.</span> <span class="nav-text">axios.all：合并多个网络请求</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%BB%98%E8%AE%A4%E9%85%8D%E7%BD%AE"><span class="nav-number">6.7.</span> <span class="nav-text">默认配置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E6%96%B0%E7%9A%84%E5%AE%9E%E4%BE%8B"><span class="nav-number">6.8.</span> <span class="nav-text">创建新的实例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#axios-%E6%8B%A6%E6%88%AA%E5%99%A8"><span class="nav-number">6.9.</span> <span class="nav-text">axios 拦截器</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BA%8C%E6%AC%A1%E5%B0%81%E8%A3%85"><span class="nav-number">6.10.</span> <span class="nav-text">二次封装</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#React-%E8%BF%87%E6%B8%A1%E5%8A%A8%E7%94%BB"><span class="nav-number">7.</span> <span class="nav-text">React 过渡动画</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%89%E8%A3%85-2"><span class="nav-number">7.1.</span> <span class="nav-text">安装</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8C%85%E5%90%AB%E5%9B%9B%E4%B8%AA%E7%BB%84%E4%BB%B6"><span class="nav-number">7.2.</span> <span class="nav-text">包含四个组件</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Redux"><span class="nav-number">8.</span> <span class="nav-text">Redux</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#JS-%E7%BA%AF%E5%87%BD%E6%95%B0"><span class="nav-number">8.1.</span> <span class="nav-text">JS 纯函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%B8%E5%BF%83%E7%90%86%E5%BF%B5"><span class="nav-number">8.2.</span> <span class="nav-text">核心理念</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%89%E5%A4%A7%E5%8E%9F%E5%88%99"><span class="nav-number">8.3.</span> <span class="nav-text">三大原则</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="nav-number">8.4.</span> <span class="nav-text">基本使用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%8E-React-%E9%A1%B9%E7%9B%AE%E7%BB%93%E5%90%88%E4%BD%BF%E7%94%A8"><span class="nav-number">8.5.</span> <span class="nav-text">与 React 项目结合使用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%9D%E6%AD%A5%E5%B0%81%E8%A3%85%EF%BC%9Aconnect%F0%9F%94%96"><span class="nav-number">8.6.</span> <span class="nav-text">初步封装：connect🔖</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8-context-%E4%BA%8C%E6%AC%A1%E5%B0%81%E8%A3%85"><span class="nav-number">8.7.</span> <span class="nav-text">使用 context 二次封装</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#react-redux"><span class="nav-number">8.8.</span> <span class="nav-text">react-redux</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%84%E4%BB%B6%E4%B8%AD%E5%BC%82%E6%AD%A5%E6%93%8D%E4%BD%9C-redux-thunk"><span class="nav-number">8.9.</span> <span class="nav-text">组件中异步操作 redux-thunk</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#redux-devtools"><span class="nav-number">8.10.</span> <span class="nav-text">redux-devtools</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A1%A5%E5%85%85%EF%BC%9AES6-%E4%B8%AD-generator-%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-number">8.11.</span> <span class="nav-text">补充：ES6 中 generator 的使用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#redux-saga"><span class="nav-number">8.12.</span> <span class="nav-text">redux-saga</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#reducer-%E6%8B%86%E5%88%86"><span class="nav-number">8.13.</span> <span class="nav-text">reducer 拆分</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#React-%E4%B8%AD-state-%E7%AE%A1%E7%90%86"><span class="nav-number">8.14.</span> <span class="nav-text">React 中 state 管理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8D%95%E5%90%91%E6%95%B0%E6%8D%AE%E6%B5%81"><span class="nav-number">8.15.</span> <span class="nav-text">单向数据流</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ImmutableJS"><span class="nav-number">8.16.</span> <span class="nav-text">ImmutableJS</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%8E-hooks-%E7%BB%93%E5%90%88"><span class="nav-number">8.17.</span> <span class="nav-text">与 hooks 结合</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ImmutableJS-%E4%BC%98%E5%8C%96%E6%80%A7%E8%83%BD"><span class="nav-number">8.18.</span> <span class="nav-text">ImmutableJS 优化性能</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E6%8C%81%E4%B9%85%E5%8C%96"><span class="nav-number">8.19.</span> <span class="nav-text">数据持久化</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Router"><span class="nav-number">9.</span> <span class="nav-text">Router</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%89%E8%A3%85-3"><span class="nav-number">9.1.</span> <span class="nav-text">安装</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8-1"><span class="nav-number">9.2.</span> <span class="nav-text">基本使用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#NavLink%E3%80%81Route-%E8%A1%A5%E5%85%85"><span class="nav-number">9.3.</span> <span class="nav-text">NavLink、Route 补充</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Redirect"><span class="nav-number">9.4.</span> <span class="nav-text">Redirect</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%B7%AF%E7%94%B1%E5%B5%8C%E5%A5%97"><span class="nav-number">9.5.</span> <span class="nav-text">路由嵌套</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%89%8B%E5%8A%A8%E8%B7%AF%E7%94%B1%E8%B7%B3%E8%BD%AC"><span class="nav-number">9.6.</span> <span class="nav-text">手动路由跳转</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%82%E6%95%B0%E4%BC%A0%E9%80%92"><span class="nav-number">9.7.</span> <span class="nav-text">参数传递</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%9F%E4%B8%80%E7%AE%A1%E7%90%86%E8%B7%AF%E7%94%B1%E6%98%A0%E5%B0%84%E5%85%B3%E7%B3%BB"><span class="nav-number">9.8.</span> <span class="nav-text">统一管理路由映射关系</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%87%92%E5%8A%A0%E8%BD%BD"><span class="nav-number">9.9.</span> <span class="nav-text">懒加载</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Hooks"><span class="nav-number">10.</span> <span class="nav-text">Hooks</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%93%E9%AA%8C-useState"><span class="nav-number">10.1.</span> <span class="nav-text">体验 useState</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8-hook-%E4%B8%A4%E4%B8%AA%E9%A2%9D%E5%A4%96%E7%9A%84%E5%8E%9F%E5%88%99"><span class="nav-number">10.2.</span> <span class="nav-text">使用 hook 两个额外的原则</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E5%A4%9A%E4%B8%AA%E7%8A%B6%E6%80%81"><span class="nav-number">10.3.</span> <span class="nav-text">使用多个状态</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E5%A4%8D%E6%9D%82%E7%8A%B6%E6%80%81"><span class="nav-number">10.4.</span> <span class="nav-text">修改复杂状态</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#useEffect"><span class="nav-number">10.5.</span> <span class="nav-text">useEffect</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#useContext"><span class="nav-number">10.6.</span> <span class="nav-text">useContext</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#useReducer"><span class="nav-number">10.7.</span> <span class="nav-text">useReducer</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#useCallback"><span class="nav-number">10.8.</span> <span class="nav-text">useCallback</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#useMemo"><span class="nav-number">10.9.</span> <span class="nav-text">useMemo</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#useRef"><span class="nav-number">10.10.</span> <span class="nav-text">useRef</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#useImperativeHandle"><span class="nav-number">10.11.</span> <span class="nav-text">useImperativeHandle</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#useLayoutEffect"><span class="nav-number">10.12.</span> <span class="nav-text">useLayoutEffect</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89-Hook"><span class="nav-number">10.13.</span> <span class="nav-text">自定义 Hook</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#useSelector"><span class="nav-number">10.14.</span> <span class="nav-text">useSelector</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A1%B9%E7%9B%AE%E7%9B%B8%E5%85%B3"><span class="nav-number">11.</span> <span class="nav-text">项目相关</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%A1%B9%E7%9B%AE%E8%A7%84%E8%8C%83"><span class="nav-number">11.1.</span> <span class="nav-text">项目规范</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84"><span class="nav-number">11.2.</span> <span class="nav-text">目录结构</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#css-%E9%87%8D%E7%BD%AE"><span class="nav-number">11.3.</span> <span class="nav-text">css 重置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%A1%B9%E7%9B%AE%E9%85%8D%E7%BD%AE%E5%88%AB%E5%90%8D"><span class="nav-number">11.4.</span> <span class="nav-text">项目配置别名</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AF%BC%E5%85%A5%E6%96%87%E4%BB%B6%E9%A1%BA%E5%BA%8F"><span class="nav-number">11.5.</span> <span class="nav-text">导入文件顺序</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#APP-js"><span class="nav-number">11.6.</span> <span class="nav-text">APP.js</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%B7%E5%BC%8F"><span class="nav-number">11.7.</span> <span class="nav-text">样式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CSS-%E5%9B%BE%E7%89%87"><span class="nav-number">11.8.</span> <span class="nav-text">CSS 图片</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Redux-%E4%BE%9D%E8%B5%96"><span class="nav-number">11.9.</span> <span class="nav-text">Redux 依赖</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#v-html-%E5%B1%95%E7%A4%BA-html"><span class="nav-number">11.10.</span> <span class="nav-text">v-html 展示 html</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%A1%B9%E7%9B%AE%E6%89%93%E5%8C%85%E5%8F%91%E5%B8%83"><span class="nav-number">11.11.</span> <span class="nav-text">项目打包发布</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%A1%B9%E7%9B%AE%E9%83%A8%E7%BD%B2%E5%88%B0%E4%BA%91"><span class="nav-number">11.12.</span> <span class="nav-text">项目部署到云</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9C%80%E8%A6%81%E5%AE%89%E8%A3%85%E7%9A%84%E4%BE%9D%E8%B5%96"><span class="nav-number">11.13.</span> <span class="nav-text">需要安装的依赖</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AF%8C%E6%96%87%E6%9C%AC%E6%A1%86-tiny-mce"><span class="nav-number">11.14.</span> <span class="nav-text">富文本框 tiny-mce</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#React-SSR-%E5%BC%80%E5%8F%91"><span class="nav-number">12.</span> <span class="nav-text">React SSR 开发</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%89%E8%A3%85-Next-js-%E6%A1%86%E6%9E%B6%E7%9A%84%E8%84%9A%E6%89%8B%E6%9E%B6%EF%BC%9A"><span class="nav-number">12.1.</span> <span class="nav-text">安装 Next.js 框架的脚手架：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA-Next-js-%E9%A1%B9%E7%9B%AE"><span class="nav-number">12.2.</span> <span class="nav-text">创建 Next.js 项目</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%B7%B3%E8%BD%AC%E9%A1%B5%E9%9D%A2%E6%B8%B2%E6%9F%93%E6%A8%A1%E5%BC%8F"><span class="nav-number">12.3.</span> <span class="nav-text">跳转页面渲染模式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Layout-%E7%BB%84%E4%BB%B6"><span class="nav-number">12.4.</span> <span class="nav-text">Layout 组件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%B7%E5%BC%8F-1"><span class="nav-number">12.5.</span> <span class="nav-text">样式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%B7%AF%E7%94%B1%E5%B5%8C%E5%A5%97-1"><span class="nav-number">12.6.</span> <span class="nav-text">路由嵌套</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%B7%AF%E7%94%B1%E4%BC%A0%E5%8F%82"><span class="nav-number">12.7.</span> <span class="nav-text">路由传参</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82"><span class="nav-number">12.8.</span> <span class="nav-text">网络请求</span></a></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="很帅很愁人~" src="/images/my.jpg"><p class="site-author-name" itemprop="name">很帅很愁人~</p><div class="site-description" itemprop="description">梦是一种欲望, 想是一种行动。梦想是梦与想的结晶，加油打工人~~</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">198</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">46</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">115</span> <span class="site-state-item-name">标签</span></a></div></nav></div></div><script type="text/javascript" charset="utf-8" src="/js/tagcloud.js"></script><script type="text/javascript" charset="utf-8" src="/js/tagcanvas.js"></script><div class="widget-wrap"><div id="myCanvasContainer" class="widget tagcloud"><canvas width="250" height="250" id="resCanvas"><ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/ArryaBuffer/" rel="tag">ArryaBuffer</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MarkDown/" rel="tag">MarkDown</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Promise/" rel="tag">Promise</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Recorder/" rel="tag">Recorder</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TS/" rel="tag">TS</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/UDP/" rel="tag">UDP</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/V8/" rel="tag">V8</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Vue/" rel="tag">Vue</a><span class="tag-list-count">23</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/VueRouter/" rel="tag">VueRouter</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Vuex/" rel="tag">Vuex</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WebStorage/" rel="tag">WebStorage</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/api%E9%9B%86%E4%B8%AD%E7%AE%A1%E7%90%86/" rel="tag">api集中管理</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/apply/" rel="tag">apply</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/axios/" rel="tag">axios</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/bind/" rel="tag">bind</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/call/" rel="tag">call</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cli/" rel="tag">cli</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cors/" rel="tag">cors</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/css/" rel="tag">css</a><span class="tag-list-count">19</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/css3/" rel="tag">css3</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/drag/" rel="tag">drag</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ejsexcel/" rel="tag">ejsexcel</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/electron/" rel="tag">electron</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/element/" rel="tag">element</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/es6/" rel="tag">es6</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/excel%E5%AF%BC%E5%87%BA/" rel="tag">excel导出</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/filter/" rel="tag">filter</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/flex/" rel="tag">flex</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/getters/" rel="tag">getters</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/" rel="tag">git</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/github/" rel="tag">github</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/grid/" rel="tag">grid</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/host/" rel="tag">host</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/html/" rel="tag">html</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/html5/" rel="tag">html5</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jenkins/" rel="tag">jenkins</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js/" rel="tag">js</a><span class="tag-list-count">74</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/" rel="tag">js基础语法</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js%E6%93%8D%E4%BD%9C%E7%AC%A6/" rel="tag">js操作符</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lottie/" rel="tag">lottie</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/media/" rel="tag">media</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/messageChannel/" rel="tag">messageChannel</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/miniVue/" rel="tag">miniVue</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mitt/" rel="tag">mitt</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mock/" rel="tag">mock</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nextTick/" rel="tag">nextTick</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/node/" rel="tag">node</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nodejs/" rel="tag">nodejs</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/npm/" rel="tag">npm</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/print/" rel="tag">print</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/promise/" rel="tag">promise</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/react/" rel="tag">react</a><span class="tag-list-count">25</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/recorder/" rel="tag">recorder</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ref/" rel="tag">ref</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rem/" rel="tag">rem</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/require-context/" rel="tag">require.context</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/reuqest/" rel="tag">reuqest</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/router/" rel="tag">router</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/scss/" rel="tag">scss</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sessionStorage/" rel="tag">sessionStorage</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/slot/" rel="tag">slot</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/stackoverflow/" rel="tag">stackoverflow</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tailwind/" rel="tag">tailwind</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/this/" rel="tag">this</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/three/" rel="tag">three</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ts/" rel="tag">ts</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/uniapp/" rel="tag">uniapp</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/utils/" rel="tag">utils</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vscode/" rel="tag">vscode</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vue/" rel="tag">vue</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vueRouter/" rel="tag">vueRouter</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vuex/" rel="tag">vuex</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vw/" rel="tag">vw</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web-worker/" rel="tag">web worker</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/webpack/" rel="tag">webpack</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/websocket/" rel="tag">websocket</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web%E6%89%93%E5%8D%B0/" rel="tag">web打印</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/worker/" rel="tag">worker</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/xlsx/" rel="tag">xlsx</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/yarn/" rel="tag">yarn</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BC%98%E5%8C%96/" rel="tag">优化</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8/" rel="tag">分库分表</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%88%9D%E5%BF%83/" rel="tag">初心</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8A%A8%E7%94%BB%E5%BA%93/" rel="tag">动画库</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8E%9F%E5%9E%8B%E4%B8%8E%E5%8E%9F%E5%9E%8B%E9%93%BE/" rel="tag">原型与原型链</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8F%91%E5%B8%83%E8%AE%A2%E9%98%85/" rel="tag">发布订阅</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8F%AF%E8%A7%86%E5%8C%96/" rel="tag">可视化</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A4%9A%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/" rel="tag">多文件下载</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A4%A7%E5%B1%8F/" rel="tag">大屏</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AA%92%E4%BD%93%E6%9F%A5%E8%AF%A2/" rel="tag">媒体查询</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AD%97%E8%8A%82%E5%BA%8F/" rel="tag">字节序</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B0%81%E8%A3%85%E8%AF%B7%E6%B1%82/" rel="tag">封装请求</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/" rel="tag">小程序</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B1%85%E4%B8%AD%E5%AF%B9%E9%BD%90/" rel="tag">居中对齐</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/" rel="tag">微信小程序</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BF%83%E5%BE%97/" rel="tag">心得</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7/" rel="tag">性能监控</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%8B%96%E6%8B%BD/" rel="tag">拖拽</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%8F%92%E6%A7%BD/" rel="tag">插槽</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" rel="tag">数据库</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/" rel="tag">文件下载</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9D%82%E8%B0%88/" rel="tag">杂谈</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B3%9B%E5%9E%8B/" rel="tag">泛型</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%9B%B8%E5%86%8C/" rel="tag">相册</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/" rel="tag">移动端常见问题</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%84%9A%E6%89%8B%E6%9E%B6/" rel="tag">脚手架</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2/" rel="tag">自动化部署</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%87%AA%E9%80%82%E5%BA%94/" rel="tag">自适应</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%B0%83%E8%AF%95/" rel="tag">调试</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%B7%A8%E5%9F%9F/" rel="tag">跨域</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%BE%85%E5%8A%A9%E5%B7%A5%E5%85%B7/" rel="tag">辅助工具</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%BF%9B%E7%A8%8B%E5%92%8C%E7%BA%BF%E7%A8%8B/" rel="tag">进程和线程</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%82%A3%E4%BA%9B%E5%B9%B4%E5%81%9A%E8%BF%87%E7%9A%84%E9%A1%B9%E7%9B%AE/" rel="tag">那些年做过的项目</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%83%A8%E7%BD%B2/" rel="tag">部署</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%9D%A2%E8%AF%95/" rel="tag">面试</a><span class="tag-list-count">1</span></li></ul></canvas></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="beian"><span class="exturl" data-url="aHR0cHM6Ly9iZWlhbi5taWl0Lmdvdi5jbg==">豫ICP备19017003号-1 </span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://blog.img.wy1991.cn/static/images/ga.png" style="display:inline-block"></div><div class="copyright">&copy; 2021 – <span itemprop="copyrightYear">2022</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">很帅很愁人~</span></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item" id="busuanzi_container_site_uv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-user"></i> </span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span> </span></span><span class="post-meta-divider">|</span> <span class="post-meta-item" id="busuanzi_container_site_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div></div></footer></div><script src="/lib/anime.min.js"></script><script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script>!function(){var e,t,o,n,r,a=document.getElementsByTagName("link");if(0<a.length)for(i=0;i<a.length;i++)"canonical"==a[i].rel.toLowerCase()&&a[i].href&&(e=a[i].href);t=e?e.split(":")[0]:window.location.protocol.split(":")[0],e=e||window.location.href,window,n=e,r=document.referrer,/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi.test(n)||(o="https"===String(t).toLowerCase()?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif",r?(o+="?r="+encodeURIComponent(document.referrer),n&&(o+="&l="+n)):n&&(o+="?l="+n),(new Image).src=o)}()</script><script src="/js/local-search.js"></script><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?f65cb40e9a5d20342ae8b58def42ea5f";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js",t.name="baidu_tongji";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n)}()</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,model:null,display:{position:"left",width:150,height:300},mobile:{show:!1},log:!1})</script><script>window.imageLazyLoadSetting={isSPA:!1,preloadRatio:3,processImages:null}</script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})})</script><script>!function(n){n.imageLazyLoadSetting.processImages=o;var e=n.imageLazyLoadSetting.isSPA,i=n.imageLazyLoadSetting.preloadRatio||1,r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function o(){e&&(r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")));for(var t,a=0;a<r.length;a++)0<=(t=r[a].getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(n.innerHeight*i||document.documentElement.clientHeight*i)&&function(){var e=r[a],t=e,n=function(){r=r.filter(function(t){return e!==t})},i=new Image,o=t.getAttribute("data-original");i.onload=function(){t.src=o,n()},t.src!==o&&(i.src=o)}()}o(),n.addEventListener("scroll",function(){var t=o,e=n;clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(e)},500)})}(this)</script></body></html>